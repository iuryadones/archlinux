'use strict';var Bf;var Cf=chrome.i18n.getMessage("545449835455981095");q("mr.IssueSeverity",{Wr:"fatal",Kv:"warning",It:"notification"});q("mr.IssueAction",{Mr:"dismiss",at:"learn_more"});var Df=function(a,b){this.routeId=null;this.severity=b;this.isBlocking="fatal"==this.severity?!0:!1;this.title=a;this.message=null;this.defaultAction="dismiss";this.helpPageId=this.secondaryActions=null},Ff=function(){var a=new Df(Ef,"notification");a.helpPageId=6320939;a.defaultAction="learn_more";a.secondaryActions=["dismiss"];return a};var Gf=function(a,b){var c=this;this.b=void 0===b?null:b;this.a=new Promise(function(b,e){var d=function(a){c.b=null;e(a)};c.f=d;a(function(a){c.b=null;b(a)},d)})};Gf.prototype.cancel=function(a){this.f(a);if(this.b){var b=this.b;this.b=null;setTimeout(function(){return b(a)},0)}};var Hf=function(a,b,c){c=void 0===c?null:c;return new Gf(function(d,e){a.a.then(function(a){if(b)try{d(b(a))}catch(h){e(h)}else d(a)},function(a){if(c)try{d(c(a))}catch(h){e(h)}else e(a)})},function(b){a.cancel(b)})};
Gf.prototype.then=function(a,b){return Hf(this,a,void 0===b?null:b)};var If=function(a,b){return Hf(a,null,b)},Jf=function(a){return new Gf(function(b){b(a)})},Kf=function(a){return new Gf(function(b,c){c(a)})},Lf=function(a){return new Gf(function(b,c){a.then(b,c)})},Mf=function(a,b){var c=!1,d=null;return new Gf(function(e,f){a.then(function(a){c||(d=b(a),d.a.then(e,f))},f)},function(a){d?d.cancel(a):c=!0})};var Nf=function(){var a=la(navigator.userAgent.match(/Windows NT (\d+.\d+)/)||[]);a.next();a=a.next().value;return 6.2<=parseFloat(a)},Of=function(){var a=navigator.userAgent;return a.includes("CrOS")?"ChromeOS":a.includes("Windows")?"Windows":a.includes("Macintosh")?"Mac":a.includes("Linux")?"Linux":"Other"};var Pf=!("undefined"==typeof chrome||!chrome.networkingPrivate||!chrome.networkingPrivate.setWifiTDLSEnabledState||"ChromeOS"!=Of()),Qf=["ChromeOS","Windows"].includes(Of());var Rf=function(a,b,c,d){this.b=a;this.a=b;this.f=c||null;this.presentationId=d||null},Uf=function(a,b){if("tab"==a.b)a=Sf(a);else if("offscreen_tab"==a.b)b=Sf(a),b.presentationId=a.presentationId,a=b;else{var c={audio:!1,video:!1};a.a.shouldCaptureVideo?(c.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:b}},Tf(a,c.video.mandatory),Qf&&a.a.shouldCaptureAudio&&(c.audio={mandatory:{chromeMediaSource:"system",chromeMediaSourceId:b}})):a.a.shouldCaptureAudio&&(c.audio={mandatory:{chromeMediaSource:"system"}});
a=c}return a},Sf=function(a){var b={audio:a.a.shouldCaptureAudio,video:a.a.shouldCaptureVideo};a.a.shouldCaptureVideo&&(b.videoConstraints={mandatory:{enableAutoThrottling:!0}},Tf(a,b.videoConstraints.mandatory));return b},Tf=function(a,b){var c=a.a.minWidth,d=a.a.minHeight;if(a.a.senderSideLetterboxing){c=a.a;if(0==c.minHeight||0==c.maxHeight?0:Math.floor(100*c.minWidth/c.minHeight)==Math.floor(100*c.maxWidth/c.maxHeight))c={width:c.minWidth,height:c.minHeight};else{d=c.maxWidth;for(var e=c.maxHeight;0!=
e;){var f=d%e;d=e;e=f}e=c.maxWidth/d;d=c.maxHeight/d;if(e<c.minWidth||d<c.minHeight)if(f=Math.max(c.minWidth/e,c.minHeight/d),e*=f,d*=f,e>c.maxWidth||d>c.maxHeight)e=c.maxWidth,d=c.maxHeight;e=Math.round(e);d=Math.round(d);c={width:e,height:d}}d=c;c=d.width;d=d.height}Object.assign(b,{minWidth:c,minHeight:d,maxWidth:a.a.maxWidth,maxHeight:a.a.maxHeight,minFrameRate:a.a.minFrameRate,maxFrameRate:a.a.maxFrameRate})};var Vf={fr:0,dr:1,hr:2,er:3,Kq:4,gr:5,zs:6,pv:7,Gr:8,kj:9},Wf=function(a,b){a=Error.call(this,a);this.message=a.message;"stack"in a&&(this.stack=a.stack);this.reason=0<=b&&9>=b?b:9};Fa(Wf,Error);var Xf=function(a){this.a=a;this.b=this.Ie=null;this.j=kb("mr.mirror.MirrorMediaStream")};Xf.prototype.start=function(){return"tab"==this.a.b?Yf(this):"offscreen_tab"==this.a.b?Zf(this):$f(this)};var Yf=function(a){var b=Uf(a.a);a.j.info("Starting tab capture with constraints "+JSON.stringify(b));return new Promise(function(c,d){chrome.tabCapture.capture(b,function(b){b?(ag(a,b),c(a)):d(bg())});window.setTimeout(function(){d(new Wf("chrome.tabCapture.capture failed to call its callback",2))},5E3)})};
Xf.prototype.f=function(a){a&&this.j.info(function(){return"Track "+JSON.stringify(a.target)+" ended"});this.stop()};
var bg=function(){return chrome.runtime.lastError&&chrome.runtime.lastError.message?new Wf(chrome.runtime.lastError.message,7):new Wf("empty_stream",0)},cg=function(){var a=void 0===a?6E4:a;return new Promise(function(b,c){var d=["screen","audio"];"Linux"==Of()&&d.push("window");var e=window.setTimeout(function(){f&&chrome.desktopCapture.cancelChooseDesktopMedia(f);c(new Wf("timeout",1))},a);var f=chrome.desktopCapture.chooseDesktopMedia(d,function(a){window.clearTimeout(e);a?b(a):c(new Wf("User cancelled capture dialog",
3))})})},dg=function(a,b){return new Promise(function(c,d){a.j.info(function(){return"Starting desktop capture with constraints "+JSON.stringify(b)});navigator.mediaDevices.getUserMedia(b).then(function(b){b||d(new Wf("empty_stream",8));ag(a,b);c(b)},function(a){var b=8;"NotAllowedError"==a.name&&(b=3);d(new Wf(a.name+" "+a.constraintName+": "+a.message,b))})})},$f=function(a){return Qf&&a.a.a.shouldCaptureAudio&&!a.a.a.shouldCaptureVideo?dg(a,Uf(a.a)).then(function(){return a}):cg().then(function(b){b=
Uf(a.a,b);return dg(a,b).then(function(){return a})})},Zf=function(a){var b=Uf(a.a);a.j.info(function(){return"Starting offscreen tab capture with constraints "+JSON.stringify(b)});return new Promise(function(c,d){chrome.tabCapture.captureOffscreenTab(a.a.f.toString(),b,function(b){b?(ag(a,b),c(a)):d(bg())})})},ag=function(a,b){a.b=b;b.getAudioTracks().length||b.getVideoTracks();b.getTracks().forEach(function(b){b.onended=a.f.bind(a)})};
Xf.prototype.stop=function(){this.b&&(this.b.getTracks().forEach(function(a){a.onended=null;a.stop()}),this.b=null,this.Ie&&this.Ie())};var eg,fg={it:0,ir:1,jr:2,Ir:3,Jr:4,fs:5,As:6,gt:7,At:8,Bt:9,vu:10,Uu:11,Vu:12,ev:13,ov:14},gg=function(a){void 0==eg&&(Eb("MediaRouter.Provider.WakeEvent",a,fg),eg=a)};var jg=function(a){return hg(a)||ig(a)},kg=function(a){if(!a.startsWith("http:")&&!a.startsWith("https:"))return!1;var b=document.createElement("a");b.href=a;return"http:"!=b.protocol&&"https:"!=b.protocol?!1:-1==b.hash.indexOf("__castAppId__")},lg=["https://docs.google.com"],hg=function(a){return a.startsWith("urn:x-org.chromium.media:source:tab:")||-1!=a.indexOf("0F5096E8")},ig=function(a){return"urn:x-org.chromium.media:source:desktop"==a},mg=function(a){var b=a.search("urn:x-org.chromium.media:source:tab:");
return-1==b?null:parseInt(a.substr(b+36),10)||null};var og=function(a){return(new Promise(function(b){chrome.tabs.get(a,b)})).then(function(b){if(!b)throw Error("No such tab "+a);return b})};var pg=function(){},tg=function(a){var b=qg.get(a)||null;if(b)return Promise.resolve(b);b=rg.get(a);b||(b=new Ib,rg.set(a,b),sg(a,b));return b.a},sg=function(a,b){var c=ug.get(a)||null;if(!c)b.reject(Error("No corresponding bundle for "+a));else if(!vg.has(c)){var d=wg.get(c);d||(xg.info("Loading bundle "+c+" for module "+a),d=yg(c),wg.set(c,d));d.catch(function(a){b.reject(a)})}},yg=function(a){var b=new Ib;b.a.then(function(){xg.info("Bundle "+a+" loaded")},function(b){xg.error("Failed to load bundle "+
a);throw b;});var c=document.createElement("script");c.src=chrome.extension.getURL(a);c.setAttribute("type","text/javascript");c.async=!0;c.onload=function(){return b.resolve(void 0)};c.onerror=function(){return b.reject(Error("Failed to load bundle "+a))};document.head.appendChild(c);return b.a},zg=function(a,b){if(qg.has(a))throw Error("Duplicate module "+a);qg.set(a,b);(a=rg.get(a))&&a.resolve(b)};
pg.prototype.handleEvent=function(a,b){for(var c=1;c<arguments.length;++c);throw Error("Not implemented");};
var ug=new Map([["mr.cast.ChannelService","background_script.js"],["mr.cast.SinkDiscoveryService","background_script.js"],["mr.mirror.cast.Service","mirroring_cast_streaming.js"],["mr.cloud.discovery.CloudSinkDiscoveryService","background_script.js"],["mr.dial.SinkDiscoveryService","background_script.js"],["mr.mirror.hangouts.HangoutsService","mirroring_hangouts.js"],["mr.mirror.hangouts.MeetingsService","mirroring_hangouts.js"],["mr.ProviderManager","background_script.js"],["mr.mirror.webrtc.WebRtcService",
"mirroring_webrtc.js"]]),vg=new Set(["background_script.js"]),xg=kb("mr.Module"),qg=new Map,rg=new Map,wg=new Map;var Ag=function(a,b){this.F=a;this.l=b||null;this.b=this.a=null;this.H=kb("mr.mirror.Service."+a);this.s=this.R.bind(this);this.g=!1};Fa(Ag,pg);Ag.prototype.Ya=function(a){this.g||(this.l=a,this.g=!0,this.qg())};Ag.prototype.qg=function(){};Ag.prototype.getName=function(){return this.F};
var Fg=function(a,b,c,d,e,f){a.H.info("Start mirroring on route "+b.id);return a.g?Lf(Bg(c,b.Zb.tabId).then(function(){return Cg(a)}).then(function(){var a=Dg(c,d,e);return(new Xf(a)).start()}).then(function(c){if(a.b)throw c.stop(),new Wf("Cannot start multiple streams");a.b=c;c=a.h.bind(a);a.b.Ie=c;return f?f(b).a:b}).then(function(b){if(a.a)throw new Wf("Cannot start multiple sessions");if(!a.b)throw new Wf("Media stream ended before session could start.");a.a=a.lg(d,b);return a.a.start(a.b.b)}).then(function(){hg(c)&&
!chrome.tabs.onUpdated.hasListener(a.s)&&chrome.tabs.onUpdated.addListener(a.s);return a.A(b,c,d)}).then(null,function(b){Eg(a,b);return a.h().then(function(){throw b;})})):Kf(Error("Not initialized"))},Bg=function(a,b){return hg(a)?b?og(b).then(function(a){if(!a.active)throw new Wf("Tab to be mirrored is not active",7);}):Promise.reject(new Wf("BUG: Tab ID is required.")):Promise.resolve()};
Ag.prototype.B=function(a,b,c,d,e){var f=this;if(!this.a)return Promise.reject(new Wf("No session to update streams on",7));if(!this.a.ll())return Promise.reject(new Wf("Session does not support updating stream",7));var h=!1;return Promise.resolve().then(function(){var a=Dg(b,c,d);return(new Xf(a)).start()}).then(function(b){f.b&&(f.b.Ie=null,f.b.stop(),f.Hf());f.b=b;b=f.h.bind(f);f.b.Ie=b;h=!0;return e?e(a).a:a}).then(function(){if(!f.a)throw new Wf("Session ended while updating stream");if(!f.b)throw new Wf("Media stream ended before session could be updated.");
f.a.Yh();return f.a.pl(f.b.b)}).then(this.A.bind(this,a,b,c)).then(null,function(a){Eg(f,a);if(h)return f.h().then(function(){throw a;});throw a;})};
Ag.prototype.A=function(a,b,c){var d=this;return new Promise(function(e,f){if(d.a)if(hg(b))Gg(d.a,a.Zb.tabId).then(function(){d.l.ai(d.a.b);Hg(d.a);d.Vg();e(d.a.b)},function(a){d.H.error("Failed to obtain initial tab info.",a);f(a)});else{if(kg(b)){var h="Capturing "+a.mediaSource;Ig(d.a,h,h,null);Hg(d.a);d.pi()}else Ig(d.a,"Capturing Desktop","Capturing Desktop",null),Hg(d.a),d.Sg();Jg(d,c,d.b);e(d.a.b)}else f(new Wf("Session gone before executing post-startup steps",7))})};
var Eg=function(a,b){b.reason=null!=b.reason?b.reason:9;a.H.error("Failed to start mirroring: "+b.message+(",  reason = "+b.reason+": "+b.stack));a.Ug(b.reason)},Cg=function(a){return a.g?a.h().then(function(b){b&&a.Tg();return b}):Promise.reject("Not initialized")};
Ag.prototype.h=function(){var a=this;chrome.tabs.onUpdated.removeListener(this.s);var b=this.b;this.b=null;b&&(b.Ie=null);var c=this.a;this.a=null;var d;c?d=this.lh(c).catch(function(b){return a.H.error("Error in before-cleanup steps",b)}).then(function(){return c.stop()}).catch(function(b){return a.H.error("Error stopping session",b)}).then(function(){a.l.bi(c.b.id)}).catch(function(b){return a.H.error("Error in ended callbacks",b)}).then(function(){return!0}):d=Promise.resolve(!1);b&&(d=d.then(function(c){b.stop();
a.Hf();return c}));return d};Ag.prototype.lh=function(){return Promise.resolve()};Ag.prototype.R=function(a,b,c){gg(14);this.a&&this.a.tabId&&this.a.tabId==a&&("complete"==b.status||b.favIconUrl&&"complete"==c.status)&&(this.a.ql(c),this.l.ai(this.a.b),Hg(this.a))};
var Dg=function(a,b,c){if(hg(a))return new Rf("tab",b);if(ig(a))return new Rf("desktop",b);if(kg(a)){if(!c)throw new Wf("Missing offscreen tab presentation id");return new Rf("offscreen_tab",b,a,c)}throw new Wf("Source URN does not suggest a known capture type.");},Jg=function(a,b,c){b.shouldCaptureAudio&&c.b&&!c.b.getAudioTracks().length&&a.l.Nd(new Df(Cf,"notification"))};g=Ag.prototype;g.lg=function(){};g.Vg=function(){};g.Sg=function(){};g.pi=function(){};g.Tg=function(){};g.Ug=function(){};
g.Hf=function(){};g.Xh=function(){return hb()};g.createMediaRouteController=function(){return hb()};var Kg=function(a){this.b=a;this.w=!1;this.tabId=this.I=this.iconUrl=null},Ig=function(a,b,c,d){a.b.description=b;a.w||a.b.offTheRecord?(a.I=null,a.iconUrl=null):(a.I=c,a.iconUrl=d);a.Yh()},Hg=function(a){a.w||a.b.offTheRecord||a.Wk()},Gg=function(a,b){a.tabId=b;return og(b).then(a.ql.bind(a))};g=Kg.prototype;g.ql=function(a){this.w=a.incognito;var b=new URL(a.url);Ig(this,a.title,"file:"==b.protocol?"Local content (Tab)":b.hostname+" (Tab)",a.favIconUrl)};g.start=function(){};g.ll=function(){return!1};
g.pl=function(){};g.stop=function(){return Promise.resolve()};g.Wk=function(){};g.Yh=function(){};var Og=function(){var a=this;this.maxWidth=1920;this.maxHeight=1080;this.minHeight=this.minWidth=180;this.senderSideLetterboxing=!1;this.minFrameRate=0;this.maxFrameRate=30;this.minVideoBitrate=300;this.maxVideoBitrate=5E3;this.audioBitrate=0;this.maxLatencyMillis=800;this.animatedLatencyMillis=this.minLatencyMillis=400;this.dscpEnabled=["Mac","Linux","ChromeOS"].includes(Of())||Nf();this.enableLogging=!0;this.useTdls=!1;this.shouldCaptureAudio=this.shouldCaptureVideo=!0;var b=window.localStorage?
window.localStorage.getItem(Lg):null;if(b)try{var c=JSON.parse(String(b));if(c instanceof Object)Mg(this,c),u(kb("mr.mirror.Settings"),function(){return"Initial mr.mirror.Settings overridden to: "+Ng(a)});else throw Error("localStorage["+Lg+"] "+("does not parse as an Object: "+b));}catch(d){throw kb("mr.mirror.Settings").error(Lg+' must be of the form \'{"maxWidth":640, "maxHeight":360}\'.',d),Error("Overrides not parseable.  See ERROR log for details.");}},Ng=function(a){return JSON.stringify(a,
function(a,c){if(0==a.length||!a.endsWith("_"))return c})},Mg=function(a,b){for(var c=la(Object.keys(b)),d=c.next();!d.done;d=c.next())d=d.value,d.endsWith("_")||typeof b[d]!==typeof a[d]||(a[d]=b[d])},Pg=function(a){var b=screen.width,c=screen.height;a.maxHeight*b<a.maxWidth*c?(b=Math.min(a.maxWidth,b),b-=b%160,c=90*b/160):(c=Math.min(a.maxHeight,c),c-=c%90,b=160*c/90);if(b<Math.max(160,a.minWidth)||c<Math.max(90,a.minHeight))b=Math.max(160,a.minWidth),c=Math.max(90,a.minHeight);a.maxWidth=b;a.maxHeight=
c},Lg="mr.mirror.Settings.Overrides";var Qg=function(a,b){this.type=a;this.data=b},Rg=function(a){a=JSON.parse(a);if(!a.type)throw Error("Invalid message");return new Qg(a.type,a.data)},Sg=function(a,b,c,d,e){this.description=a;this.settings=b||null;this.mediaConstraints=c||null;this.presentationUrl=d||null;this.presentationId=e||null};var Vg=function(a,b){this.j=kb("cv2.PeerConnection");this.R=Tg;this.a=Ug(this,b);this.l=this.a.createDataChannel(a,{reliable:!1});this.I=new Ib;this.u=!1;this.g=0;this.f=null;this.m=this.h=0;this.b=!1;this.A=function(){};this.v=function(){};this.w=function(){};this.s=function(){}},Wg=function(a,b){a.v=b},Xg=function(a,b){a.w=b},Yg=function(a,b){a.s=b},Zg=function(a,b){a.A=b},$g=function(a,b){a.l.onmessage=function(a){b(a.data)}},ah=function(a){var b={};b.iceServers=[{url:"stun:stun.l.google.com:19302"}].concat(a);
return b},Ug=function(a,b){var c=ah(b);b=new webkitRTCPeerConnection(c);b.onicecandidate=a.F.bind(a);b.a=a.J.bind(a);b.oniceconnectionstatechange=a.oa.bind(a);a.j.info(function(){return"Created webkitRTCPeerConnnection with config: "+JSON.stringify(c)});return b};Vg.prototype.start=function(){this.b||(this.b=!0,bh(this))};Vg.prototype.stop=function(){this.j.info("Stopping peer connection...");this.b&&(this.b=!1,"closed"!=this.a.signalingState&&this.a.close());this.a=null};
var bh=function(a){a.j.info("Sending offer to peer.");a.h=Date.now();a.a.createOffer(a.B.bind(a),function(b){u(a.j,"Error creating offer.",b)},a.R);a.I.a.then(function(b){a.A(b)})};Vg.prototype.B=function(a){var b=this;this.j.info(function(){return"Setting local description: "+JSON.stringify(a)});this.a.setLocalDescription(a,function(){b.j.info("Local description set successfully")},function(a){u(b.j,"Error setting local description.",a)})};
var ch=function(a,b){v(a.j,function(){return"<===: "+JSON.stringify(b)});var c=new RTCSessionDescription(b);a.j.info(function(){return"Setting remote description: "+JSON.stringify(c)});a.a.setRemoteDescription(c,function(){a.j.info("Remote description set successfully.")},function(b){u(a.j,"Error setting remote description.",b)})};
Vg.prototype.F=function(a){var b=this;a.candidate?(this.g++,this.m=Date.now(),1==this.g?this.f=setTimeout(function(){b.j.info("ICE candidate gathering timed out.");b.f=null;dh(b)},5E3):this.u&&u(this.j,"Received ICE candidate after resolving session description.")):(this.j.info("End of ICE candidates."),vb("MediaRouter.WebRtc.IceCandidateGathering.Duration.Reported",Date.now()-this.h),dh(this),0<this.g&&vb("MediaRouter.WebRtc.IceCandidateGathering.Duration.Real",this.m-this.h))};
Vg.prototype.J=function(){"completed"==this.a.iceGatheringState&&dh(this)};var dh=function(a){clearTimeout(a.f);a.f=null;if(!a.u){a.j.info("Resolving sesion description after gathering "+a.g+" ICE candidates.");var b=a.a.localDescription;a.I.resolve({type:b.type,sdp:b.sdp});a.u=!0}};
Vg.prototype.oa=function(a){var b=this;if(this.a){var c=this.a.iceConnectionState;this.j.info("New ICE connection state: "+c+".");"connected"==c?this.v("iceconnected"):"completed"==c?this.v("icecompleted"):"failed"==c?(u(this.j,function(){return"Ice connection failed: "+JSON.stringify(a)}),this.w("icefailed")):"closed"==c?this.s("iceclosed"):"disconnected"==c&&(u(this.j,"Ice connection state is bad."),this.b&&(this.j.info("Restarting ICE."),this.a.createOffer(this.B.bind(this),function(a){u(b.j,"Error creating new offer.",
a)},eh)))}};var Tg={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},eh={mandatory:{IceRestart:!0,OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}};var fh=window.localStorage,gh=0,ih=function(a){return(a=window.localStorage.getItem(hh(a,!1)))?JSON.parse(a):null},jh=function(a){return(a=window.localStorage.getItem(hh(a,!0)))?JSON.parse(a):null},lh=function(a){if(kh.has(a.ua()))throw Error("Duplicate instance name "+a.ua());kh.set(a.ua(),a);a.Ta()},rh=function(a){for(var b=0,c=la(Object.keys(fh)),d=c.next();!d.done;d=c.next()){d=d.value;var e=d.length+window.localStorage.getItem(d).length;d.startsWith("mr.")?gh+=e:b+=e}mh=a;(window.localStorage.getItem("version")&&
window.localStorage.getItem("version")!==chrome.runtime.getManifest().version||nh(a))&&oh();ph.info("initialize: "+gh+" chars used, "+b+" other chars");chrome.runtime.onSuspend.addListener(qh)},mh=null,ph=kb("mr.PersistentDataManager"),kh=new Map,hh=function(a,b){return"mr."+(b?"persistent.":"temp.")+a.ua()},nh=function(a){return!!window.localStorage.getItem("mrInstanceId")&&window.localStorage.getItem("mrInstanceId")!==a},qh=function(){ph.info("onSuspend");sh("version",chrome.runtime.getManifest().version);
mh&&sh("mrInstanceId",mh);for(var a=kh.get("LogManager"),b=la(kh),c=b.next();!c.done;c=b.next())c=la(c.value),c.next(),c=c.next().value,c!=a&&th(c);a&&th(a)},th=function(a){try{var b=a.Pa();b&&void 0!=b[0]&&sh(hh(a,!1),JSON.stringify(b[0]));b&&void 0!=b[1]&&sh(hh(a,!0),JSON.stringify(b[1]))}catch(c){ph.error("Error while saving data for "+a.ua()+": "+c.message)}},sh=function(a,b){var c=window.localStorage.getItem(a);c=null!=c?b.length-c.length:a.length+b.length;52E5<gh+c&&(u(ph,"Unable to write "+
c+" chars"),oh());if(52E5<gh+c)throw ph.error("Unable to write "+c+" chars after clearing temporary"),Error("Setting the value of '"+a+"' would exceed the quota, according to accounting.");try{window.localStorage.setItem(a,b)}catch(d){throw Error("Setting the value of '"+a+"' would exceed the quota, according to the browser.");}gh+=c},uh=function(a){a=0==a.size%2?new Blob([a,new Uint8Array([0,0])]):new Blob([a,new Uint8Array([1])]);return new Promise(function(b,c){var d=new FileReader;d.onloadend=
function(){if(d.error)c(d.error);else try{for(var a=d.result,f=[],h=0,k=a.byteLength;h<k;h+=8192)f.push(String.fromCharCode.apply(null,new Uint16Array(a,h,Math.min(k-h,8192)/2)));sh("mr.temp.mirror.cast.Service.eventsBlob",f.join(""));b()}catch(m){c(m)}};d.readAsArrayBuffer(a)})},oh=function(){for(var a=la(Object.keys(fh)),b=a.next();!b.done;b=a.next())b=b.value,b.startsWith("mr.temp.")&&(gh-=b.length+window.localStorage.getItem(b).length,delete window.localStorage[b]);ph.info("removeTemporary_: "+
gh+" chars used")};var vh=function(a,b){this.f=a;this.g=b;this.b=0;this.a=null};vh.prototype.get=function(){if(0<this.b){this.b--;var a=this.a;this.a=a.next;a.next=null}else a=this.f();return a};var wh=function(a,b){a.g(b);100>a.b&&(a.b++,b.next=a.a,a.a=b)};var xh=function(a){return function(){return a}},yh=xh(!1),zh=xh(!0),Ah=function(a){return a},Bh=function(a){return function(){throw Error(a);}},Ch=function(a){var b=b||0;return function(){return a.apply(this,Array.prototype.slice.call(arguments,0,b))}};var Dh=function(a){Ia.setTimeout(function(){throw a;},0)},Eh,Fh=function(){var a=Ia.MessageChannel;"undefined"===typeof a&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!Kd("Presto")&&(a=function(){var a=document.createElement("IFRAME");a.style.display="none";a.src="";document.documentElement.appendChild(a);var b=a.contentWindow;a=b.document;a.open();a.write("");a.close();var c="callImmediate"+Math.random(),d="file:"==b.location.protocol?"*":b.location.protocol+"//"+b.location.host;
a=p(function(a){if(("*"==d||a.origin==d)&&a.data==c)this.port1.onmessage()},this);b.addEventListener("message",a,!1);this.port1={};this.port2={postMessage:function(){b.postMessage(c,d)}}});if("undefined"!==typeof a&&!Kd("Trident")&&!Kd("MSIE")){var b=new a,c={},d=c;b.port1.onmessage=function(){if(Ja(c.next)){c=c.next;var a=c.zj;c.zj=null;a()}};return function(a){d.next={zj:a};d=d.next;b.port2.postMessage(0)}}return"undefined"!==typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?
function(a){var b=document.createElement("SCRIPT");b.onreadystatechange=function(){b.onreadystatechange=null;b.parentNode.removeChild(b);b=null;a();a=null};document.documentElement.appendChild(b)}:function(a){Ia.setTimeout(a,0)}};var Gh=function(){this.b=this.a=null},Ih=new vh(function(){return new Hh},function(a){a.reset()});Gh.prototype.add=function(a,b){var c=Ih.get();c.set(a,b);this.b?this.b.next=c:this.a=c;this.b=c};Gh.prototype.remove=function(){var a=null;this.a&&(a=this.a,this.a=this.a.next,this.a||(this.b=null),a.next=null);return a};var Hh=function(){this.next=this.scope=this.a=null};Hh.prototype.set=function(a,b){this.a=a;this.scope=b;this.next=null};Hh.prototype.reset=function(){this.next=this.scope=this.a=null};var Nh=function(a,b){Jh||Kh();Lh||(Jh(),Lh=!0);Mh.add(a,b)},Jh,Kh=function(){if(-1!=String(Ia.Promise).indexOf("[native code]")){var a=Ia.Promise.resolve(void 0);Jh=function(){a.then(Oh)}}else Jh=function(){var a=Oh;!Xa(Ia.setImmediate)||Ia.Window&&Ia.Window.prototype&&!Kd("Edge")&&Ia.Window.prototype.setImmediate==Ia.setImmediate?(Eh||(Eh=Fh()),Eh(a)):Ia.setImmediate(a)}},Lh=!1,Mh=new Gh,Oh=function(){for(var a;a=Mh.remove();){try{a.a.call(a.scope)}catch(b){Dh(b)}wh(Ih,a)}Lh=!1};var Ph=function(a){if("undefined"==typeof a)return"undefined";if(null==a)return"NULL";var b=[],c;for(c in a)if(!Xa(a[c])){var d=c+" = ";try{d+=a[c]}catch(e){d+="*** "+e+" ***"}b.push(d)}return b.join("\n")},Qh=function(a){var b=[],c=[],d={},e=function(a,h){var f=h+"  ";try{if(Ja(a))if(null===a)b.push("NULL");else if(Ka(a))b.push('"'+a.replace(/\n/g,"\n"+h)+'"');else if(Xa(a))b.push(String(a).replace(/\n/g,"\n"+h));else if(Ya(a)){a[$a]||c.push(a);var m=a[$a]||(a[$a]=++cb);if(d[m])b.push("*** reference loop detected (id="+
m+") ***");else{d[m]=!0;b.push("{");for(var r in a)Xa(a[r])||(b.push("\n"),b.push(f),b.push(r+" = "),e(a[r],f));b.push("\n"+h+"}");delete d[m]}}else b.push(a);else b.push("undefined")}catch(y){b.push("*** "+y+" ***")}};e(a,"");for(a=0;a<c.length;a++)bb(c[a]);return b.join("")},Rh=function(a){var b=Rh;var c=Error();if(Error.captureStackTrace)Error.captureStackTrace(c,b),b=String(c.stack);else{try{throw c;}catch(e){c=e}b=(b=c.stack)?String(b):null}if(b)return b;b=[];c=arguments.callee.caller;for(var d=
0;c&&(!a||d<a);){b.push(Sh(c));b.push("()\n");try{c=c.caller}catch(e){b.push("[exception trying to get caller]\n");break}d++;if(50<=d){b.push("[...long stack...]");break}}a&&d>=a?b.push("[...reached max depth limit...]"):b.push("[end]");return b.join("")},Sh=function(a){if(Th[a])return Th[a];a=String(a);if(!Th[a]){var b=/function ([^\(]+)/.exec(a);Th[a]=b?b[1]:"[Anonymous]"}return Th[a]},Th={},Uh=Object.freeze||function(a){return a};var Vh=function(a,b,c){this.reset(a,b,c,void 0,void 0)};Vh.prototype.a=null;var Wh=0;Vh.prototype.reset=function(a,b,c,d,e){"number"==typeof e||Wh++;this.l=d||gb();this.b=a;this.g=b;this.f=c;delete this.a};Vh.prototype.getMessage=function(){return this.g};var Xh=function(a){this.f=a;this.tf=this.b=this.xg=this.a=null},Yh=function(a,b){this.name=a;this.value=b};Yh.prototype.toString=function(){return this.name};var Zh=new Yh("SEVERE",1E3),$h=new Yh("WARNING",900),ai=new Yh("INFO",800),bi=new Yh("CONFIG",700),ci=new Yh("FINE",500),di=new Yh("FINER",400),ei=new Yh("ALL",0);Xh.prototype.getName=function(){return this.f};Xh.prototype.getChildren=function(){this.b||(this.b={});return this.b};
var fi=function(a){if(a.xg)return a.xg;if(a.a)return fi(a.a);ec("Root logger has no level set.");return null};Xh.prototype.log=function(a,b,c){a.value>=fi(this).value&&(Xa(b)&&(b=b()),a=new Vh(a,String(b),this.f),c&&(a.a=c),gi(this,a))};Xh.prototype.info=function(a,b){this.log(ai,a,b)};Xh.prototype.config=function(a,b){this.log(bi,a,b)};Xh.prototype.logRecord=function(a){a.b.value>=fi(this).value&&gi(this,a)};
var gi=function(a,b){for(;a;){var c,d=a,e=b;if(d.tf)for(var f=0;c=d.tf[f];f++)c(e);a=a.a}},hi={},ii=null,ji=function(){ii||(ii=new Xh(""),hi[""]=ii,ii.xg=bi)},ki=function(a){ji();var b;if(!(b=hi[a])){b=new Xh(a);var c=a.lastIndexOf("."),d=a.substr(c+1);c=ki(a.substr(0,c));c.getChildren()[d]=b;b.a=c;hi[a]=b}return b};var li=function(){this.v=this.v;this.oa=this.oa};li.prototype.v=!1;li.prototype.Na=function(){this.v||(this.v=!0,this.fa())};li.prototype.l=function(a){mi(this,fb(ni,a))};var mi=function(a,b){a.v?Ja(void 0)?b.call(void 0):b():(a.oa||(a.oa=[]),a.oa.push(Ja(void 0)?p(b,void 0):b))};li.prototype.fa=function(){if(this.oa)for(;this.oa.length;)this.oa.shift()()};
var ni=function(a){a&&"function"==typeof a.Na&&a.Na()},oi=function(a){for(var b=0,c=arguments.length;b<c;++b){var d=arguments[b];Wa(d)?oi.apply(null,d):ni(d)}};var pi=!ae||9<=Number(ve),qi=ae&&!ue("9"),ri=function(){if(!Ia.addEventListener||!Object.defineProperty)return!1;var a=!1,b=Object.defineProperty({},"passive",{get:function(){a=!0}});Ia.addEventListener("test",Oa,b);Ia.removeEventListener("test",Oa,b);return a}();var z=function(a,b){this.type=a;this.b=this.target=b;this.Uk=!0};z.prototype.g=function(){this.Uk=!1};var si=function(a,b){z.call(this,a?a.type:"");this.relatedTarget=this.b=this.target=null;this.button=this.screenY=this.screenX=this.clientY=this.clientX=0;this.key="";this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1;this.state=null;this.pointerId=0;this.pointerType="";this.a=null;a&&this.init(a,b)};t(si,z);var ti=Uh({2:"touch",3:"pen",4:"mouse"});
si.prototype.init=function(a,b){var c=this.type=a.type,d=a.changedTouches?a.changedTouches[0]:null;this.target=a.target||a.srcElement;this.b=b;(b=a.relatedTarget)?ce&&(Wd(b,"nodeName")||(b=null)):"mouseover"==c?b=a.fromElement:"mouseout"==c&&(b=a.toElement);this.relatedTarget=b;null===d?(this.clientX=void 0!==a.clientX?a.clientX:a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0):(this.clientX=void 0!==d.clientX?d.clientX:d.pageX,this.clientY=
void 0!==d.clientY?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0);this.button=a.button;this.key=a.key||"";this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.pointerId=a.pointerId||0;this.pointerType=Ka(a.pointerType)?a.pointerType:ti[a.pointerType]||"";this.state=a.state;this.a=a;a.defaultPrevented&&this.g()};
si.prototype.g=function(){si.ha.g.call(this);var a=this.a;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,qi)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};var ui="closure_listenable_"+(1E6*Math.random()|0),vi=function(a){return!(!a||!a[ui])},wi=0;var xi=function(a,b,c,d,e){this.listener=a;this.proxy=null;this.src=b;this.type=c;this.capture=!!d;this.jb=e;this.key=++wi;this.removed=this.ig=!1},yi=function(a){a.removed=!0;a.listener=null;a.proxy=null;a.src=null;a.jb=null};var zi=function(a){this.src=a;this.a={};this.b=0};zi.prototype.add=function(a,b,c,d,e){var f=a.toString();a=this.a[f];a||(a=this.a[f]=[],this.b++);var h=Ai(a,b,d,e);-1<h?(b=a[h],c||(b.ig=!1)):(b=new xi(b,this.src,f,!!d,e),b.ig=c,a.push(b));return b};zi.prototype.remove=function(a,b,c,d){a=a.toString();if(!(a in this.a))return!1;var e=this.a[a];b=Ai(e,b,c,d);return-1<b?(yi(e[b]),wc(e,b),0==e.length&&(delete this.a[a],this.b--),!0):!1};
var Bi=function(a,b){var c=b.type;if(!(c in a.a))return!1;var d=xc(a.a[c],b);d&&(yi(b),0==a.a[c].length&&(delete a.a[c],a.b--));return d};zi.prototype.removeAll=function(a){a=a&&a.toString();var b=0,c;for(c in this.a)if(!a||c==a){for(var d=this.a[c],e=0;e<d.length;e++)++b,yi(d[e]);delete this.a[c];this.b--}return b};var Ci=function(a,b,c,d,e){a=a.a[b.toString()];b=-1;a&&(b=Ai(a,c,d,e));return-1<b?a[b]:null};
zi.prototype.hasListener=function(a,b){var c=Ja(a),d=c?a.toString():"",e=Ja(b);return Sc(this.a,function(a){for(var f=0;f<a.length;++f)if(!(c&&a[f].type!=d||e&&a[f].capture!=b))return!0;return!1})};var Ai=function(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.removed&&f.listener==b&&f.capture==!!c&&f.jb==d)return e}return-1};var Di="closure_lm_"+(1E6*Math.random()|0),Ei={},Fi=0,Hi=function(a,b,c,d,e){if(d&&d.once)return Gi(a,b,c,d,e);if(Va(b)){for(var f=0;f<b.length;f++)Hi(a,b[f],c,d,e);return null}c=Ii(c);return vi(a)?a.listen(b,c,Ya(d)?!!d.capture:!!d,e):Ji(a,b,c,!1,d,e)},Ji=function(a,b,c,d,e,f){if(!b)throw Error("Invalid event type");var h=Ya(e)?!!e.capture:!!e,k=Ki(a);k||(a[Di]=k=new zi(a));c=k.add(b,c,d,h,f);if(c.proxy)return c;d=Li();c.proxy=d;d.src=a;d.listener=c;if(a.addEventListener)ri||(e=h),void 0===e&&(e=
!1),a.addEventListener(b.toString(),d,e);else if(a.attachEvent)a.attachEvent(Mi(b.toString()),d);else if(a.addListener&&a.removeListener)a.addListener(d);else throw Error("addEventListener and attachEvent are unavailable.");Fi++;return c},Li=function(){var a=Ni,b=pi?function(c){return a.call(b.src,b.listener,c)}:function(c){c=a.call(b.src,b.listener,c);if(!c)return c};return b},Gi=function(a,b,c,d,e){if(Va(b)){for(var f=0;f<b.length;f++)Gi(a,b[f],c,d,e);return null}c=Ii(c);return vi(a)?Oi(a,b,c,Ya(d)?
!!d.capture:!!d,e):Ji(a,b,c,!0,d,e)},Pi=function(a,b,c,d,e){if(Va(b))for(var f=0;f<b.length;f++)Pi(a,b[f],c,d,e);else d=Ya(d)?!!d.capture:!!d,c=Ii(c),vi(a)?a.u(b,c,d,e):a&&(a=Ki(a))&&(b=Ci(a,b,c,d,e))&&Qi(b)},Qi=function(a){if(n(a)||!a||a.removed)return!1;var b=a.src;if(vi(b))return Bi(b.I,a);var c=a.type,d=a.proxy;b.removeEventListener?b.removeEventListener(c,d,a.capture):b.detachEvent?b.detachEvent(Mi(c),d):b.addListener&&b.removeListener&&b.removeListener(d);Fi--;(c=Ki(b))?(Bi(c,a),0==c.b&&(c.src=
null,b[Di]=null)):yi(a);return!0},Ri=function(a){if(a)if(vi(a))a.ti(void 0);else if(a=Ki(a)){var b=0,c;for(c in a.a)for(var d=a.a[c].concat(),e=0;e<d.length;++e)Qi(d[e])&&++b}},Mi=function(a){return a in Ei?Ei[a]:Ei[a]="on"+a},Ti=function(a,b,c,d){var e=!0;if(a=Ki(a))if(b=a.a[b.toString()])for(b=b.concat(),a=0;a<b.length;a++){var f=b[a];f&&f.capture==c&&!f.removed&&(f=Si(f,d),e=e&&!1!==f)}return e},Si=function(a,b){var c=a.listener,d=a.jb||a.src;a.ig&&Qi(a);return c.call(d,b)},Ni=function(a,b){if(a.removed)return!0;
if(!pi){var c=b||Ma("window.event");b=new si(c,this);var d=!0;if(!(0>c.keyCode||void 0!=c.returnValue)){a:{var e=!1;if(0==c.keyCode)try{c.keyCode=-1;break a}catch(h){e=!0}if(e||void 0==c.returnValue)c.returnValue=!0}c=[];for(e=b.b;e;e=e.parentNode)c.push(e);a=a.type;for(e=c.length-1;0<=e;e--){b.b=c[e];var f=Ti(c[e],a,!0,b);d=d&&f}for(e=0;e<c.length;e++)b.b=c[e],f=Ti(c[e],a,!1,b),d=d&&f}return d}return Si(a,new si(b,this))},Ki=function(a){a=a[Di];return a instanceof zi?a:null},Ui="__closure_events_fn_"+
(1E9*Math.random()>>>0),Ii=function(a){if(Xa(a))return a;a[Ui]||(a[Ui]=function(b){return a.handleEvent(b)});return a[Ui]};var B=function(){li.call(this);this.I=new zi(this);this.fm=this;this.R=null};t(B,li);B.prototype[ui]=!0;B.prototype.removeEventListener=function(a,b,c,d){Pi(this,a,b,c,d)};
B.prototype.G=function(a){var b,c=this.R;if(c)for(b=[];c;c=c.R)b.push(c);c=this.fm;var d=a.type||a;if(Ka(a))a=new z(a,c);else if(a instanceof z)a.target=a.target||c;else{var e=a;a=new z(d,c);gd(a,e)}e=!0;if(b)for(var f=b.length-1;0<=f;f--){var h=a.b=b[f];e=h.ne(d,!0,a)&&e}h=a.b=c;e=h.ne(d,!0,a)&&e;e=h.ne(d,!1,a)&&e;if(b)for(f=0;f<b.length;f++)h=a.b=b[f],e=h.ne(d,!1,a)&&e;return e};B.prototype.fa=function(){B.ha.fa.call(this);this.ti();this.R=null};
B.prototype.listen=function(a,b,c,d){return this.I.add(String(a),b,!1,c,d)};var Oi=function(a,b,c,d,e){return a.I.add(String(b),c,!0,d,e)};B.prototype.u=function(a,b,c,d){return this.I.remove(String(a),b,c,d)};B.prototype.ti=function(a){this.I&&this.I.removeAll(a)};
B.prototype.ne=function(a,b,c){a=this.I.a[String(a)];if(!a)return!0;a=a.concat();for(var d=!0,e=0;e<a.length;++e){var f=a[e];if(f&&!f.removed&&f.capture==b){var h=f.listener,k=f.jb||f.src;f.ig&&Bi(this.I,f);d=!1!==h.call(k,c)&&d}}return d&&0!=c.Uk};B.prototype.hasListener=function(a,b){return this.I.hasListener(Ja(a)?String(a):void 0,b)};var Vi="StopIteration"in Ia?Ia.StopIteration:{message:"StopIteration",stack:""},Wi=function(){};Wi.prototype.next=function(){throw Vi;};Wi.prototype.ob=function(){return this};
var Xi=function(a){if(a instanceof Wi)return a;if("function"==typeof a.ob)return a.ob(!1);if(Wa(a)){var b=0,c=new Wi;c.next=function(){for(;;){if(b>=a.length)throw Vi;if(b in a)return a[b++];b++}};return c}throw Error("Not implemented");},Yi=function(a,b,c){if(Wa(a))try{w(a,b,c)}catch(d){if(d!==Vi)throw d;}else{a=Xi(a);try{for(;;)b.call(c,a.next(),void 0,a)}catch(d){if(d!==Vi)throw d;}}},Zi=function(a,b){a=Xi(a);try{for(;!b.call(void 0,a.next(),void 0,a););}catch(c){if(c!==Vi)throw c;}},$i=function(a){if(Wa(a))return x(a);
a=Xi(a);var b=[];Yi(a,function(a){b.push(a)});return b};var aj=Ia.JSON.parse,bj=Ia.JSON.stringify;var cj=Ia.JSON.parse;var dj=function(a,b,c){a&&a.log(b,c,void 0)},ej=function(a,b,c){a&&a.log(Zh,b,c)},D=function(a,b,c){a&&a.log($h,b,c)},E=function(a,b){a&&a.info(b,void 0)},fj=function(a,b){a&&a.log(ci,b,void 0)};var gj=function(){};gj.prototype.a=null;var ij=function(a){var b;(b=a.a)||(b={},hj(a)&&(b[0]=!0,b[1]=!0),b=a.a=b);return b};var jj,kj=function(){};t(kj,gj);var lj=function(a){return(a=hj(a))?new ActiveXObject(a):new XMLHttpRequest},hj=function(a){if(!a.b&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var b=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],c=0;c<b.length;c++){var d=b[c];try{return new ActiveXObject(d),a.b=d}catch(e){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed");}return a.b};jj=new kj;var nj=function(a,b){this.b={};this.a=[];this.g=this.f=0;var c=arguments.length;if(1<c){if(c%2)throw Error("Uneven number of arguments");for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else a&&mj(this,a)};g=nj.prototype;g.na=function(){return this.f};g.X=function(){oj(this);for(var a=[],b=0;b<this.a.length;b++)a.push(this.b[this.a[b]]);return a};g.mb=function(){oj(this);return this.a.concat()};g.pb=function(a){return pj(this.b,a)};
g.ie=function(a){for(var b=0;b<this.a.length;b++){var c=this.a[b];if(pj(this.b,c)&&this.b[c]==a)return!0}return!1};g.equals=function(a,b){if(this===a)return!0;if(this.f!=a.na())return!1;b=b||qj;oj(this);for(var c,d=0;c=this.a[d];d++)if(!b(this.get(c),a.get(c)))return!1;return!0};var qj=function(a,b){return a===b};nj.prototype.Yb=function(){return 0==this.f};nj.prototype.clear=function(){this.b={};this.g=this.f=this.a.length=0};
nj.prototype.remove=function(a){return pj(this.b,a)?(delete this.b[a],this.f--,this.g++,this.a.length>2*this.f&&oj(this),!0):!1};var oj=function(a){if(a.f!=a.a.length){for(var b=0,c=0;b<a.a.length;){var d=a.a[b];pj(a.b,d)&&(a.a[c++]=d);b++}a.a.length=c}if(a.f!=a.a.length){var e={};for(c=b=0;b<a.a.length;)d=a.a[b],pj(e,d)||(a.a[c++]=d,e[d]=1),b++;a.a.length=c}};nj.prototype.get=function(a,b){return pj(this.b,a)?this.b[a]:b};
nj.prototype.set=function(a,b){pj(this.b,a)||(this.f++,this.a.push(a),this.g++);this.b[a]=b};var mj=function(a,b){if(b instanceof nj){var c=b.mb();b=b.X()}else c=Wc(b),b=Vc(b);for(var d=0;d<c.length;d++)a.set(c[d],b[d])};nj.prototype.forEach=function(a,b){for(var c=this.mb(),d=0;d<c.length;d++){var e=c[d],f=this.get(e);a.call(b,f,e,this)}};var rj=function(a){oj(a);for(var b={},c=0;c<a.a.length;c++){var d=a.a[c];b[d]=a.b[d]}return b};
nj.prototype.ob=function(a){oj(this);var b=0,c=this.g,d=this,e=new Wi;e.next=function(){if(c!=d.g)throw Error("The map has changed since the iterator was created");if(b>=d.a.length)throw Vi;var e=d.a[b++];return a?e:d.b[e]};return e};var pj=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};var sj=function(a){return a.na&&"function"==typeof a.na?a.na():Wa(a)||Ka(a)?a.length:Tc(a)},tj=function(a){if(a.X&&"function"==typeof a.X)return a.X();if(Ka(a))return a.split("");if(Wa(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return Vc(a)},uj=function(a){if(a.mb&&"function"==typeof a.mb)return a.mb();if(!a.X||"function"!=typeof a.X){if(Wa(a)||Ka(a)){var b=[];a=a.length;for(var c=0;c<a;c++)b.push(c);return b}return Wc(a)}},vj=function(a){return a.Yb&&"function"==typeof a.Yb?a.Yb():
Wa(a)||Ka(a)?0==a.length:Zc(a)},wj=function(a,b,c){if(a.forEach&&"function"==typeof a.forEach)a.forEach(b,c);else if(Wa(a)||Ka(a))w(a,b,c);else for(var d=uj(a),e=tj(a),f=e.length,h=0;h<f;h++)b.call(c,e[h],d&&d[h],a)},xj=function(a,b,c){if("function"==typeof a.map)return a.map(b,c);if(Wa(a)||Ka(a))return kc(a,b,c);var d=uj(a),e=tj(a),f=e.length;if(d){var h={};for(var k=0;k<f;k++)h[d[k]]=b.call(c,e[k],d[k],a)}else for(h=[],k=0;k<f;k++)h[k]=b.call(c,e[k],void 0,a);return h},yj=function(a,b){if("function"==
typeof a.every)return a.every(b,void 0);if(Wa(a)||Ka(a))return nc(a,b,void 0);for(var c=uj(a),d=tj(a),e=d.length,f=0;f<e;f++)if(!b.call(void 0,d[f],c&&c[f],a))return!1;return!0};var zj=function(a){a.prototype.then=a.prototype.then;a.prototype.$goog_Thenable=!0},Aj=function(a){if(!a)return!1;try{return!!a.$goog_Thenable}catch(b){return!1}};var Dj=function(a,b){this.a=0;this.v=void 0;this.g=this.b=this.f=null;this.l=this.h=!1;if(a!=Oa)try{var c=this;a.call(b,function(a){Bj(c,2,a)},function(a){if(!(a instanceof Cj))try{if(a instanceof Error)throw a;throw Error("Promise rejected.");}catch(e){}Bj(c,3,a)})}catch(d){Bj(this,3,d)}},Ej=function(){this.next=this.context=this.b=this.g=this.a=null;this.f=!1};Ej.prototype.reset=function(){this.context=this.b=this.g=this.a=null;this.f=!1};
var Fj=new vh(function(){return new Ej},function(a){a.reset()}),Gj=function(a,b,c){var d=Fj.get();d.g=a;d.b=b;d.context=c;return d},Hj=function(a){if(a instanceof Dj)return a;var b=new Dj(Oa);Bj(b,2,a);return b},Ij=function(a){return new Dj(function(b,c){c(a)})},Kj=function(a,b,c){Jj(a,b,c,null)||Nh(fb(b,a))},Lj=function(a){return new Dj(function(b,c){a.length||b(void 0);for(var d=0,e;d<a.length;d++)e=a[d],Kj(e,b,c)})},Mj=function(a){return new Dj(function(b,c){var d=a.length,e=[];if(d)for(var f=
function(a,c){d--;e[a]=c;0==d&&b(e)},h=function(a){c(a)},k=0,m;k<a.length;k++)m=a[k],Kj(m,fb(f,k),h);else b(e)})},Nj=function(a){return new Dj(function(b){var c=a.length,d=[];if(c)for(var e=function(a,e,f){c--;d[a]=e?{Ed:!0,value:f}:{Ed:!1,reason:f};0==c&&b(d)},f=0,h;f<a.length;f++)h=a[f],Kj(h,fb(e,f,!0),fb(e,f,!1));else b(d)})},ad=function(){var a,b,c=new Dj(function(c,e){a=c;b=e});return new Oj(c,a,b)};Dj.prototype.then=function(a,b,c){return Pj(this,Xa(a)?a:null,Xa(b)?b:null,c)};zj(Dj);
var Rj=function(a,b,c){b=Gj(b,b,c);b.f=!0;Qj(a,b);return a},Sj=function(a,b,c){return Pj(a,null,b,c)};Dj.prototype.cancel=function(a){0==this.a&&Nh(function(){var b=new Cj(a);Tj(this,b)},this)};
var Tj=function(a,b){if(0==a.a)if(a.f){var c=a.f;if(c.b){for(var d=0,e=null,f=null,h=c.b;h&&(h.f||(d++,h.a==a&&(e=h),!(e&&1<d)));h=h.next)e||(f=h);e&&(0==c.a&&1==d?Tj(c,b):(f?(d=f,d.next==c.g&&(c.g=d),d.next=d.next.next):Uj(c),Vj(c,e,3,b)))}a.f=null}else Bj(a,3,b)},Qj=function(a,b){a.b||2!=a.a&&3!=a.a||Wj(a);a.g?a.g.next=b:a.b=b;a.g=b},Pj=function(a,b,c,d){var e=Gj(null,null,null);e.a=new Dj(function(a,h){e.g=b?function(c){try{var e=b.call(d,c);a(e)}catch(r){h(r)}}:a;e.b=c?function(b){try{var e=c.call(d,
b);!Ja(e)&&b instanceof Cj?h(b):a(e)}catch(r){h(r)}}:h});e.a.f=a;Qj(a,e);return e.a};Dj.prototype.m=function(a){this.a=0;Bj(this,2,a)};Dj.prototype.s=function(a){this.a=0;Bj(this,3,a)};
var Bj=function(a,b,c){0==a.a&&(a===c&&(b=3,c=new TypeError("Promise cannot resolve to itself")),a.a=1,Jj(c,a.m,a.s,a)||(a.v=c,a.a=b,a.f=null,Wj(a),3!=b||c instanceof Cj||Xj(a,c)))},Jj=function(a,b,c,d){if(a instanceof Dj)return Qj(a,Gj(b||Oa,c||null,d)),!0;if(Aj(a))return a.then(b,c,d),!0;if(Ya(a))try{var e=a.then;if(Xa(e))return Yj(a,e,b,c,d),!0}catch(f){return c.call(d,f),!0}return!1},Yj=function(a,b,c,d,e){var f=!1,h=function(a){f||(f=!0,c.call(e,a))},k=function(a){f||(f=!0,d.call(e,a))};try{b.call(a,
h,k)}catch(m){k(m)}},Wj=function(a){a.h||(a.h=!0,Nh(a.u,a))},Uj=function(a){var b=null;a.b&&(b=a.b,a.b=b.next,b.next=null);a.b||(a.g=null);return b};Dj.prototype.u=function(){for(var a;a=Uj(this);)Vj(this,a,this.a,this.v);this.h=!1};
var Vj=function(a,b,c,d){if(3==c&&b.b&&!b.f)for(;a&&a.l;a=a.f)a.l=!1;if(b.a)b.a.f=null,Zj(b,c,d);else try{b.f?b.g.call(b.context):Zj(b,c,d)}catch(e){ak.call(null,e)}wh(Fj,b)},Zj=function(a,b,c){2==b?a.g.call(a.context,c):a.b&&a.b.call(a.context,c)},Xj=function(a,b){a.l=!0;Nh(function(){a.l&&ak.call(null,b)})},ak=Dh,Cj=function(a){ac.call(this,a)};t(Cj,ac);Cj.prototype.name="cancel";var Oj=function(a,b,c){this.O=a;this.resolve=b;this.reject=c};var bk=function(a,b){B.call(this);this.f=a||1;this.b=b||Ia;this.g=p(this.m,this);this.h=gb()};t(bk,B);bk.prototype.enabled=!1;bk.prototype.a=null;var ck=function(a,b){a.f=b;a.a&&a.enabled?(a.stop(),a.start()):a.a&&a.stop()};bk.prototype.m=function(){if(this.enabled){var a=gb()-this.h;0<a&&a<.8*this.f?this.a=this.b.setTimeout(this.g,this.f-a):(this.a&&(this.b.clearTimeout(this.a),this.a=null),this.G("tick"),this.enabled&&(this.a=this.b.setTimeout(this.g,this.f),this.h=gb()))}};
bk.prototype.start=function(){this.enabled=!0;this.a||(this.a=this.b.setTimeout(this.g,this.f),this.h=gb())};bk.prototype.stop=function(){this.enabled=!1;this.a&&(this.b.clearTimeout(this.a),this.a=null)};bk.prototype.fa=function(){bk.ha.fa.call(this);this.stop();delete this.b};
var dk=function(a,b,c){if(Xa(a))c&&(a=p(a,c));else if(a&&"function"==typeof a.handleEvent)a=p(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(b)?-1:Ia.setTimeout(a,b||0)},ek=function(a){Ia.clearTimeout(a)},fk=function(a){var b=null;return Sj(new Dj(function(c,d){b=dk(function(){c(void 0)},a);-1==b&&d(Error("Failed to schedule timer."))}),function(a){ek(b);throw a;})};var hk=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/,ik=function(a,b){if(a){a=a.split("&");for(var c=0;c<a.length;c++){var d=a[c].indexOf("="),e=null;if(0<=d){var f=a[c].substring(0,d);e=a[c].substring(d+1)}else f=a[c];b(f,e?decodeURIComponent(e.replace(/\+/g," ")):"")}}},jk=function(a,b,c){c=null!=c?"="+encodeURIComponent(String(c)):"";if(b+=c){c=a.indexOf("#");0>c&&(c=a.length);var d=a.indexOf("?");if(0>d||d>c){d=c;var e=""}else e=
a.substring(d+1,c);a=[a.substr(0,d),e,a.substr(c)];c=a[1];a[1]=b?c?c+"&"+b:b:c;a=a[0]+(a[1]?"?"+a[1]:"")+a[2]}return a},kk=/#|$/,lk=function(a,b){var c=a.search(kk);a:{var d=0;for(var e=b.length;0<=(d=a.indexOf(b,d))&&d<c;){var f=a.charCodeAt(d-1);if(38==f||63==f)if(f=a.charCodeAt(d+e),!f||61==f||38==f||35==f)break a;d+=e+1}d=-1}if(0>d)return null;e=a.indexOf("&",d);if(0>e||e>c)e=c;d+=b.length+1;return decodeURIComponent(a.substr(d,e-d).replace(/\+/g," "))},mk=function(a,b){var c=a.length-1;0<=c&&
a.indexOf("/",c)==c&&(a=a.substr(0,a.length-1));0==b.lastIndexOf("/",0)&&(b=b.substr(1));return Wb(a,"/",b)};var nk=function(a){B.call(this);this.headers=new nj;this.T=a||null;this.b=!1;this.N=this.a=null;this.pa=this.F="";this.m=0;this.f="";this.g=this.ia=this.B=this.aa=!1;this.h=0;this.w=null;this.s="";this.J=this.A=!1};t(nk,B);nk.prototype.j=ki("goog.net.XhrIo");var ok=/^https?$/i,pk=["POST","PUT"],qk=[],rk=function(a,b,c,d,e,f,h){var k=new nk;qk.push(k);b&&k.listen("complete",b);Oi(k,"ready",k.ka);f&&(k.h=Math.max(0,f));h&&(k.A=h);k.send(a,c,d,e);return k};
nk.prototype.ka=function(){this.Na();xc(qk,this)};
nk.prototype.send=function(a,b,c,d){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.F+"; newUri="+a);b=b?b.toUpperCase():"GET";this.F=a;this.f="";this.m=0;this.pa=b;this.aa=!1;this.b=!0;this.a=this.T?lj(this.T):lj(jj);this.N=this.T?ij(this.T):ij(jj);this.a.onreadystatechange=p(this.ra,this);try{fj(this.j,sk(this,"Opening Xhr")),this.ia=!0,this.a.open(b,String(a),!0),this.ia=!1}catch(f){fj(this.j,sk(this,"Error opening Xhr: "+f.message));tk(this,f);return}a=c||
"";var e=new nj(this.headers);d&&wj(d,function(a,b){e.set(b,a)});d=pc(e.mb(),uk);c=Ia.FormData&&a instanceof Ia.FormData;!rc(pk,b)||d||c||e.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");e.forEach(function(a,b){this.a.setRequestHeader(b,a)},this);this.s&&(this.a.responseType=this.s);"withCredentials"in this.a&&this.a.withCredentials!==this.A&&(this.a.withCredentials=this.A);try{vk(this),0<this.h&&(this.J=wk(this.a),fj(this.j,sk(this,"Will abort after "+this.h+"ms if incomplete, xhr2 "+
this.J)),this.J?(this.a.timeout=this.h,this.a.ontimeout=p(this.sa,this)):this.w=dk(this.sa,this.h,this)),fj(this.j,sk(this,"Sending request")),this.B=!0,this.a.send(a),this.B=!1}catch(f){fj(this.j,sk(this,"Send error: "+f.message)),tk(this,f)}};var wk=function(a){return ae&&ue(9)&&n(a.timeout)&&Ja(a.ontimeout)},uk=function(a){return Jb("Content-Type",a)};
nk.prototype.sa=function(){"undefined"!=typeof Ha&&this.a&&(this.f="Timed out after "+this.h+"ms, aborting",this.m=8,fj(this.j,sk(this,this.f)),this.G("timeout"),this.abort(8))};var tk=function(a,b){a.b=!1;a.a&&(a.g=!0,a.a.abort(),a.g=!1);a.f=b;a.m=5;xk(a);yk(a)},xk=function(a){a.aa||(a.aa=!0,a.G("complete"),a.G("error"))};nk.prototype.abort=function(a){this.a&&this.b&&(fj(this.j,sk(this,"Aborting")),this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.m=a||7,this.G("complete"),this.G("abort"),yk(this))};
nk.prototype.fa=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),yk(this,!0));nk.ha.fa.call(this)};nk.prototype.ra=function(){this.v||(this.ia||this.B||this.g?zk(this):this.va())};nk.prototype.va=function(){zk(this)};
var zk=function(a){if(a.b&&"undefined"!=typeof Ha)if(a.N[1]&&4==Ak(a)&&2==a.Sa())fj(a.j,sk(a,"Local request error detected and ignored"));else if(a.B&&4==Ak(a))dk(a.ra,0,a);else if(a.G("readystatechange"),4==Ak(a)){fj(a.j,sk(a,"Request complete"));a.b=!1;try{if(Bk(a))a.G("complete"),a.G("success");else{a.m=6;try{var b=2<Ak(a)?a.a.statusText:""}catch(c){fj(a.j,"Can not get status: "+c.message),b=""}a.f=b+" ["+a.Sa()+"]";xk(a)}}finally{yk(a)}}},yk=function(a,b){if(a.a){vk(a);var c=a.a,d=a.N[0]?Oa:null;
a.a=null;a.N=null;b||a.G("ready");try{c.onreadystatechange=d}catch(e){ej(a.j,"Problem encountered resetting onreadystatechange: "+e.message)}}},vk=function(a){a.a&&a.J&&(a.a.ontimeout=null);a.w&&(ek(a.w),a.w=null)},Bk=function(a){var b=a.Sa();a:switch(b){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break a;default:c=!1}if(!c){if(b=0===b)a=String(a.F).match(hk)[1]||null,!a&&Ia.self&&Ia.self.location&&(a=Ia.self.location.protocol,a=a.substr(0,a.length-1)),b=!ok.test(a?a.toLowerCase():
"");c=b}return c},Ak=function(a){return a.a?a.a.readyState:0};nk.prototype.Sa=function(){try{return 2<Ak(this)?this.a.status:-1}catch(a){return-1}};
var Ck=function(a){try{return a.a?a.a.responseText:""}catch(b){return fj(a.j,"Can not get responseText: "+b.message),""}},Dk=function(a){if(a.a)return cj(a.a.responseText)},Ek=function(a){try{if(!a.a)return null;if("response"in a.a)return a.a.response;switch(a.s){case "":case "text":return a.a.responseText;case "arraybuffer":if("mozResponseArrayBuffer"in a.a)return a.a.mozResponseArrayBuffer}ej(a.j,"Response type "+a.s+" is not supported on this browser");return null}catch(b){return fj(a.j,"Can not get response: "+
b.message),null}};nk.prototype.getResponseHeader=function(a){if(this.a&&4==Ak(this))return a=this.a.getResponseHeader(a),null===a?void 0:a};var Fk=function(a){var b={};a=(a.a&&4==Ak(a)?a.a.getAllResponseHeaders():"").split("\r\n");for(var c=0;c<a.length;c++)if(!Kb(a[c])){var d=$b(a[c],": ",2);b[d[0]]=b[d[0]]?b[d[0]]+(", "+d[1]):d[1]}return b},sk=function(a,b){return b+" ["+a.pa+" "+a.F+" "+a.Sa()+"]"};var Gk=function(){},Hk=function(a){if(!a.startsWith("urn:x-org.chromium:media:route:"))return null;var b=a.substring(31);if(!b)return null;var c=b.match(/([^/]*)\/([^-/]*)-([^/]*)\/(.*)/);if(!c)return null;b=new Gk;b.f=a;a=la(c);a.next();b.a=a.next().value;b.g=a.next().value;b.l=a.next().value;b.b=a.next().value;return b};Gk.prototype.ba=function(){return this.b};var Ik=function(a,b,c,d,e,f){this.id=a;this.presentationId=b;this.sinkId=c;this.mediaSource=d;this.isLocal=e;this.description=f;this.iconUrl=null;this.allowStop=!0;this.customControllerPath=null;this.supportsMediaRouteController=!1;this.controllerType=mojo&&mojo.RouteControllerType&&mojo.RouteControllerType.kNone;this.forDisplay=!0;this.offTheRecord=!1;this.je=e;this.isOffscreenPresentation=!1},Jk=function(a,b,c,d,e,f){b=d&&kg(d)?a:"urn:x-org.chromium:media:route:"+a+"/"+b+"-"+c+"/"+d;return new Ik(b,
a,c,d,e,f)};var Kk=function(a){this.b=a;this.a=1E3*Math.floor(1E6*Math.random())},Lk=function(a){var b=a.a++;0==b&&(b=a.a++);return b};Kk.prototype.ua=function(){return"IdGenerator."+this.b};Kk.prototype.Pa=function(){return[this.a]};Kk.prototype.Ta=function(){var a=ih(this);a&&(this.a=a)};var Mk=function(a,b,c,d,e){for(var f=[],h=4;h<arguments.length;++h)f[h-4]=arguments[h];var k=this;this.l=a;this.v=b;this.h=c;this.b=d;this.g=f;this.a=!1;this.f=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];return k.Gn.apply(k,[].concat(l(b)))}};g=Mk.prototype;g.addListener=function(){this.a||(this.a=!0,this.b.addListener.apply(this.b,[].concat([this.f],l(this.g))))};g.removeListener=function(){this.a&&(this.b.removeListener(this.f),this.a=!1)};
g.Xg=function(a){for(var b=0;b<arguments.length;++b);return!0};g.Gn=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];var d=this;gg(this.l);if(!this.Xg.apply(this,[].concat(l(b))))return!1;tg(this.h).then(function(a){return a.handleEvent.apply(a,[].concat([d.b],l(b)))});return this.sh()};g.ua=function(){return"mr.EventListener."+this.v};g.Pa=function(){return[this.a]};g.Ta=function(){ih(this)&&this.addListener()};g.sh=function(){};var Nk={serviceType:"_googlecast._tcp.local"},Ok=null,Pk=function(){Ok||(Ok=new Mk(7,"CastMdnsEventListener","mr.cast.SinkDiscoveryService",chrome.mdns.onServiceList,Nk));return Ok},Qk=null,Rk=function(){Qk||(Qk="ChromeOS"==Of()?new Mk(9,"CastNetworkListChangedEventListener","mr.cast.SinkDiscoveryService",chrome.networkingPrivate.onNetworkListChanged):new Mk(8,"CastNetworksChangedEventListener","mr.cast.SinkDiscoveryService",chrome.networkingPrivate.onNetworksChanged));return Qk},Sk=null,Tk=null,
Uk=function(){Sk||(Sk=new Mk(2,"CastChannelMessageListener","mr.cast.ChannelService",chrome.cast.channel.onMessage));Tk||(Tk=new Mk(1,"CastChannelErrorListener","mr.cast.ChannelService",chrome.cast.channel.onError));return[Sk,Tk]};chrome.cast.Ic={CUSTOM_CONTROLLER_SCOPED:"custom_controller_scoped",TAB_AND_ORIGIN_SCOPED:"tab_and_origin_scoped",ORIGIN_SCOPED:"origin_scoped",PAGE_SCOPED:"page_scoped"};q("chrome.cast.AutoJoinPolicy",chrome.cast.Ic);chrome.cast.Wf={CREATE_SESSION:"create_session",CAST_THIS_TAB:"cast_this_tab"};q("chrome.cast.DefaultActionPolicy",chrome.cast.Wf);chrome.cast.bd={VIDEO_OUT:"video_out",AUDIO_OUT:"audio_out",VIDEO_IN:"video_in",AUDIO_IN:"audio_in",MULTIZONE_GROUP:"multizone_group"};
q("chrome.cast.Capability",chrome.cast.bd);chrome.cast.Jc={CANCEL:"cancel",TIMEOUT:"timeout",API_NOT_INITIALIZED:"api_not_initialized",INVALID_PARAMETER:"invalid_parameter",EXTENSION_NOT_COMPATIBLE:"extension_not_compatible",EXTENSION_MISSING:"extension_missing",RECEIVER_UNAVAILABLE:"receiver_unavailable",SESSION_ERROR:"session_error",CHANNEL_ERROR:"channel_error",LOAD_MEDIA_FAILED:"load_media_failed"};q("chrome.cast.ErrorCode",chrome.cast.Jc);chrome.cast.rm={AVAILABLE:"available",UNAVAILABLE:"unavailable"};
q("chrome.cast.ReceiverAvailability",chrome.cast.rm);chrome.cast.Hm={CHROME:"chrome",IOS:"ios",ANDROID:"android"};q("chrome.cast.SenderPlatform",chrome.cast.Hm);chrome.cast.cg={CAST:"cast",DIAL:"dial",HANGOUT:"hangout",CUSTOM:"custom"};q("chrome.cast.ReceiverType",chrome.cast.cg);chrome.cast.Dl={RUNNING:"running",STOPPED:"stopped",ERROR:"error"};q("chrome.cast.DialAppState",chrome.cast.Dl);chrome.cast.bf={CAST:"cast",STOP:"stop"};q("chrome.cast.ReceiverAction",chrome.cast.bf);
chrome.cast.gj={CONNECTED:"connected",DISCONNECTED:"disconnected",STOPPED:"stopped"};q("chrome.cast.SessionStatus",chrome.cast.gj);chrome.cast.lj={ATTENUATION:"attenuation",FIXED:"fixed",MASTER:"master"};q("chrome.cast.VolumeControlType",chrome.cast.lj);chrome.cast.xl=function(a,b,c,d,e){this.sessionRequest=a;this.sessionListener=b;this.receiverListener=c;this.autoJoinPolicy=d||chrome.cast.Ic.TAB_AND_ORIGIN_SCOPED;this.defaultActionPolicy=e||chrome.cast.Wf.CREATE_SESSION;this.customDialLaunchCallback=null;this.invisibleSender=!1;this.additionalSessionRequests=[]};q("chrome.cast.ApiConfig",chrome.cast.xl);chrome.cast.Fl=function(a,b){this.appName=a;this.launchParameter=b||null};q("chrome.cast.DialRequest",chrome.cast.Fl);
chrome.cast.Oi=function(a,b,c){this.receiver=a;this.appState=b;this.extraData=c||null};q("chrome.cast.DialLaunchData",chrome.cast.Oi);chrome.cast.El=function(a,b){this.doLaunch=a;this.launchParameter=b||null};q("chrome.cast.DialLaunchResponse",chrome.cast.El);chrome.cast.fj=function(a,b,c){this.appId=a;this.capabilities=Va(b)?b:[chrome.cast.bd.VIDEO_OUT,chrome.cast.bd.AUDIO_OUT];this.requestSessionTimeout=c||chrome.cast.timeout.requestSession;this.dialRequest=this.language=null};
q("chrome.cast.SessionRequest",chrome.cast.fj);
chrome.cast.bh=function(a,b,c,d){this.label=a;a=b;Sb.test(a)&&(-1!=a.indexOf("&")&&(a=a.replace(Mb,"&amp;")),-1!=a.indexOf("<")&&(a=a.replace(Nb,"&lt;")),-1!=a.indexOf(">")&&(a=a.replace(Ob,"&gt;")),-1!=a.indexOf('"')&&(a=a.replace(Pb,"&quot;")),-1!=a.indexOf("'")&&(a=a.replace(Qb,"&#39;")),-1!=a.indexOf("\x00")&&(a=a.replace(Rb,"&#0;")));this.friendlyName=a;this.capabilities=c||[];this.volume=d||null;this.receiverType=chrome.cast.cg.CAST;this.displayStatus=this.isActiveInput=null};
q("chrome.cast.Receiver",chrome.cast.bh);chrome.cast.sm=function(a,b){this.statusText=a;this.appImages=b;this.showStop=null};q("chrome.cast.ReceiverDisplayStatus",chrome.cast.sm);chrome.cast.jj=function(){this.requestSession=6E4;this.sendCustomMessage=this.setReceiverVolume=this.stopSession=this.leaveSession=3E3};q("chrome.cast.Timeout",chrome.cast.jj);chrome.cast.timeout=new chrome.cast.jj;q("chrome.cast.timeout",chrome.cast.timeout);chrome.cast.Ki="auto-join";chrome.cast.bj="cast-session_";var Vk=function(a,b,c){this.sessionId=a;this.namespaceName=b;this.message=c};var Wk={STOP_MEDIA:"STOP",MEDIA_SET_VOLUME:"SET_VOLUME",MEDIA_GET_STATUS:"GET_STATUS"};var Xk=function(a,b){this.type="SET_VOLUME";this.requestId=0;this.volume=a;this.expectedVolume=b||null};var Yk=function(a){this.type="STOP";this.requestId=0;this.sessionId=a||null};chrome.cast.media.Ad={PAUSE:"pause",SEEK:"seek",STREAM_VOLUME:"stream_volume",STREAM_MUTE:"stream_mute"};q("chrome.cast.media.MediaCommand",chrome.cast.media.Ad);chrome.cast.media.qc={GENERIC:0,MOVIE:1,TV_SHOW:2,MUSIC_TRACK:3,PHOTO:4};q("chrome.cast.media.MetadataType",chrome.cast.media.qc);chrome.cast.media.af={IDLE:"IDLE",PLAYING:"PLAYING",PAUSED:"PAUSED",BUFFERING:"BUFFERING"};q("chrome.cast.media.PlayerState",chrome.cast.media.af);
chrome.cast.media.dh={OFF:"REPEAT_OFF",ALL:"REPEAT_ALL",SINGLE:"REPEAT_SINGLE",ALL_AND_SHUFFLE:"REPEAT_ALL_AND_SHUFFLE"};q("chrome.cast.media.RepeatMode",chrome.cast.media.dh);chrome.cast.media.tm={PLAYBACK_START:"PLAYBACK_START",PLAYBACK_PAUSE:"PLAYBACK_PAUSE"};q("chrome.cast.media.ResumeState",chrome.cast.media.tm);chrome.cast.media.hj={BUFFERED:"BUFFERED",LIVE:"LIVE",OTHER:"OTHER"};q("chrome.cast.media.StreamType",chrome.cast.media.hj);
chrome.cast.media.Pl={CANCELLED:"CANCELLED",INTERRUPTED:"INTERRUPTED",FINISHED:"FINISHED",ERROR:"ERROR"};q("chrome.cast.media.IdleReason",chrome.cast.media.Pl);chrome.cast.media.Tm={TEXT:"TEXT",AUDIO:"AUDIO",VIDEO:"VIDEO"};q("chrome.cast.media.TrackType",chrome.cast.media.Tm);chrome.cast.media.Qm={SUBTITLES:"SUBTITLES",CAPTIONS:"CAPTIONS",DESCRIPTIONS:"DESCRIPTIONS",CHAPTERS:"CHAPTERS",METADATA:"METADATA"};q("chrome.cast.media.TextTrackType",chrome.cast.media.Qm);
chrome.cast.media.Mm={NONE:"NONE",OUTLINE:"OUTLINE",DROP_SHADOW:"DROP_SHADOW",RAISED:"RAISED",DEPRESSED:"DEPRESSED"};q("chrome.cast.media.TextTrackEdgeType",chrome.cast.media.Mm);chrome.cast.media.Rm={NONE:"NONE",NORMAL:"NORMAL",ROUNDED_CORNERS:"ROUNDED_CORNERS"};q("chrome.cast.media.TextTrackWindowType",chrome.cast.media.Rm);
chrome.cast.media.Nm={SANS_SERIF:"SANS_SERIF",MONOSPACED_SANS_SERIF:"MONOSPACED_SANS_SERIF",SERIF:"SERIF",MONOSPACED_SERIF:"MONOSPACED_SERIF",CASUAL:"CASUAL",CURSIVE:"CURSIVE",SMALL_CAPITALS:"SMALL_CAPITALS"};q("chrome.cast.media.TextTrackFontGenericFamily",chrome.cast.media.Nm);chrome.cast.media.Om={NORMAL:"NORMAL",BOLD:"BOLD",BOLD_ITALIC:"BOLD_ITALIC",ITALIC:"ITALIC"};q("chrome.cast.media.TextTrackFontStyle",chrome.cast.media.Om);chrome.cast.media.Nl=function(){this.customData=null};q("chrome.cast.media.GetStatusRequest",chrome.cast.media.Nl);chrome.cast.media.bm=function(){this.customData=null};q("chrome.cast.media.PauseRequest",chrome.cast.media.bm);chrome.cast.media.dm=function(){this.customData=null};q("chrome.cast.media.PlayRequest",chrome.cast.media.dm);chrome.cast.media.Fm=function(){this.customData=this.resumeState=this.currentTime=null};q("chrome.cast.media.SeekRequest",chrome.cast.media.Fm);
chrome.cast.media.Im=function(){this.customData=null};q("chrome.cast.media.StopRequest",chrome.cast.media.Im);chrome.cast.media.Xm=function(a){this.volume=a;this.customData=null};q("chrome.cast.media.VolumeRequest",chrome.cast.media.Xm);chrome.cast.media.Rl=function(a){this.type="LOAD";this.requestId=0;this.sessionId=null;this.media=a;this.activeTrackIds=null;this.autoplay=!0;this.customData=this.currentTime=null};q("chrome.cast.media.LoadRequest",chrome.cast.media.Rl);
chrome.cast.media.yu=function(a){this.type="PRECACHE";this.requestId=0;this.precacheData=a};chrome.cast.media.Il=function(a,b){this.requestId=0;this.activeTrackIds=a||null;this.textTrackStyle=b||null};q("chrome.cast.media.EditTracksInfoRequest",chrome.cast.media.Il);chrome.cast.media.Ml=function(){this.metadataType=this.type=chrome.cast.media.qc.GENERIC;this.releaseDate=this.releaseYear=this.images=this.subtitle=this.title=null};q("chrome.cast.media.GenericMediaMetadata",chrome.cast.media.Ml);
chrome.cast.media.Ul=function(){this.metadataType=this.type=chrome.cast.media.qc.MOVIE;this.releaseDate=this.releaseYear=this.images=this.subtitle=this.studio=this.title=null};q("chrome.cast.media.MovieMediaMetadata",chrome.cast.media.Ul);chrome.cast.media.Um=function(){this.metadataType=this.type=chrome.cast.media.qc.TV_SHOW;this.originalAirdate=this.releaseYear=this.images=this.episode=this.episodeNumber=this.season=this.seasonNumber=this.episodeTitle=this.title=this.seriesTitle=null};
q("chrome.cast.media.TvShowMediaMetadata",chrome.cast.media.Um);chrome.cast.media.Vl=function(){this.metadataType=this.type=chrome.cast.media.qc.MUSIC_TRACK;this.releaseDate=this.releaseYear=this.images=this.discNumber=this.trackNumber=this.artistName=this.songName=this.composer=this.artist=this.albumArtist=this.title=this.albumName=null};q("chrome.cast.media.MusicTrackMediaMetadata",chrome.cast.media.Vl);
chrome.cast.media.cm=function(){this.metadataType=this.type=chrome.cast.media.qc.PHOTO;this.creationDateTime=this.height=this.width=this.longitude=this.latitude=this.images=this.location=this.artist=this.title=null};q("chrome.cast.media.PhotoMediaMetadata",chrome.cast.media.cm);chrome.cast.media.Tl=function(a,b){this.contentId=a;this.streamType=chrome.cast.media.hj.BUFFERED;this.contentType=b;this.customData=this.textTrackStyle=this.tracks=this.duration=this.metadata=null};
q("chrome.cast.media.MediaInfo",chrome.cast.media.Tl);chrome.cast.media.hm=function(a){this.itemId=null;this.media=a;this.autoplay=!0;this.startTime=0;this.playbackDuration=null;this.preloadTime=0;this.customData=this.activeTrackIds=null};q("chrome.cast.media.QueueItem",chrome.cast.media.hm);chrome.cast.media.Bl="CC1AD845";q("chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID",chrome.cast.media.Bl);chrome.cast.media.timeout={};chrome.cast.media.timeout.load=0;q("chrome.cast.media.timeout.load",chrome.cast.media.timeout.load);
chrome.cast.media.timeout.Sa=0;q("chrome.cast.media.timeout.getStatus",chrome.cast.media.timeout.Sa);chrome.cast.media.timeout.play=0;q("chrome.cast.media.timeout.play",chrome.cast.media.timeout.play);chrome.cast.media.timeout.pause=0;q("chrome.cast.media.timeout.pause",chrome.cast.media.timeout.pause);chrome.cast.media.timeout.seek=0;q("chrome.cast.media.timeout.seek",chrome.cast.media.timeout.seek);chrome.cast.media.timeout.stop=0;q("chrome.cast.media.timeout.stop",chrome.cast.media.timeout.stop);
chrome.cast.media.timeout.Ec=0;q("chrome.cast.media.timeout.setVolume",chrome.cast.media.timeout.Ec);chrome.cast.media.timeout.th=0;q("chrome.cast.media.timeout.editTracksInfo",chrome.cast.media.timeout.th);chrome.cast.media.timeout.lp=0;q("chrome.cast.media.timeout.queue",chrome.cast.media.timeout.lp);chrome.cast.media.Sm=function(a,b){this.trackId=a;this.trackContentType=this.trackContentId=null;this.type=b;this.customData=this.subtype=this.language=this.name=null};q("chrome.cast.media.Track",chrome.cast.media.Sm);
chrome.cast.media.Pm=function(){this.customData=this.fontStyle=this.fontGenericFamily=this.fontFamily=this.fontScale=this.windowRoundedCornerRadius=this.windowColor=this.windowType=this.edgeColor=this.edgeType=this.backgroundColor=this.foregroundColor=null};q("chrome.cast.media.TextTrackStyle",chrome.cast.media.Pm);chrome.cast.media.jm=function(a){this.type="QUEUE_LOAD";this.sessionId=this.requestId=null;this.items=a;this.startIndex=0;this.repeatMode=chrome.cast.media.dh.OFF;this.customData=null};
q("chrome.cast.media.QueueLoadRequest",chrome.cast.media.jm);chrome.cast.media.gm=function(a){this.type="QUEUE_INSERT";this.sessionId=this.requestId=null;this.items=a;this.customData=this.insertBefore=null};q("chrome.cast.media.QueueInsertItemsRequest",chrome.cast.media.gm);chrome.cast.media.nm=function(a){this.type="QUEUE_UPDATE";this.sessionId=this.requestId=null;this.items=a;this.customData=null};q("chrome.cast.media.QueueUpdateItemsRequest",chrome.cast.media.nm);
chrome.cast.media.im=function(){this.type="QUEUE_UPDATE";this.customData=this.jump=this.currentItemId=this.sessionId=this.requestId=null};q("chrome.cast.media.QueueJumpRequest",chrome.cast.media.im);chrome.cast.media.mm=function(){this.type="QUEUE_UPDATE";this.customData=this.repeatMode=this.sessionId=this.requestId=null};q("chrome.cast.media.QueueSetPropertiesRequest",chrome.cast.media.mm);
chrome.cast.media.km=function(a){this.type="QUEUE_REMOVE";this.sessionId=this.requestId=null;this.itemIds=a;this.customData=null};q("chrome.cast.media.QueueRemoveItemsRequest",chrome.cast.media.km);chrome.cast.media.lm=function(a){this.type="QUEUE_REORDER";this.sessionId=this.requestId=null;this.itemIds=a;this.customData=this.insertBefore=null};q("chrome.cast.media.QueueReorderItemsRequest",chrome.cast.media.lm);chrome.cast.VERSION=[1,2];q("chrome.cast.VERSION",chrome.cast.VERSION);chrome.cast.hq=!0;q("chrome.cast.usingPresentationApi",chrome.cast.hq);chrome.cast.Error=function(a,b,c){this.code=a;this.description=b||null;this.details=c||null};q("chrome.cast.Error",chrome.cast.Error);chrome.cast.Gm=function(a){this.platform=a;this.packageId=this.url=null};q("chrome.cast.SenderApplication",chrome.cast.Gm);chrome.cast.Image=function(a){this.url=a;this.width=this.height=null};q("chrome.cast.Image",chrome.cast.Image);
chrome.cast.Volume=function(a,b){this.level=Ja(a)?a:null;this.muted=Ja(b)?b:null};q("chrome.cast.Volume",chrome.cast.Volume);chrome.cast.media.K=function(a,b){this.sessionId=a;this.mediaSessionId=b;this.media=null;this.playbackRate=1;this.playerState=chrome.cast.media.af.IDLE;this.currentTime=0;this.supportedMediaCommands=[];this.volume=new chrome.cast.Volume;this.items=this.preloadedItemId=this.loadingItemId=this.currentItemId=this.customData=this.activeTrackIds=this.idleReason=null;this.repeatMode=chrome.cast.media.dh.OFF};q("chrome.cast.media.Media",chrome.cast.media.K);chrome.cast.media.K.prototype.Sa=function(){};
chrome.cast.media.K.prototype.getStatus=chrome.cast.media.K.prototype.Sa;chrome.cast.media.K.prototype.play=function(){};chrome.cast.media.K.prototype.play=chrome.cast.media.K.prototype.play;chrome.cast.media.K.prototype.ep=function(){};chrome.cast.media.K.prototype.playWithContext=chrome.cast.media.K.prototype.ep;chrome.cast.media.K.prototype.pause=function(){};chrome.cast.media.K.prototype.pause=chrome.cast.media.K.prototype.pause;chrome.cast.media.K.prototype.cp=function(){};
chrome.cast.media.K.prototype.pauseWithContext=chrome.cast.media.K.prototype.cp;chrome.cast.media.K.prototype.seek=function(){};chrome.cast.media.K.prototype.seek=chrome.cast.media.K.prototype.seek;chrome.cast.media.K.prototype.stop=function(){};chrome.cast.media.K.prototype.stop=chrome.cast.media.K.prototype.stop;chrome.cast.media.K.prototype.Ec=function(){};chrome.cast.media.K.prototype.setVolume=chrome.cast.media.K.prototype.Ec;chrome.cast.media.K.prototype.th=function(){};
chrome.cast.media.K.prototype.editTracksInfo=chrome.cast.media.K.prototype.th;chrome.cast.media.K.prototype.np=function(){};chrome.cast.media.K.prototype.queueInsertItems=chrome.cast.media.K.prototype.np;chrome.cast.media.K.prototype.mp=function(){};chrome.cast.media.K.prototype.queueAppendItem=chrome.cast.media.K.prototype.mp;chrome.cast.media.K.prototype.xp=function(){};chrome.cast.media.K.prototype.queueUpdateItems=chrome.cast.media.K.prototype.xp;chrome.cast.media.K.prototype.sp=function(){};
chrome.cast.media.K.prototype.queuePrev=chrome.cast.media.K.prototype.sp;chrome.cast.media.K.prototype.rp=function(){};chrome.cast.media.K.prototype.queueNext=chrome.cast.media.K.prototype.rp;chrome.cast.media.K.prototype.op=function(a){Zk(this,a)};chrome.cast.media.K.prototype.queueJumpToItem=chrome.cast.media.K.prototype.op;chrome.cast.media.K.prototype.wp=function(){};chrome.cast.media.K.prototype.queueSetRepeatMode=chrome.cast.media.K.prototype.wp;chrome.cast.media.K.prototype.up=function(){};
chrome.cast.media.K.prototype.queueRemoveItems=chrome.cast.media.K.prototype.up;chrome.cast.media.K.prototype.tp=function(a){Zk(this,a)};chrome.cast.media.K.prototype.queueRemoveItem=chrome.cast.media.K.prototype.tp;chrome.cast.media.K.prototype.vp=function(){};chrome.cast.media.K.prototype.queueReorderItems=chrome.cast.media.K.prototype.vp;chrome.cast.media.K.prototype.qp=function(a,b,c,d){a=Zk(this,a);0>a||(0>b?d&&d(new chrome.cast.Error(chrome.cast.Jc.INVALID_PARAMETER)):a==b&&c&&c())};
chrome.cast.media.K.prototype.queueMoveItemToNewIndex=chrome.cast.media.K.prototype.qp;chrome.cast.media.K.prototype.fq=function(a){return-1<this.supportedMediaCommands.indexOf(a)};chrome.cast.media.K.prototype.supportsCommand=chrome.cast.media.K.prototype.fq;chrome.cast.media.K.prototype.On=function(){return this.currentTime};chrome.cast.media.K.prototype.getEstimatedTime=chrome.cast.media.K.prototype.On;chrome.cast.media.K.prototype.gh=function(){};
chrome.cast.media.K.prototype.addUpdateListener=chrome.cast.media.K.prototype.gh;chrome.cast.media.K.prototype.hh=function(){};chrome.cast.media.K.prototype.addUpdateListenerWithContext=chrome.cast.media.K.prototype.hh;chrome.cast.media.K.prototype.ui=function(){};chrome.cast.media.K.prototype.removeUpdateListener=chrome.cast.media.K.prototype.ui;chrome.cast.media.K.prototype.vi=function(){};chrome.cast.media.K.prototype.removeUpdateListenerWithContext=chrome.cast.media.K.prototype.vi;
var Zk=function(a,b){return oc(a.items,function(a){return a.itemId==b})};chrome.cast.M=function(a,b,c,d,e){this.sessionId=a;this.appId=b;this.displayName=c;this.statusText=null;this.appImages=d;this.receiver=e;this.senderApps=[];this.namespaces=[];this.media=[];this.status=chrome.cast.gj.CONNECTED;this.transportId=""};q("chrome.cast.Session",chrome.cast.M);chrome.cast.M.prototype.Tp=function(a,b,c){this.fl(null,a,b,c)};chrome.cast.M.prototype.setReceiverVolumeLevel=chrome.cast.M.prototype.Tp;
chrome.cast.M.prototype.fl=function(a,b,c,d){b=new Xk(new chrome.cast.Volume(b,null),this.receiver.volume);a.setReceiverVolume(this.sessionId,b,c,d)};chrome.cast.M.prototype.setReceiverVolumeLevelWithContext=chrome.cast.M.prototype.fl;chrome.cast.M.prototype.Sp=function(a,b,c){this.el(null,a,b,c)};chrome.cast.M.prototype.setReceiverMuted=chrome.cast.M.prototype.Sp;
chrome.cast.M.prototype.el=function(a,b,c,d){a=new Xk(new chrome.cast.Volume(null,b),this.receiver.volume);null.setReceiverVolume(this.sessionId,a,c,d)};chrome.cast.M.prototype.setReceiverMutedWithContext=chrome.cast.M.prototype.el;chrome.cast.M.prototype.leave=function(a,b){null.leaveSession(this.sessionId,a,b)};chrome.cast.M.prototype.leave=chrome.cast.M.prototype.leave;chrome.cast.M.prototype.stop=function(){};chrome.cast.M.prototype.stop=chrome.cast.M.prototype.stop;
chrome.cast.M.prototype.Zp=function(){};chrome.cast.M.prototype.stopWithContext=chrome.cast.M.prototype.Zp;chrome.cast.M.prototype.sendMessage=function(){};chrome.cast.M.prototype.sendMessage=chrome.cast.M.prototype.sendMessage;chrome.cast.M.prototype.Ip=function(){};chrome.cast.M.prototype.sendMessageWithContext=chrome.cast.M.prototype.Ip;chrome.cast.M.prototype.gh=function(){};chrome.cast.M.prototype.addUpdateListener=chrome.cast.M.prototype.gh;chrome.cast.M.prototype.hh=function(){};
chrome.cast.M.prototype.addUpdateListenerWithContext=chrome.cast.M.prototype.hh;chrome.cast.M.prototype.ui=function(){};chrome.cast.M.prototype.removeUpdateListener=chrome.cast.M.prototype.ui;chrome.cast.M.prototype.vi=function(){};chrome.cast.M.prototype.removeUpdateListenerWithContext=chrome.cast.M.prototype.vi;chrome.cast.M.prototype.ln=function(){};chrome.cast.M.prototype.addMessageListener=chrome.cast.M.prototype.ln;chrome.cast.M.prototype.mn=function(){};
chrome.cast.M.prototype.addMessageListenerWithContext=chrome.cast.M.prototype.mn;chrome.cast.M.prototype.jn=function(){};chrome.cast.M.prototype.addMediaListener=chrome.cast.M.prototype.jn;chrome.cast.M.prototype.kn=function(){};chrome.cast.M.prototype.addMediaListenerWithContext=chrome.cast.M.prototype.kn;chrome.cast.M.prototype.Ap=function(){};chrome.cast.M.prototype.removeMediaListener=chrome.cast.M.prototype.Ap;chrome.cast.M.prototype.Bp=function(){};
chrome.cast.M.prototype.removeMediaListenerWithContext=chrome.cast.M.prototype.Bp;chrome.cast.M.prototype.Cp=function(){};chrome.cast.M.prototype.removeMessageListener=chrome.cast.M.prototype.Cp;chrome.cast.M.prototype.Dp=function(){};chrome.cast.M.prototype.removeMessageListenerWithContext=chrome.cast.M.prototype.Dp;chrome.cast.M.prototype.io=function(a){a.sessionId=this.sessionId};chrome.cast.M.prototype.loadMedia=chrome.cast.M.prototype.io;chrome.cast.M.prototype.pp=function(a){a.sessionId=this.sessionId};
chrome.cast.M.prototype.queueLoad=chrome.cast.M.prototype.pp;var $k=function(a,b,c){this.hk=a;this.Sh=b;this.a=c},al=function(a){var b="cast-dial:"+a.hk,c=new URLSearchParams;a.Sh&&c.set("dialPostData",a.Sh);a.a&&c.set("clientId",a.a);(a=c.toString())&&(b+="?"+a);return b};var bl=function(a,b,c){this.type=a;this.message=b;this.sequenceNumber=Ja(c)?c:-1;this.timeoutMillis=0;this.clientId=""};var cl=function(a){this.Xb=this.l=this.b="";this.La=null;this.f=this.a="";this.g=!1;var b;a instanceof cl?(this.g=Ja(void 0)?void 0:a.g,dl(this,a.b),this.l=a.l,this.Xb=a.Xb,el(this,a.Oa()),this.a=a.a,fl(this,gl(a.h)),this.f=a.f):a&&(b=String(a).match(hk))?(this.g=!1,dl(this,b[1]||"",!0),this.l=hl(b[2]||""),this.Xb=hl(b[3]||"",!0),el(this,b[4]),this.a=hl(b[5]||"",!0),fl(this,b[6]||"",!0),this.f=hl(b[7]||"")):(this.g=!1,this.h=new il(null,this.g))};
cl.prototype.toString=function(){var a=[],b=this.b;b&&a.push(jl(b,kl,!0),":");var c=this.Xb;if(c||"file"==b)a.push("//"),(b=this.l)&&a.push(jl(b,kl,!0),"@"),a.push(encodeURIComponent(String(c)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c=this.Oa(),null!=c&&a.push(":",String(c));if(c=this.a)this.Xb&&"/"!=c.charAt(0)&&a.push("/"),a.push(jl(c,"/"==c.charAt(0)?ll:ml,!0));(c=this.h.toString())&&a.push("?",c);(c=this.f)&&a.push("#",jl(c,nl));return a.join("")};
cl.prototype.resolve=function(a){var b=new cl(this),c=!!a.b;c?dl(b,a.b):c=!!a.l;c?b.l=a.l:c=!!a.Xb;c?b.Xb=a.Xb:c=null!=a.La;var d=a.a;if(c)el(b,a.Oa());else if(c=!!a.a){if("/"!=d.charAt(0))if(this.Xb&&!this.a)d="/"+d;else{var e=b.a.lastIndexOf("/");-1!=e&&(d=b.a.substr(0,e+1)+d)}e=d;if(".."==e||"."==e)d="";else if(-1!=e.indexOf("./")||-1!=e.indexOf("/.")){d=0==e.lastIndexOf("/",0);e=e.split("/");for(var f=[],h=0;h<e.length;){var k=e[h++];"."==k?d&&h==e.length&&f.push(""):".."==k?((1<f.length||1==
f.length&&""!=f[0])&&f.pop(),d&&h==e.length&&f.push("")):(f.push(k),d=!0)}d=f.join("/")}else d=e}c?b.a=d:c=""!==a.h.toString();c?fl(b,gl(a.h)):c=!!a.f;c&&(b.f=a.f);return b};var dl=function(a,b,c){a.b=c?hl(b,!0):b;a.b&&(a.b=a.b.replace(/:$/,""))};cl.prototype.Oa=function(){return this.La};
var el=function(a,b){if(b){b=Number(b);if(isNaN(b)||0>b)throw Error("Bad port number "+b);a.La=b}else a.La=null},fl=function(a,b,c){b instanceof il?(a.h=b,ol(a.h,a.g)):(c||(b=jl(b,pl)),a.h=new il(b,a.g))},hl=function(a,b){return a?b?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""},jl=function(a,b,c){return Ka(a)?(a=encodeURI(a).replace(b,ql),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null},ql=function(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)},
kl=/[#\/\?@]/g,ml=/[#\?:]/g,ll=/[#\?]/g,pl=/[#\?@]/g,nl=/#/g,il=function(a,b){this.b=this.a=null;this.f=a||null;this.g=!!b},rl=function(a){a.a||(a.a=new nj,a.b=0,a.f&&ik(a.f,function(b,c){a.add(decodeURIComponent(b.replace(/\+/g," ")),c)}))},tl=function(a){var b=uj(a);if("undefined"==typeof b)throw Error("Keys are undefined");var c=new il(null,void 0);a=tj(a);for(var d=0;d<b.length;d++){var e=b[d],f=a[d];Va(f)?sl(c,e,f):c.add(e,f)}return c};g=il.prototype;g.na=function(){rl(this);return this.b};
g.add=function(a,b){rl(this);this.f=null;a=ul(this,a);var c=this.a.get(a);c||this.a.set(a,c=[]);c.push(b);this.b+=1;return this};g.remove=function(a){rl(this);a=ul(this,a);return this.a.pb(a)?(this.f=null,this.b-=this.a.get(a).length,this.a.remove(a)):!1};g.clear=function(){this.a=this.f=null;this.b=0};g.Yb=function(){rl(this);return 0==this.b};g.pb=function(a){rl(this);a=ul(this,a);return this.a.pb(a)};g.ie=function(a){var b=this.X();return rc(b,a)};
g.forEach=function(a,b){rl(this);this.a.forEach(function(c,d){w(c,function(c){a.call(b,c,d,this)},this)},this)};g.mb=function(){rl(this);for(var a=this.a.X(),b=this.a.mb(),c=[],d=0;d<b.length;d++)for(var e=a[d],f=0;f<e.length;f++)c.push(b[d]);return c};g.X=function(a){rl(this);var b=[];if(Ka(a))this.pb(a)&&(b=Cc(b,this.a.get(ul(this,a))));else{a=this.a.X();for(var c=0;c<a.length;c++)b=Cc(b,a[c])}return b};
g.set=function(a,b){rl(this);this.f=null;a=ul(this,a);this.pb(a)&&(this.b-=this.a.get(a).length);this.a.set(a,[b]);this.b+=1;return this};g.get=function(a,b){a=a?this.X(a):[];return 0<a.length?String(a[0]):b};var sl=function(a,b,c){a.remove(b);0<c.length&&(a.f=null,a.a.set(ul(a,b),x(c)),a.b+=c.length)};
il.prototype.toString=function(){if(this.f)return this.f;if(!this.a)return"";for(var a=[],b=this.a.mb(),c=0;c<b.length;c++){var d=b[c],e=encodeURIComponent(String(d));d=this.X(d);for(var f=0;f<d.length;f++){var h=e;""!==d[f]&&(h+="="+encodeURIComponent(String(d[f])));a.push(h)}}return this.f=a.join("&")};
var gl=function(a){var b=new il;b.f=a.f;a.a&&(b.a=new nj(a.a),b.b=a.b);return b},ul=function(a,b){b=String(b);a.g&&(b=b.toLowerCase());return b},ol=function(a,b){b&&!a.g&&(rl(a),a.f=null,a.a.forEach(function(a,b){var c=b.toLowerCase();b!=c&&(this.remove(b),sl(this,c,a))},a));a.g=b};il.prototype.extend=function(a){for(var b=0;b<arguments.length;b++)wj(arguments[b],function(a,b){this.add(b,a)},this)};var vl=function(a,b,c,d,e,f,h,k,m,r){this.l=a;this.a=b||null;this.b=c||null;this.f=d||null;this.g=Ja(e)?e:null;this.m=f||null;this.s=h||null;this.u=k||!1;this.v=m||null;this.h=r||null},wl=function(a,b){return(a=a.match(b+"=([^/]*)"))?a[1]:null},yl=function(a){a=a.match(/__castAppId__=([^/]*)/g);return null==a?[]:jc(kc(a,function(a){a=wl(a,"__castAppId__");if(!a)return null;a=a.match(xl);if(!a||0==a.length)return null;var b=[];3==a.length&&a[2]&&(b=a[2].split(","));return{appId:a[1],capabilities:b}}),
function(a){return null!=a})},zl=function(a){return kc(a.l,function(a){return a.appId})},Al=function(a){return a.b?a.b:chrome.cast.Ic.TAB_AND_ORIGIN_SCOPED},Bl=function(a){var b=a.l.map(function(b){var c="cast:"+b.appId,e=new URLSearchParams;b.capabilities&&0<b.capabilities.length&&e.set("capabilities",b.capabilities.join(","));a.a&&e.set("clientId",a.a);a.b&&e.set("autoJoinPolicy",a.b);a.f&&e.set("defaultActionPolicy",a.f);null!=a.g&&e.set("launchTimeout",String(a.g));a.u&&e.set("invisibleSender",
"true");a.v&&(e.set("broadcastNamespace",a.v),e.set("broadcastId",String(Math.random())));a.h&&e.set("broadcastMessage",encodeURIComponent(JSON.stringify(a.h)));return c+"?"+e.toString()});a.m&&b.push(al(new $k(a.m,a.s,a.a)));return b},Dl=function(a,b){a=zl(a);var c=Cl(b);return mc(a,function(a){return rc(c,a)})},El=function(a){try{var b=new URL(a)}catch(y){return null}if("https:"==b.protocol)if("https:"!=b.protocol||"google.com"!=b.host||"/cast"!=b.pathname)a=null;else{var c=b.hash;if((a=yl(c))&&
0!=a.length){b=wl(c,"__castClientId__");var d=wl(c,"__castAutoJoinPolicy__"),e=wl(c,"__castDefaultActionPolicy__");var f=wl(c,"__castLaunchTimeout__");null==f?f=null:(f=Number(f),f=!isNaN(f)&&0<f?f:null);var h=wl(c,"__dialAppName__"),k=wl(c,"__dialPostData__");var m=wl(c,"__castInvisibleSender__");m=null===m?null:"true"==m;var r=wl(c,"__castBroadcastNamespace__");c=(c=wl(c,"__castBroadcastMessage__"))?JSON.parse(decodeURIComponent(c)):null;a=new vl(a,b,d,e,f,h,k,m,r,c)}else a=null}else if("cast:"==
b.protocol){a=b.pathname;d=b.searchParams.get("capabilities");a={appId:a,capabilities:d?d.split(","):[]};k=b.searchParams;b=k.get("clientId");d=k.get("autoJoinPolicy");e=k.get("defaultActionPolicy");c=Number(k.get("launchTimeout"));if(isNaN(c)||0>=c)c=null;f="true"==k.get("invisibleSender");h=k.get("broadcastNamespace");k=(k=k.get("broadcastMessage"))?JSON.parse(decodeURIComponent(k)):null;a=new vl([a],b,d,e,c,void 0,void 0,f,h,k)}else a=null;return a},Cl=function(a){return(a=El(a))?zl(a):null},Fl=
function(a){return(a=El(a))?a.a:null},xl=/(^\w+)(?:\(([\w, ]*)\))?$/;var Hl=function(a){this.a=new nj;a&&Gl(this,a)},Il=function(a){var b=typeof a;return"object"==b&&a||"function"==b?"o"+(a[$a]||(a[$a]=++cb)):b.substr(0,1)+a};Hl.prototype.na=function(){return this.a.na()};Hl.prototype.add=function(a){this.a.set(Il(a),a)};var Gl=function(a,b){b=tj(b);for(var c=b.length,d=0;d<c;d++)a.add(b[d])};g=Hl.prototype;g.removeAll=function(a){a=tj(a);for(var b=a.length,c=0;c<b;c++)this.remove(a[c])};g.remove=function(a){return this.a.remove(Il(a))};g.clear=function(){this.a.clear()};
g.Yb=function(){return this.a.Yb()};g.contains=function(a){return this.a.pb(Il(a))};g.X=function(){return this.a.X()};g.equals=function(a){return this.na()==sj(a)&&Jl(this,a)};var Jl=function(a,b){var c=sj(b);if(a.na()>c)return!1;!(b instanceof Hl)&&5<c&&(b=new Hl(b));return yj(a,function(a){var c=b;return c.contains&&"function"==typeof c.contains?c.contains(a):c.ie&&"function"==typeof c.ie?c.ie(a):Wa(c)||Ka(c)?rc(c,a):Yc(c,a)})};Hl.prototype.ob=function(){return this.a.ob(!1)};var Kl=function(a,b){this.sinks=a;this.origins=b||null},Ll=new Kl([]);var Ml=function(){this.a=[]};Ml.prototype.listen=function(a,b,c){this.a.push({type:a,jb:b,target:c})};Ml.prototype.u=function(a,b,c){var d=this.a.findIndex(function(d){return d.type==a&&d.jb==b&&d.target==c});-1!=d&&this.a.splice(d,1)};var Nl=function(a,b){a.a.forEach(function(a){a.type==b.type&&Promise.resolve().then(function(){return a.jb.call(a.target,b)})})};var Ol=/^([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/,Pl=[4278190080,4293918720,4294901760],Ql=[167772160,2886729728,3232235520],Rl=function(a){var b=document.createElement("a");b.href=a;return b};var Tl=function(a,b,c,d){b="["+b+"]: "+c+" "+d.responseURL+" => "+d.status+" ("+d.statusText+")";Sl(d)?a.info(b):v(a,b)},Sl=function(a){return 200<=a.status&&299>=a.status},Ul=function(a){a=(new DOMParser).parseFromString(a,"text/xml");return a.getElementsByTagNameNS("http://www.w3.org/1999/xhtml","parsererror").length?null:a};var Vl=function(){this.name="unknown";this.state="error";this.a=null;this.allowStop=!0;this.resource=null;this.extraData={}},Wl=function(){var a=Error.call(this);this.message=a.message;"stack"in a&&(this.stack=a.stack)};Fa(Wl,Error);var Yl=function(a){if(void 0===b){Xl||(Xl=new hd(10,2E3,1));var b=Xl}this.b=a;this.a=b;this.j=kb("mr.dial.Client")};
Yl.prototype.launchApp=function(a,b){var c=this;return this.a.send(Zl(this,a),"POST",b,{timeoutMillis:15E3}).then(function(a){return $l(c,"launchApp","POST",a)})};
var am=function(a,b){return a.a.send(Zl(a,b),"DELETE").then(function(b){return $l(a,"stopApp","DELETE",b)})},bm=function(a,b){return a.a.send(Zl(a,b),"GET",void 0,{tk:3}).then(function(c){Tl(a.j,"GetAppInfo","GET",c);if(!Sl(c)){if(404==c.status)throw new Wl;throw Error("Response error: "+c.status);}c=Ul(c.responseText);if(!c)throw a.j.info("Invalid or empty response"),Error("Invalid or empty response");var d=c.getElementsByTagName("service");if(!d||1!=d.length)throw a.j.info("Invalid GET response (invalid service)"),
Error("Invalid GET response (invalid service)");c=new Vl;for(var e=0,f=d[0].childNodes.length;e<f;e++){var h=d[0].childNodes[e];if("state"==h.nodeName){a:switch(h.textContent){case "running":h="running";break a;case "stopped":h="stopped";break a;default:h="error"}c.state=h}else"name"==h.nodeName?c.name=h.textContent:"link"==h.nodeName?c.resource=h.getAttribute("href"):"options"==h.nodeName?c.allowStop="false"!=h.getAttribute("allowStop"):c.extraData[h.nodeName]=h.innerHTML}if("unknown"==c.name)throw a.j.info("GET response missing name value"),
Error("GET response missing name value");if(c.name!=b)throw a.j.info("GET app name mismatch"),Error("GET app name mismatch");if("error"==c.state)throw a.j.info("GET response missing state value"),Error("GET response missing state value");if((d=/installable=(.+)/.exec(c.state))&&d[1])c.state="installable",c.a=d[1];else if("running"!=c.state&&"stopped"!=c.state)throw a.j.info("GET response has invalid state value"),Error("GET response has invalid state value");return c})},Zl=function(a,b){a=a.b.Lc;
"/"!=a.charAt(a.length-1)&&(a+="/");return a+b},$l=function(a,b,c,d){return new Promise(function(e,f){Tl(a.j,b,c,d);Sl(d)?e():f(Error(d.statusText))})},Xl=null;var cm=function(a,b,c){var d=Error.call(this);this.message=d.message;"stack"in d&&(this.stack=d.stack);this.name="RouteRequestError";this.message=b||"";if(c)this.stack=c;else if(Error.captureStackTrace)Error.captureStackTrace(this,cm);else if(b=Error().stack)this.stack=b;this.errorCode=a};Fa(cm,Error);var dm=(new Map).set("+","-").set("/","_").set("=","."),em=(new Map).set("-","+").set("_","/").set(".","="),fm=function(a){return atob(a.replace(/[-_.]/g,function(a){return em.get(a)}))},gm=function(a){return btoa(String.fromCharCode.apply(String,[].concat(l(a)))).replace(/[+/=]/g,function(a){return dm.get(a)})};var hm=function(){this.a=[];this.l=[];this.h=[];this.f=[];this.f[0]=128;for(var a=1;64>a;++a)this.f[a]=0;this.g=this.b=0;this.reset()};hm.prototype.reset=function(){this.a[0]=1732584193;this.a[1]=4023233417;this.a[2]=2562383102;this.a[3]=271733878;this.a[4]=3285377520;this.g=this.b=0};
var im=function(a,b,c){c=void 0===c?0:c;var d=a.h;if("string"===typeof b)for(var e=0;16>e;e++)d[e]=b.charCodeAt(c)<<24|b.charCodeAt(c+1)<<16|b.charCodeAt(c+2)<<8|b.charCodeAt(c+3),c+=4;else for(e=0;16>e;e++)d[e]=b[c]<<24|b[c+1]<<16|b[c+2]<<8|b[c+3],c+=4;for(b=16;80>b;b++)c=d[b-3]^d[b-8]^d[b-14]^d[b-16],d[b]=(c<<1|c>>>31)&4294967295;b=a.a[0];c=a.a[1];e=a.a[2];for(var f=a.a[3],h=a.a[4],k,m,r=0;80>r;r++)40>r?20>r?(k=f^c&(e^f),m=1518500249):(k=c^e^f,m=1859775393):60>r?(k=c&e|f&(c|e),m=2400959708):(k=
c^e^f,m=3395469782),k=(b<<5|b>>>27)+k+h+m+d[r]&4294967295,h=f,f=e,e=(c<<30|c>>>2)&4294967295,c=b,b=k;a.a[0]=a.a[0]+b&4294967295;a.a[1]=a.a[1]+c&4294967295;a.a[2]=a.a[2]+e&4294967295;a.a[3]=a.a[3]+f&4294967295;a.a[4]=a.a[4]+h&4294967295};
hm.prototype.update=function(a,b){b=void 0===b?a.length:b;for(var c=b-64,d=0,e=this.l,f=this.b;d<b;){if(0==f)for(;d<=c;)im(this,a,d),d+=64;if("string"===typeof a)for(;d<b;){if(e[f]=a.charCodeAt(d),++f,++d,64==f){im(this,e);f=0;break}}else for(;d<b;)if(e[f]=a[d],++f,++d,64==f){im(this,e);f=0;break}}this.b=f;this.g+=b};
hm.prototype.digest=function(){var a=[],b=8*this.g;56>this.b?this.update(this.f,56-this.b):this.update(this.f,64-(this.b-56));for(var c=63;56<=c;c--)this.l[c]=b&255,b/=256;im(this,this.l);for(c=b=0;5>c;c++)for(var d=24;0<=d;d-=8)a[b]=this.a[c]>>d&255,++b;return a};var jm=function(){return Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)};var lm=function(){this.h=jm();this.f=new km(null,null);this.b=new km(null,null);this.l=[];this.g=this.a=0;lh(this)},nm=function(){mm||(mm=new lm);return mm},om=function(a,b){b=b.toLowerCase();var c=new hm;c.update(b);c.update(a.h);return"r"+gm(c.digest())},pm=function(){var a=nm();return a.f.model?a.f:a.b.model?a.b:new km(null,null)};lm.prototype.ua=function(){return"SinkUtils"};
lm.prototype.Pa=function(){return[{recentLaunchedDevice:this.f,recentDiscoveredDevice:this.b},{receiverIdToken:this.h,fixedIpList:this.l.join(","),castControlPort:this.a,lastCloudSinkCheckTimeMillis:this.g}]};
lm.prototype.Ta=function(){var a=ih(this);a&&(this.f=a.recentLaunchedDevice||new km(null,null),this.b=a.recentDiscoveredDevice||new km(null,null));if(a=jh(this))this.h=a.receiverIdToken||jm(),this.l=a.fixedIpList&&a.fixedIpList.split(",")||[],this.a=a.castControlPort||0,this.g=a.lastCloudSinkCheckTimeMillis||0};var mm=null,km=function(a,b){this.model=a;this.ip=b};var qm=function(a,b){this.ic=a;this.appName=b};var rm=function(a){this.a=new Map;this.b=a};rm.prototype.init=function(){lh(this)};rm.prototype.clear=function(){this.a.clear()};rm.prototype.add=function(a){if(!this.a.get(a.ic.id)){this.a.set(a.ic.id,a);var b=this.b;sm(b);b.g.He(b,a.ic)}};var tm=function(a,b){a=la(a.a);for(var c=a.next();!c.done;c=a.next())if(c=la(c.value),c.next(),c=c.next().value,c.ic.sinkId==b)return c;return null},vm=function(a,b){var c=a.a.get(b);c&&(a.a.delete(b),um(a.b,c))},wm=function(a){return Array.from(a.a.values(),function(a){return a.ic})};
rm.prototype.ua=function(){return"dial.ActivityRecords"};rm.prototype.Pa=function(){return[Array.from(this.a)]};rm.prototype.Ta=function(){var a=ih(this);a&&(this.a=new Map(a))};var xm={Rr:0,Ru:1,Nt:2,Qr:3},ym={ERROR:0,fu:1,EMPTY:2},zm=function(a){Eb("MediaRouter.Dial.Create.Route",a,xm)};var Am=function(a){return Promise.all(a.map(function(a){return a.then(function(a){return{Ed:!0,value:a}},function(a){return{Ed:!1,reason:a}})}))};var Bm=function(a,b,c,d,e){this.id=a;this.friendlyName=b;this.iconType=c||"generic";this.description=void 0===d?null:d;this.domain=void 0===e?null:e};var Cm=function(a,b){this.Lb=this.Kc=this.Lc=this.La=this.Kb=null;this.zb=new Bm(om(nm(),b),a);this.Jb={};this.dg={};this.de=!1};Cm.prototype.getId=function(){return this.zb.id};var Dm=function(a,b){a.de=b;return a};
Cm.prototype.update=function(a){if(this.getId()!=a.getId())return!1;var b=!1;this.zb.friendlyName!=a.zb.friendlyName&&(this.zb.friendlyName=a.zb.friendlyName,b=!0);this.Lc!=a.Lc&&(this.Lc=a.Lc,b=!0);this.Kc!=a.Kc&&(this.Kc=a.Kc,b=!0);this.Kb!=a.Kb&&(this.Kb=a.Kb,b=!0);this.La!=a.La&&(this.La=a.La,b=!0);return b};Cm.prototype.ab=function(){return this.Kb};Cm.prototype.Oa=function(){return this.La};
var Em=function(a,b){return a.Jb[b]||"unknown"},Fm=function(a){var b=new Cm(a.zb.friendlyName,"");b.zb.id=a.zb.id;b.Kb=a.Kb;b.La=a.La;b.Lc=a.Lc;b.Kc=a.Kc;b.Lb=a.Lb;b.Jb=a.Jb;b.dg=a.dg;b.de=a.de;return b};var Gm=function(a,b){if(!chrome.runtime.lastError)return null;a=a+" failed, chrome.runtime.lastError: "+(chrome.runtime.lastError.message||"Unknown error");b&&v(b,a);return Error(a)};var Hm=function(){this.a=this.modelName=this.deviceType=this.expireTimeMillis=this.fetchTimeMillis=this.appUrl=this.ipAddress=this.friendlyName=this.deviceLabel=this.uniqueId=null},Im=function(a){if(a.deviceLabel)if(a.uniqueId)if(a.friendlyName)if(a.ipAddress)if(a.appUrl)if(a.fetchTimeMillis)if(a.expireTimeMillis){var b=a.ipAddress;a=Rl(a.appUrl);b="http:"==a.protocol&&a.hostname==b?null:"Invalid appUrl"}else b="Missing expireTimeMillis";else b="Missing fetchTimeMillis";else b="Missing appUrl";else b=
"Missing ipAddress";else b="Missing friendlyName";else b="Missing uniqueId";else b="Missing deviceLabel";return b};Hm.prototype.toString=function(){return JSON.stringify(this,function(a,b){return"string"===typeof b&&b.startsWith("uuid:")?"***":b})};
var Jm=function(a){var b=new Hm;b.uniqueId=a.uniqueId;b.deviceLabel=a.deviceLabel;b.friendlyName=a.friendlyName;b.ipAddress=a.ipAddress;b.appUrl=a.appUrl;b.fetchTimeMillis=a.fetchTimeMillis;b.expireTimeMillis=a.expireTimeMillis;b.deviceType=a.deviceType;b.modelName=a.modelName;b.a=a.configId;return b},Lm=function(){if(void 0===a){Km||(Km=new hd(10,3E3,2));var a=Km}this.a=new Map;this.b=new Map;this.f=new Map;this.g=a;this.j=kb("mr.dial.DeviceDescriptionService");lh(this)};Lm.prototype.ua=function(){return"mr.dial.DeviceDescriptionService"};
Lm.prototype.Pa=function(){return[Array.from(this.a)]};Lm.prototype.Ta=function(){var a=ih(this);if(a){a=la(a);for(var b=a.next();!b.done;b=a.next()){var c=la(b.value);b=c.next().value;c=c.next().value;null!=Im(Jm(c))?this.j.error("Dropping invalid description "+(b+" loaded from storage.")):this.a.set(b,Jm(c))}}};
var Nm=function(a,b){var c;if(c=a.a.get(b.deviceLabel)){if(c.a!=b.configId||Date.now()>=c.expireTimeMillis)v(a.j,"Removing invalid entry "+c.toString()),a.a.delete(b.deviceLabel),c=null}else c=null;return c?(Db("MediaRouter.Dial.Device.Description.Cached"),Promise.resolve(c)):Mm(a,b)},Mm=function(a,b){if(!Om(b.deviceDescriptionUrl))return Promise.reject(Error("Invalid device description URL: "+b.deviceDescriptionUrl));var c=a.b.get(b.deviceLabel);if(c&&c.deviceDescriptionUrl==b.deviceDescriptionUrl)return c.Ga.a;
var d=new Ib;c={deviceDescriptionUrl:b.deviceDescriptionUrl,Ga:d};a.b.set(b.deviceLabel,c);chrome.dial.fetchDeviceDescription(b.deviceLabel,function(c){a.b.delete(b.deviceLabel);c?((c=Pm(a,b,c.deviceDescription,c.appUrl))?(a.j.info("Got device description for "+c.deviceLabel),v(a.j,"... device description was: "+c.toString()),null!=c.a&&(v(a.j,"Caching device description for "+c.deviceLabel),a.a.set(b.deviceLabel,c))):(Eb("MediaRouter.Dial.Device.Description.Failure",1,ym),a.j.info("Invalid device description"),
c=null),c?d.resolve(c):d.reject(Error("Failed to process device description"))):d.reject(Gm("chrome.dial.fetchDeviceDescription"))});return d.a},Pm=function(a,b,c,d){var e=Ul(c);if(!e)return null;var f=new Hm;f.fetchTimeMillis=Date.now();f.expireTimeMillis=f.fetchTimeMillis+18E5;f.deviceLabel=b.deviceLabel;f.a=b.configId;b=Rl(b.deviceDescriptionUrl);f.ipAddress=b.hostname;f.deviceType=Qm(e,"deviceType");f.modelName=Qm(e,"modelName");f.friendlyName=Qm(e,"friendlyName");f.uniqueId=Qm(e,"UDN");!f.friendlyName&&
f.modelName&&(f.friendlyName=f.modelName,f.uniqueId&&(f.friendlyName+="["+f.uniqueId.slice(-4)+"]"),u(a.j,"Fixed device description: created friendlyName from modelName."));f.appUrl=d;d=Im(f);v(a.j,function(){return"Device description: "+Rm(e)});return d?(u(a.j,function(){return"Device description failed to validate: "+f},d),null):f},Qm=function(a,b){return(a=a.getElementsByTagName(b))&&0!=a.length?a[0].textContent:null},Rm=function(a){var b=function(a){for(var b=0,c=a.length;b<c;b++)a[b].textContent=
"***"};b(a.getElementsByTagName("UDN"));b(a.getElementsByTagName("serialNumber"));return(new XMLSerializer).serializeToString(a)},Sm=function(a,b){var c=a.f.get(b);if(c)return c.a;c=new Ib;a.f.set(b,c);a.g.send(b,"GET").then(function(d){a.f.delete(b);Tl(a.j,"checkAccess","GET",d);c.resolve(Sl(d))},function(){a.j.error("Timed out checking access to device description URL.");c.resolve(!1)});return c.a},Om=function(a){a=Rl(a);var b;if(b="http:"==a.protocol)a:{b:if((a=a.hostname.match(Ol))&&5==a.length){b=
[];for(var c=0;4>c;c++)if(b[c]=Number.parseInt(a[c+1],10),0>b[c]||255<b[c]){a=null;break b}a=b}else a=null;if(a)for(a=(a[0]<<24|a[1]<<16|a[2]<<8|a[0])>>>0,b=0;3>b;b++)if((a&Pl[b])>>>0==Ql[b]){b=!0;break a}b=!1}return b},Km=null;var Tm=null,Um=null,Vm=function(){Tm||(Tm=new Mk(3,"dial.DialOnDeviceListEventListener","mr.dial.SinkDiscoveryService",chrome.dial.onDeviceList));Um||(Um=new Mk(4,"dial.DialOnErrorEventListener","mr.dial.SinkDiscoveryService",chrome.dial.onError));return[Tm,Um]};var Wm=function(a,b){b=void 0===b?new Lm:b;this.f=a;this.v=b;this.j=kb("mr.dial.SinkDiscoveryService");this.a=new Map;this.h=this.l=!1;this.b={dd:0,ld:0};this.g=0};Fa(Wm,pg);Wm.prototype.init=function(){lh(this);zg("mr.dial.SinkDiscoveryService",this)};Wm.prototype.start=function(){this.l||(this.j.info("Starting..."),this.l=!0,Vm().forEach(function(a){return a.addListener()}),Xm(this))};Wm.prototype.stop=function(){this.j.info("Stopping...");this.l=!1;Vm().forEach(function(a){return a.removeListener()})};
var Xm=function(a){a.l?chrome.dial.discoverNow(function(b){a.j.info("chrome.dial.discoverNow = "+b)}):a.j.info("Not started. Ignoring discover().")},an=function(a,b){a.j.info("addSinks returned "+b.length+" sinks");v(a.j,function(){return"....the list is: "+JSON.stringify(b)});var c=new Set(a.a.keys());b.forEach(function(b){var d=Ym(b.sink_id);var e=b.extra_data.dial_media_sink;var f=Zm.test(e.model_name),r=e.ip_address.address_bytes?e.ip_address.address_bytes.join("."):e.ip_address.address.join(".");
b=new Cm(b.name,d);b.Kb=r;b.Lc=e.app_url.url;b.Lb=e.model_name;e=Dm(b,!f);$m(a,e);c.delete(e.getId())});var d=[];c.forEach(function(b){var c=a.a.get(b);d.push(c);a.a.delete(b)});0<d.length&&a.f.Md(d);var e=a.a.size;a.b={dd:e,ld:e}};
Wm.prototype.u=function(a){var b=this;this.j.info("onDeviceList returned "+a.length+" devices");v(this.j,function(){return"....the list is: "+JSON.stringify(a)});this.h=!1;var c=0,d=[],e=new Set;a.forEach(function(a){d.push(bn(b,a).then(function(a){e.add(a.getId());$m(b,a)},function(){c++}))});Am(d).then(function(){b.h||cn(b,e).then(function(){var a=b.a.size;dn(b,a,a+c)})})};
var dn=function(a,b,c){a.b={dd:b,ld:c};36E5>Date.now()-a.g||(b=a.b,Fb("MediaRouter.Dial.AvailableDevicesCount",b.dd),Fb("MediaRouter.Dial.KnownDevicesCount",b.ld),a.g=Date.now())},$m=function(a,b){if(!a.h){v(a.j,"mayAddSink, id = "+b.getId());var c=a.a.get(b.getId());c?c.update(b)&&(v(a.j,"Updated sink "+c.getId()),a.f.Ee(c)):(v(a.j,function(){return"Adding new sink "+b.getId()+": "+("name = "+b.zb.friendlyName+(b.Kb?", ip = "+b.Kb:"")+(b.Lb?", model = "+b.Lb:"")+", apps = "+JSON.stringify(b.Jb))}),
a.a.set(b.getId(),b),a.f.xf(b))}},cn=function(a,b){var c=[],d=[];a.a.forEach(function(e){b.has(e.getId())||d.push((e.Kc?Sm(a.v,e.Kc):Promise.resolve(!1)).then(function(b){b||(a.a.delete(e.getId()),c.push(e))}))});return Am(d).then(function(){0<c.length&&a.f.Md(c)})},bn=function(a,b){return Nm(a.v,b).then(function(a){var c=a.uniqueId?Ym(a.uniqueId):"",e=a.uniqueId?om(nm(),c):b.deviceLabel,f=Zm.test(a.modelName);c=new Cm(a.friendlyName,c);c.zb.id=e;c.Kb=a.ipAddress;c.Lc=a.appUrl;c.Kc=b.deviceDescriptionUrl;
c.Lb=a.modelName;return Dm(c,!f)})},Ym=function(a){0==a.indexOf("uuid:")&&(a=a.substr(5));return a.replace(/-/g,"").toLowerCase()};
Wm.prototype.m=function(a){switch(a.code){case "no_valid_network_interfaces":case "network_disconnected":u(this.j,"DIAL error: "+a.code+". Clear device list now.");a=Array.from(this.a.values());this.a.clear();this.f.Md(a);dn(this,0,0);this.h=!0;break;case "no_listeners":case "socket_error":case "cellular_network":case "unknown":u(this.j,"DIAL error: "+a.code+". Keep device list.");break;default:u(this.j,"Unhandled DIAL error: "+a.code)}};
var en=function(a,b){return a.a.get(b)||null},hn=function(a,b){var c=[];a.a.forEach(function(a){"available"==Em(a,b)&&c.push(a.zb)});return new Kl(c,gn[b])};g=Wm.prototype;g.Mj=function(){return this.b};g.handleEvent=function(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];if(a==chrome.dial.onDeviceList)this.u.apply(this,[].concat(l(c)));else if(a==chrome.dial.onError)this.m.apply(this,[].concat(l(c)));else throw Error("Unhandled event");};g.ua=function(){return"dial.DialSinkDiscoveryService"};
g.Pa=function(){return[new jn(Array.from(this.a),this.b),{deviceCountMetricsRecordTime:this.g}]};g.Ta=function(){var a=ih(this);if(a){for(var b=la(a.sinks),c=b.next();!c.done;c=b.next())c=c.value,this.a.set(c[0],Fm(c[1]));this.b=a.deviceCounts}if(a=jh(this))this.g=a.deviceCountMetricsRecordTime};
var gn={YouTube:"https://tv.youtube.com https://tv-green-qa.youtube.com https://tv-release-qa.youtube.com https://web-green-qa.youtube.com https://web-release-qa.youtube.com https://www.youtube.com".split(" "),Netflix:["https://www.netflix.com"],Pandora:["https://www.pandora.com"],Radio:["https://www.pandora.com"],Hulu:["https://www.hulu.com"],Vimeo:["https://www.vimeo.com"],Dailymotion:["https://www.dailymotion.com"],"com.dailymotion":["https://www.dailymotion.com"]},Zm=/Eureka Dongle|Chromecast Audio/i,
jn=function(a,b){this.sinks=a;this.deviceCounts=b};var kn=function(a,b){this.j=kb("mr.dial.AppDiscoveryService");this.a=new Set;this.b=a;this.h=b;this.l=new Map;this.v=new Map;this.f=null;this.g=!1};kn.prototype.init=function(){lh(this)};kn.prototype.start=function(){this.j.info("Starting periodic scanning.");this.g||(this.g=!0,ln(this))};kn.prototype.stop=function(){this.j.info("Stopping periodic scanning.");this.g&&(this.g=!1,this.f&&(clearTimeout(this.f),this.f=null),this.l.clear())};
var ln=function(a){a.j.info("Start app status scan.");var b=[];Array.from(a.b.a.values()).forEach(function(c){b.push.apply(b,mn(a,c))});Array.from(a.h.a.values()).forEach(function(c){b.push(nn(a,c))});Am(b).then(function(){a.g&&!a.f&&(v(a.j,"Scan complete; scheduling for next scan."),a.f=setTimeout(function(){v(a.j,"Start app status scan (timer-based)");a.f=null;ln(a)},6E4))})},mn=function(a,b){if(!b.de)return[];for(var c=[],d=la(a.a),e=d.next();!e.done;e=d.next())c.push(a.u(e.value,b));return c};
kn.prototype.u=function(a,b){var c=this;if("unknown"!=Em(b,a)&&36E5>Date.now()-(b.dg[a]||0)||!b.de)return Promise.resolve();v(this.j,"Querying "+b.getId()+" for "+a+" to update app status");return on(this,b,a).then(function(d){a:if("Netflix"==d.name)d=!d.extraData||"websocket"!=d.extraData.capabilities||"running"!=d.state&&"stopped"!=d.state?"unavailable":"available";else switch(d.state){case "running":case "stopped":d="available";break a;default:d="unavailable"}pn(c,b,a,d)},function(d){d instanceof
Wl?pn(c,b,a,"unavailable"):(u(c.j,"Failed to process app availability; "+b.getId()+" does not support app availability"),Dm(b,!1))})};
var nn=function(a,b){var c=en(a.b,b.ic.sinkId);if(!c)return u(a.j,"Activity refers to nonexistent sink: "+b.ic.id),Promise.resolve();if(!c.de)return Promise.resolve();var d=b.appName;v(a.j,"Querying "+c.getId()+" for "+d+" to update activity");return on(a,c,d).then(function(b){"running"!=b.state&&qn(a,c,d)},function(){return qn(a,c,d)})},rn=function(a,b){var c=a.v.get(b.getId());c||(c=new Yl(b),v(a.j,"Created DIAL client for "+b.getId()),a.v.set(b.getId(),c));return c},on=function(a,b,c){var d=sn(b,
c),e=a.l.get(d);if(e)return e;e=bm(rn(a,b),c);a.l.set(d,e);b=function(){a.l.delete(d)};e.then(b,b);return e},sn=function(a,b){return a.getId()+":"+b},pn=function(a,b,c,d){v(a.j,"Got app status "+d+" from "+b.getId()+" for "+c);var e=Em(b,c);b.Jb[c]=d;b.dg[c]=Date.now();d!=e&&a.b.f.Ee(b)},qn=function(a,b,c){(b=tm(a.h,b.getId()))&&b.appName==c&&vm(a.h,b.ic.id)},tn=function(a,b){return Array.from(a.b.a.values()).some(function(a){return"unknown"==Em(a,b)})};kn.prototype.ua=function(){return"dial.AppDiscoveryService"};
kn.prototype.Pa=function(){return[Array.from(this.a)]};kn.prototype.Ta=function(){var a=ih(this);this.a=new Set(a||[])};var un=function(a,b){this.appName=a;this.launchParameter=void 0===b?"":b},xn=function(a){try{var b=new URL(a)}catch(c){return vn.info("Invalid URL: "+a),null}switch(b.protocol){case "dial:":a:if(a=b.pathname,a.match(/^\w+$/)){if(b=b.searchParams.get("postData")||void 0)try{b=fm(b)}catch(c){u(vn,"Invalid base64 encoded postData:"+b);a=null;break a}a=new un(a,b)}else u(vn,"Invalid app name: "+a),a=null;return a;case "https:":return wn(b);default:return v(vn,"Unhandled protocol: "+b.protocol),null}},
wn=function(a){var b=a.hash;if(!b)return null;a=(a=yn.exec(b))?a[1]:null;if(!a)return null;a=decodeURIComponent(a);if(b=(b=zn.exec(b))?b[1]:void 0)try{b=fm(b)}catch(c){return u(vn,"Invalid base64 encoded postData:"+b),null}return new un(a,b)},vn=kb("mr.dial.PresentationUrl"),yn=/__dialAppName__=([A-Za-z0-9-._~!$&'()*+,;=%]+)/,zn=/__dialPostData__=([A-Za-z0-9]+={0,2})/;var An=function(a,b){this.g=a;this.a=b||new Wm(this);this.b=new rm(this);this.f=new kn(this.a,this.b);this.j=kb("mr.DialProvider")};g=An.prototype;g.getName=function(){return"dial"};g.Ya=function(a){a=a?a.enable_dial_discovery:!0;this.j.info("Dial Discovery enabled: "+a+"...");this.b.init();this.a.init();this.f.init();a?(this.a.start(),sm(this)):this.a.stop()};g.kf=function(a){v(this.j,"GetAvailableSinks for "+a);return(a=xn(a))?hn(this.a,a.appName):Ll};
g.startObservingMediaSinks=function(a){var b=xn(a);if(b){a=this.f;b=b.appName;if(!a.a.has(b)||tn(a,b))a.a.add(b),0!=a.b.a.size&&(a.g?Array.from(a.b.a.values()).forEach(a.u.bind(a,b)):a.start());sm(this)}};g.stopObservingMediaSinks=function(a){if(a=xn(a))this.f.a.delete(a.appName),Bn(this)};g.startObservingMediaRoutes=function(){sm(this)};g.stopObservingMediaRoutes=function(){Bn(this)};
var Bn=function(a){(0==a.a.a.size||0==a.f.a.size&&0==a.b.a.size)&&a.f.stop()},sm=function(a){0<a.a.a.size&&(0<a.f.a.size||0<a.b.a.size)&&a.f.start()};g=An.prototype;g.wf=function(a){return(a=en(this.a,a))?a.zb:null};g.Ld=function(){return wm(this.b)};
g.createRoute=function(a,b,c,d){var e=this,f=en(this.a,b);if(!f)return zm(0),Kf(Error("Unkown sink: "+b));nm().f=new km(f.Lb,f.ab());var h=xn(a);if(!h)return Kf(Error("No app name set."));var k=h.appName,m=new Yl(f);return Lf(bm(m,k).then(function(a){if("running"==a.state)return am(m,k)}).then(function(){return m.launchApp(k,h.launchParameter)}).then(function(){return Cn(e,b,a,k,c,d)}).catch(function(a){zm(3);throw a;}))};g.joinRoute=function(){return Kf(Error("Not supported"))};
g.connectRouteByRouteId=function(){return Kf(Error("Not supported"))};g.detachRoute=function(){};var Cn=function(a,b,c,d,e,f){zm(1);b=Jk(e,a.getName(),b,c,!0,d);b.offTheRecord=f;a.b.add(new qm(b,d));return b};An.prototype.xf=function(a){this.g.onSinkAvailabilityUpdated(this,1);sm(this);mn(this.f,a);this.g.Bc();nm().b=new km(a.Lb,a.ab())};
An.prototype.Md=function(a){var b=this;if(0==this.a.a.size)this.g.onSinkAvailabilityUpdated(this,0);Bn(this);a.forEach(function(a){var c=b.b;a=a.getId();if(a=tm(c,a))c.a.delete(a.ic.id),um(c.b,a)});this.g.Bc()};An.prototype.Ee=function(){this.g.Bc()};var um=function(a,b){b=b.ic;if(b.isLocal)a.g.onPresentationConnectionStateChanged(b.id,"terminated");Bn(a);a.g.yf(b)};g=An.prototype;
g.terminateRoute=function(a){var b=this.b.a.get(a)||null;if(!b)return Promise.reject(new cm(3,"Route in DIAL provider not found for routeId "+a));vm(this.b,a);return(a=en(this.a,b.ic.sinkId))?am(new Yl(a),b.appName):Promise.reject(new cm(3,"Sink in DIAL provider not found for sinkId "+b.ic.sinkId))};g.se=function(){throw Error("Not implemented.");};g.Gd=function(){return null};g.sendRouteMessage=function(){return Promise.reject(Error("DIAL sending messages is not supported"))};
g.sendRouteBinaryMessage=function(){return Promise.reject(Error("DIAL sending messages is not supported"))};g.cf=function(a,b){b=en(this.a,b);return!b||jg(a)?!1:(a=xn(a))?"available"==Em(b,a.appName):!1};g.fe=function(){return!1};g.searchSinks=function(){return hb()};g.createMediaRouteController=function(){return hb()};g.provideSinks=function(a){an(this.a,a)};var Dn=function(a){return"available"==a||"available_rescan"==a};var Fn=function(a,b,c,d,e,f){a=om(nm(),a);this.a=new Bm(a,b,En(d));this.Lb=c||null;this.Mb=d||null;this.Kb=e||null;this.La=f||null;this.Jb={};this.gd=!1},Gn=function(a){if(!a.Lb||!a.ab())return null;var b=new Fn(a.zb.id,a.zb.friendlyName,a.Lb,void 0,a.ab(),nm().a||8009);b.a.id=a.zb.id;b.gd=!0;return b},Hn=function(a,b){if(b=a.update(b.a.friendlyName,b.ab(),b.Oa(),b.Mb))a.gd=!1;return b};
Fn.prototype.update=function(a,b,c,d){var e=!1;this.a.friendlyName!=a&&(this.a.friendlyName=a,e=!0);null!=b&&this.Kb!=b&&(this.Kb=b,e=!0);null!=c&&this.La!=c&&(this.La=c,e=!0);null!=d&&this.Mb!=d&&(this.Mb=d,e=!0);return e};var En=function(a){return a&1?"cast":a&32?"cast_audio_group":"cast_audio"};Fn.prototype.getId=function(){return this.a.id};
var In=function(a){var b=new Fn("",a.friendlyName,a.modelName,a.capabilities,a.ip,a.port);b.a.id=a.id;b.gd=a.discoveredByDial;b.Jb=a.appStatusMap;for(var c in b.Jb)"unavailable"==b.Jb[c]&&(b.Jb[c]="unavailable_rescan");return b};Fn.prototype.ab=function(){return this.Kb};Fn.prototype.Oa=function(){return this.La};var Jn=function(a,b){return a.Jb[b]||"unknown"};var Kn={Zs:0,Ps:1},Ln={Hv:0,om:1,Bu:2},Mn={DIAL:0,et:1,ft:2,Hr:3},Nn={Pt:0,TIMEOUT:1,FAILED:2},On={kj:0,Lq:1,wr:2,gs:3,kr:4,zt:5,yr:6,mu:7},Pn={Jl:0,SUCCESS:1},Qn=function(a){Eb("MediaRouter.Cast.Session.Ended",a,Ln)},Rn=function(a){Eb("MediaRouter.Cast.Channel.ConnectResult",a,Pn)},Sn=function(a){Eb("MediaRouter.Cast.Discovery.Type",a,Mn)},Tn=function(a){Eb("MediaRouter.Cast.Session.Fail",a,Nn)};var Un=function(a,b){this.f=a;this.b=b;this.a=this.f.a;this.j=kb("mr.cast.CastDialSinkDiscoveryCallbacks");this.g=!0},Vn=function(a,b){var c=a.a.b(b.getId());if(c)return c;(b=b.ab())?(a=a.a,c=nm().a||8009,a=a.u.get(b+":"+c)):a=null;return a};Un.prototype.xf=function(a){Vn(this,a)?Sn(2):Wn(this,a);this.b.xf(a)};var Wn=function(a,b){if(a.f.I||a.g){var c=Gn(b);c&&Xn(a.a,c).then(function(d){d?Vn(a,b)?Sn(2):(Yn(a.a,c),Sn(0)):Db("MediaRouter.Dial.Sink.Discovered.NonCast")},Oa)}};
Un.prototype.Md=function(a){var b=this;w(a,function(a){var c=b.a.b(a.getId());c&&c.gd&&Zn(b.a,a.getId())});this.b.Md(a)};Un.prototype.Ee=function(a){var b=this.a.b(a.getId());b?b.gd&&(b.update(a.zb.friendlyName,a.ab(),b.Oa(),b.Mb)&&this.j.info("Updated Cast sink with DIAL sink: "+a.getId()),$n(this.a.f,b)):Wn(this,a);this.b.Ee(a)};var ao=function(a,b){this.u=new Un(b,this);this.v=new Wm(this.u);this.f=new nj;this.b=a;this.h=this.l=0;this.g=new Hl;this.a=new An(this,this.v)};g=ao.prototype;g.ua=function(){return"cast.DialProviderWrapper"};g.Pa=function(){return[new bo(rj(this.f),this.l,this.h,this.g.X())]};g.Ta=function(){var a=ih(this);a&&(mj(this.f,a.b),this.l=a.sequenceNumber,this.h=a.f,Gl(this.g,a.a))};g.getName=function(){return this.a.getName()};
g.Ya=function(a){this.a.Ya(a);lh(this);this.u.g=a?a.enable_dial_discovery:!0};g.Ld=function(){return this.a.Ld()};g.ai=function(){};g.kf=function(a){return(a=co(a))?this.a.kf(a):Ll};g.startObservingMediaSinks=function(a){(a=co(a))&&this.a.startObservingMediaSinks(a)};g.stopObservingMediaSinks=function(a){(a=co(a))&&this.a.stopObservingMediaSinks(a)};g.startObservingMediaRoutes=function(a){(a=co(a))&&this.a.startObservingMediaRoutes(a)};g.stopObservingMediaRoutes=function(a){(a=co(a))&&this.a.stopObservingMediaRoutes(a)};
g.wf=function(a){return this.a.wf(a)};
var go=function(a,b,c,d,e){var f=co(b);if(!f)return Promise.reject(Error("Invalid source"));var h=xn(f),k=en(a.v,c);if(!k)return Promise.reject(Error("Attempting custom launch with closed route"));var m=h.appName;if(!m)return Promise.reject(Error("No app name given"));var r=eo(b);return r?bm(new Yl(k),m).then(function(b){var y=Cn(a.a,c,f,m,e,d);b={routeId:y.id,sinkId:k.getId(),appName:m,rj:b,launchParameter:h.launchParameter,session:null,clientId:null};a.f.set(y.id,b);var C=fo(a,b.sinkId),Q=new bl("receiver_action",
{receiver:C,action:chrome.cast.bf.CAST});Q.clientId=r;a.b.nd(b.routeId,Q);Q=chrome.cast.M;var qa=String(a.h);a.h=(a.h+1)%9007199254740992;C=new Q(qa,"",b.appName,[],C);b.session=C;b.clientId=r;C=new bl("new_session",C);C.clientId=r;a.b.nd(b.routeId,C);return y}):Promise.reject(Error("No client ID"))};ao.prototype.createRoute=function(a,b,c,d,e,f,h){return a.startsWith("cast-dial:")||ho.test(a)?Lf(go(this,a,b,d,c)):this.a.createRoute(a,b,c,d,e,f,h)};
ao.prototype.terminateRoute=function(a){var b=this.f.get(a);if(b&&b.session&&b.clientId){var c={receiver:fo(this,b.sinkId),action:chrome.cast.bf.STOP};c=new bl("receiver_action",c);c.clientId=b.clientId;this.b.nd(b.routeId,c);this.b.onPresentationConnectionStateChanged(b.routeId,"terminated")}return this.a.terminateRoute(a)};
ao.prototype.sendRouteMessage=function(a,b,c){var d=JSON.parse(b);switch(d.type){case "client_connect":return b=d.clientId,(a=this.f.get(a))?(c=fo(this,a.sinkId),c.receiverType=chrome.cast.cg.DIAL,c=new bl("custom_dial_launch",new chrome.cast.Oi(c,a.rj.state,a.rj.extraData)),c.clientId=b,b=this.l,this.l=(this.l+1)%9007199254740992,c.sequenceNumber=b,this.g.add(c.sequenceNumber),this.b.nd(a.routeId,c),a=Promise.resolve()):a=Promise.reject(Error("Unknown route")),a;case "custom_dial_launch":if(this.g.contains(d.sequenceNumber))return this.g.remove(d.sequenceNumber),
b=d.message,(a=this.f.get(a))?b&&!b.doLaunch?a=Promise.resolve():(c=en(this.v,a.sinkId))?(c=new Yl(c),d=a.launchParameter,d=(b?b.launchParameter:null)||d,a=c.launchApp(a.appName,d)):a=Promise.reject(Error("Custom launch response for sink that no longer exists")):a=Promise.reject(Error("Unknown route")),a;break;case "v2_message":if("STOP"==d.message.type)return this.terminateRoute(a),Promise.resolve()}return this.a.sendRouteMessage(a,b,c)};
ao.prototype.sendRouteBinaryMessage=function(a){return Promise.reject(Error("Route "+a+" does not support sending binary data."))};var fo=function(a,b){a=en(a.v,b);b=new chrome.cast.bh(b,a.zb.friendlyName);b.ipAddress=a.ab();b.receiverType=chrome.cast.cg.DIAL;return b};g=ao.prototype;g.se=function(a){return this.a.se(a)};g.Gd=function(a){return this.a.Gd(a)};g.cf=function(a,b){return a.startsWith("cast-dial:")||ho.test(a)||this.a.cf(a,b)};g.fe=function(a,b,c){return this.a.fe(a,b,c)};
g.connectRouteByRouteId=function(a,b,c,d,e){return this.a.connectRouteByRouteId(a,b,c,d,e)};g.joinRoute=function(a,b,c,d,e,f){return this.a.joinRoute(a,b,c,d,e,f)};g.detachRoute=function(a){this.f.remove(a);this.a.detachRoute(a)};g.Bc=function(){this.b.Bc()};g.onSinkAvailabilityUpdated=function(a,b){this.b.onSinkAvailabilityUpdated(a,b)};g.He=function(a,b){this.b.He(this,b)};g.yf=function(a){this.b.yf(a)};g.od=function(a){this.b.od(a)};g.nd=function(a,b){this.b.nd(a,b)};
g.onPresentationConnectionStateChanged=function(a,b){this.b.onPresentationConnectionStateChanged(a,b)};g.onPresentationConnectionClosed=function(a,b,c){this.b.onPresentationConnectionClosed(a,b,c)};g.zh=function(a){return this.b.zh(a)};g.Bh=function(){return this.b.Bh()};g.Nd=function(a){this.b.Nd(a)};g.Jg=function(a,b){this.b.Jg(a,b)};g.bi=function(a){this.b.bi(a)};g.xf=function(a){this.a.xf(a)};g.Md=function(a){this.a.Md(a)};g.Ee=function(a){this.a.Ee(a)};g.Th=function(){};g.ik=function(){};
g.searchSinks=function(a,b){return this.a.searchSinks(a,b)};g.provideSinks=function(a){this.a.provideSinks(a)};g.createMediaRouteController=function(){return hb()};g.ri=function(a){this.b.ri(a)};g.Nh=function(){return this.b.Nh()};g.Ke=function(a,b){return this.b.Ke(a,b)};
var co=function(a){try{var b=new URL(a)}catch(e){return null}if("dial:"==b.protocol)return a;if("cast-dial:"==b.protocol){var c=b;a="cast-dial:"!=c.protocol?null:new $k(c.pathname,c.searchParams.get("dialPostData"),c.searchParams.get("clientId"));c=a.hk;var d=a.Sh}else if("https:"==b.protocol){a=El(a);if(!a)return null;c=a.m;d=a.s}c?(a=d||"",c=new URL("dial:"+c),a&&c.searchParams.set("postData",a),c=c.toString()):c=null;return c},eo=function(a){try{var b=new URL(a)}catch(c){return null}return"cast-dial:"==
b.protocol?b.searchParams.get("clientId"):"https:"==b.protocol?Fl(a):null},bo=function(a,b,c,d){this.b=a;this.sequenceNumber=b;this.f=c;this.a=d},ho=/__dialAppName__/;var io=function(a,b){this.type=a;this.entryPoint=b};q("castApp.frontEnd.ExtensionMessage",io);var jo=function(a){return"urn:x-cast:com.google.cast."+a},ko=jo("tp.connection"),lo=jo("receiver"),mo=jo("remoting"),no=jo("media"),oo=jo("webrtc"),po=jo("broadcast"),qo=ed({sv:ko,tv:jo("tp.heartbeat"),Au:lo,Eu:mo,ht:no,kt:jo("media.universalRemote.optIn"),Mv:oo,Uq:po});var ro=function(a,b){this.f=b;this.w=a;this.w.v=this.b.bind(this);this.a=new nj;this.u=new nj;this.g=new nj;this.oa=null;this.s=this.B="";this.l=null;this.R=this.m=!1;this.F=[];this.j=kb("mr.cast.SinkDiscoveryService");this.A=new Set;this.h={dd:0,ld:0};this.v=this.I=0};Fa(ro,pg);ro.prototype.init=function(){lh(this);this.m&&(so(this),to(this));zg("mr.cast.SinkDiscoveryService",this)};var so=function(a){a.j.info("Start listening to network changes");Rk().addListener()};
ro.prototype.start=function(){var a=Date.now(),b=Pk();if(b.a){if(6E4>a-this.oa)return;this.j.info("Forcing mdns discovery");chrome.mdns.forceDiscovery(Oa);b=Pk();b.removeListener()}else this.j.info("Adding mdns listener");b.addListener();this.oa=a};ro.prototype.stop=function(){this.j.info("Stopping...");Pk().removeListener()};
ro.prototype.handleEvent=function(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];if(a==chrome.mdns.onServiceList)this.J.apply(this,[].concat(l(c)));else if(a==chrome.networkingPrivate.onNetworksChanged||a==chrome.networkingPrivate.onNetworkListChanged)to(this);else throw Error("Unhandled event");};
var uo=function(a,b){if(-1==b.serviceName.indexOf("._googlecast."))return null;var c={};b.serviceData.forEach(function(a){0==a.search(/[a-z]{2}=.+/)&&(c[a.substring(0,2)]=a.substring(3))});var d=c.id;if(!d)return u(a.j,"Missing ID"),null;var e=Number(b.serviceHostPort.substring(b.serviceHostPort.lastIndexOf(":")+1));if(isNaN(e)||0>e||65535<e)return u(a.j,"Missing or invalid port"),null;var f=c.fn;if(!f||!b.ipAddress)return u(a.j,"Missing friendly name or IP address"),null;a=Number(c.ca);return new Fn(d,
f,c.md||"",isNaN(a)?0:a,b.ipAddress,e)},Ao=function(a,b){a.j.info("addSinks returned "+b.length+" sinks");v(a.j,function(){return"....the list is: "+JSON.stringify(b)});var c=new Set(a.a.mb());b.forEach(function(b){var d=b.sink_id;var f=b.extra_data.cast_media_sink,h=f.ip_endpoint?f.ip_endpoint.address:f.ip_address,k=f.ip_endpoint?f.ip_endpoint.port:nm().a||8009;d=new Fn(d,b.name,f.model_name,f.capabilities,h.address_bytes.join("."),k);f=a.a.get(d.getId());h=a.w;b=b.extra_data.cast_media_sink.cast_channel_id;
k=d.getId();var m=h.b.get(k);if(!m||m.channelId!=b){vo.info("Added cast channel "+b+" to receiver: "+k);m&&h.a.remove(m.channelId);m={auth:"ssl_verified",ipAddress:d.ab(),port:d.Oa()};m={channelId:b,readyState:"open",keepAlive:!0,audioOnly:!(d.Mb&1),connectInfo:m};h.b.set(k,m);h.a.set(b,k);var r=h.g.get(k);r&&r.channelId!=b&&(vo.info("Re-connected to receiver: "+d.getId()),wo(h.f,r,m),xo(h.l.g,d,!0));h.g.set(k,m)}f?Hn(f,d)&&$n(a.f,f):Yn(a,d);c.delete(d.getId())});c.forEach(function(b){var c=a.w,d=
c.g.get(b);d&&(yo(c.f,d),c.g.remove(b));Zn(a,b)});a.h={dd:a.a.na(),ld:zo(a)}};ro.prototype.J=function(a){var b=this;this.j.info("Registering "+a.length+" devices");0!=this.v&&(clearTimeout(this.v),this.v=0);a=Bo(this,a).map(function(a){return Co(b,a,!0)});Am(a).then(function(){b.h={dd:b.a.na(),ld:zo(b)};Do(b)})};
var Do=function(a){0!=a.v||36E5>Date.now()-a.I||(a.v=setTimeout(function(){var b=a.h;Fb("MediaRouter.Cast.Discovery.KnownDevicesCount",b.ld);Fb("MediaRouter.Cast.Discovery.ConnectedDevicesCount",b.dd);a.I=Date.now();a.v=0},5E3))};ro.prototype.Mj=function(){return this.h};
var zo=function(a){var b=a.A.size;Yi(a.a.ob(!1),function(c){a.A.has(c.getId())||b++});return b},Co=function(a,b,c){if(a.g.pb(b.getId()))return Promise.resolve();a.g.set(b.getId(),b);return Xn(a,b).then(function(d){d?(d=a.a.get(b.getId()),c&&(d?d.gd&&Sn(3):Sn(1)),Yn(a,b)):(a.j.info("Inaccessible sink: "+b.getId()),Zn(a,b.getId()));a.g.remove(b.getId())})},Eo=function(a,b){return void 0!=a.F.find(function(a){return a.ipAddress==b.ipAddress})},Bo=function(a,b){var c=[];a.A.clear();b.forEach(function(b){if(!Eo(a,
b)&&(b=uo(a,b))){var d=b.getId();a.A.add(d);if(a.g.pb(d)){var f=a.g.get(d);if(f.ab()==b.ab()&&f.Oa()==b.Oa()){a.j.info("Sink has pending connection "+d);return}u(a.j,"Pending sink changed ip "+d);a.g.remove(d)}(d=a.a.get(d))?Hn(d,b)&&$n(a.f,d):c.push(b)}});return c},Fo=function(a,b){var c=a.a.get(b.getId()),d=null,e=b.ab(),f=b.Oa();null!=e&&null!=f&&(d=a.u.get(e+":"+f));if(c&&!d){var h=b.ab(),k=b.Oa();h&&k&&a.u.remove(h+":"+k)}d&&!c&&a.a.remove(d.getId());a.a.set(b.getId(),b);null!=e&&null!=f&&a.u.set(e+
":"+f,b)},Yn=function(a,b){a.j.info("Adding sink "+b.getId());Fo(a,b);a.m||(a.m=!0,so(a));a=a.f;a.b.onSinkAvailabilityUpdated(a,1);$n(a,b);xo(a.g,b);nm().b=new km(b.Lb,b.ab())},Zn=function(a,b){var c=a.a.get(b);if(c){a.j.info("Removing sink "+b);a.a.remove(b);b=c.ab();var d=c.Oa();null!=b&&null!=d&&a.u.remove(b+":"+d);a.f.B(c)}},Go=function(a){var b=a.a.X();a.a.clear();a.u.clear();b.forEach(a.f.B,a.f)},Xn=function(a,b){v(a.j,"Checking access to "+b.getId());return Ho(a.w,b).then(function(a){if(b.gd){var c=
4;a.audioOnly||(c|=1);b.Mb=c;b.a.iconType=En(b.Mb)}return!0},function(){return!1})},Io=function(a){a.j.info("Pruning inactive sinks.");Yi(a.a.ob(!1),function(b){a.g.set(b.getId(),b);Xn(a,b).then(function(c){c||Zn(a,b.getId());a.g.remove(b.getId())})})};ro.prototype.b=function(a){return this.a.get(a,null)};var Jo=function(a,b){var c=[];Yi(a.a.ob(!1),function(a){Dn(Jn(a,b))&&c.push(a)});return c};ro.prototype.ua=function(){return"cast.SinkDiscoveryService"};
ro.prototype.Pa=function(){var a=this,b={};Yi(this.a.ob(!0),function(c){var d=a.a.get(c);d={id:d.getId(),ip:d.ab(),port:d.Oa(),friendlyName:d.a.friendlyName,modelName:d.Lb,capabilities:d.Mb,discoveredByDial:d.gd,appStatusMap:d.Jb};b[c]=d});return[new Ko(b,this.s,this.h),new Lo(this.m,this.I)]};
ro.prototype.Ta=function(){var a=ih(this);if(a&&3==a.version){this.s=a.networkIds;this.h=a.deviceCounts;a=a.sinkMap;this.R=0<Object.keys(a).length;for(var b in a){var c=In(a[b]);this.b(c.getId())||Fo(this,c)}Io(this)}if(b=jh(this))this.m=b.hasSavedSinks,this.I=b.lastSinkCountMetricRecordTime||0};
var Mo=function(a,b){a.R=0<Object.keys(b).length;for(var c in b){var d=In(b[c]);a.b(d.getId())||Co(a,d,!1)}},to=function(a){a.j.info("Fetching networks state");a.l&&th(a.l);chrome.networkingPrivate.getNetworks({networkType:"All",visible:!0,configured:!0},function(b){for(var c=[],d=0;d<b.length;d++)"Connected"==b[d].ConnectionState&&c.push(b[d].GUID);No(a,c.sort().join(","))})},No=function(a,b){a.j.info(function(){return"Update current network "+Oo(b)});b!=a.B&&(a.l&&(kh.delete(a.l.ua()),a.l=null),
b?(a.s&&b!=a.s?Go(a):Io(a),a.B=b,a.s=b,a.l=new Po(a,a.B)):a.B="")},Oo=function(a){for(var b=0,c=0;c<a.length;c++)b+=a.charCodeAt(c);return b},Ko=function(a,b,c){this.sinkMap=a;this.networkIds=b;this.deviceCounts=c;this.version=3},Lo=function(a,b){this.hasSavedSinks=a;this.lastSinkCountMetricRecordTime=b},Po=function(a,b){this.a=a;this.b=b;lh(this)};Po.prototype.ua=function(){return"cast.NetworkSink."+this.b};
Po.prototype.Pa=function(){var a=this,b=null,c=this.a.Pa();c&&(this.a.R||0<this.a.a.na())&&(b=c[0]);this.a.j.info(function(){return"Saving sink data for network "+Oo(a.b)});return[null,b]};Po.prototype.Ta=function(){var a=this;this.a.j.info(function(){return"Restoring sink data for network "+Oo(a.b)});var b=jh(this);b&&3==b.version&&Mo(this.a,b.sinkMap)};var Qo=function(){this.type="GET_STATUS";this.requestId=0};var Ro=function(a,b,c){this.type="APPLICATION_BROADCAST";this.requestId=0;this.appIds=a;this.namespace=b;this.message=c};var So=function(a){this.type="LAUNCH";this.requestId=0;this.appId=a;this.language=null};var To=function(a,b){this.requestId=a;this.b=b;this.ml=null};To.prototype.a=function(){};var Uo=function(){this.a=new nj},Vo=function(a,b){a.a.set(b.requestId,b);b.ml=setTimeout(function(){a.a.remove(b.requestId);b.a()},b.b)},Wo=function(a,b){var c=a.a.get(b);if(!c)return null;clearTimeout(c.ml);a.a.remove(b);return c};var Xo=function(a,b){this.b=a;this.f=b;this.a=new Uo;this.g=new Kk("cast.RequestIdGenerator")};Xo.prototype.init=function(){lh(this.g)};var Zo=function(a,b,c,d){var e=Lk(a.g);b.requestId=e;b=new Ib;c=new Yo(e,b,n(c)&&0<c?c:6E5,d);Vo(a.a,c);return c};
Xo.prototype.sendRequest=function(a,b,c,d,e,f){var h=this;if(!qo.hasOwnProperty(c))return Promise.reject(Error("Custom namespace is not supported"));var k=Zo(this,a,Ja(d)?d:3E3,e),m=k.Ga;$o(this.b,b,c,a,e||this.f,f).then(null,function(){Wo(h.a,k.requestId);m.reject(ap)});return m.a};
Xo.prototype.sendMessage=function(a,b,c,d,e,f){var h=this,k=Zo(this,a,Ja(d)?d:3E3,e),m=k.Ga;$o(this.b,b,c,a,e||this.f,f).then(function(){Wo(h.a,k.requestId);m.resolve(!0)},function(){Wo(h.a,k.requestId);m.reject(ap)});return m.a};
var bp=function(a,b,c){var d=new So(b.appId);d.language=b.language?b.language:chrome.i18n.getUILanguage?chrome.i18n.getUILanguage():chrome.runtime.getManifest().default_locale;return a.sendRequest(d,c,lo,b.requestSessionTimeout)},cp=Error("Timeout"),ap=Error("Failed to send message"),Yo=function(a,b,c,d){To.call(this,a,c);this.Ga=b;this.sourceId=d};Fa(Yo,To);Yo.prototype.a=function(){this.Ga.reject(cp)};var dp=function(a,b){this.type="cast_app";this.originId=window["castApp.eventPage.Message.OriginID"]||void 0;this.subtype=a;this.devices=b;this.logRecord=this.deviceJustSetUp=void 0};q("castApp.eventPage.Message",dp);var ep=function(a,b,c){this.ipAddress=a;this.appId=b;this.sessionId=c};dp.DeviceData=ep;dp.DeviceJustSetUp=function(a,b,c,d){this.ipAddress=a;this.name=b;this.udn=c;this.modelName=d};dp.DeviceCapabilities=function(){};
dp.LogRecord=function(a,b,c,d){this.levelValue=a;this.msg=b;this.loggerName=c;this.time=d};var gp=function(a,b){this.f=a;this.g=b;this.b=new nj;this.a=new Hl;this.l=0;this.u=new nj("serviceCheck",this.Wn.bind(this),"startDeviceMonitor",this.Xn.bind(this),"releaseDeviceMonitor",this.Vn.bind(this),"deviceJustSetUp",this.Sn.bind(this),"logRecord",this.Tn.bind(this));chrome.runtime.onMessage.addListener(this.v.bind(this));chrome.runtime.onMessageExternal.addListener(this.h.bind(this));fp(this,"serviceReady")};gp.prototype.j=kb("castApp.eventPage.Service");
var jp=function(a){if(hp(a)){var b=new Hl;Yi(a.f.a.ob(!1),function(a){var c=a.ab();b.add(c);this.b.pb(c)||this.g.sendRequest(new Qo,a,lo)}.bind(a));var c=!1;a.b.mb().forEach(function(a){b.contains(a)||(this.b.remove(a),c=!0)}.bind(a));c&&ip(a)}},hp=function(a){if(0===a.a.na())return!1;var b=gb();3E4<b-a.l&&(a.l=b,chrome.tabs.query({url:["chrome://cast/*","chrome-extension://"+chrome.runtime.id+"/cast_setup/*"]},function(a){0===a.length?(this.j.info("No tabs found. Clearing device monitor clients."),
this.a.clear()):this.j.info(function(){return"Tab check found active tabs: "+a.map(function(a){return a.id})})}.bind(a)));b=a.a.na();a.j.info("Monitor client count: "+b);return 0<b};gp.prototype.v=function(a,b,c){if("object"!==typeof a||"cast_app"!==a.type)return!1;var d=this.u.get(a.subtype);if(!d)return!1;if(!a.originId)return ec("Missing origin ID in the incoming message."),!1;try{var e=d(a,b,c);e&&c(e)}catch(f){this.j.error("Error while handling request",f)}return!1};
var fp=function(a,b,c){var d=new dp(b,c);v(a.j,function(){return"Sending message: "+JSON.stringify(d)});chrome.runtime.sendMessage(d)};g=gp.prototype;g.Wn=function(){fp(this,"serviceReady")};g.Xn=function(a){this.a.contains(a.originId)?this.j.info("Client: "+a.originId+"already registered, dispatching current device list."):(this.j.info("Registering monitor client: "+a.originId),this.a.add(a.originId));ip(this);kp(this)};g.Vn=function(a){this.j.info("Unregistering monitor client: "+a.originId);this.a.remove(a.originId)};
g.Sn=function(a){a=a.deviceJustSetUp;var b=a.udn.replace(/-/g,"").toLowerCase(),c;a.capabilities&&(c=(a.capabilities.audioOutSupported?4:0)|(a.capabilities.videoOutSupported?1:0));c=new Fn(b,a.name,a.modelName,c,a.ipAddress,nm().a||8009);Co(this.f,c,!0)};g.Tn=function(a){a=a.logRecord;nb({level:sb(a.levelValue),H:a.loggerName,time:a.time,message:a.msg})};
var ip=function(a){var b=a.b.X();fp(a,"devices",b)},kp=function(a){v(a.f.j,"Executing forceDiscovery.");chrome.mdns.forceDiscovery(Oa);a.f.a.X().forEach(function(a){this.g.sendRequest(new Qo,a,lo)}.bind(a))};gp.prototype.h=function(a,b,c){switch(a.type){case "handshake":c(new io("handshake"));break;case "launch":b=b.tab&&n(b.tab.id)?b.tab.id:null,null===b||"setup"!==a.entryPoint&&"offers"!==a.entryPoint&&"devices"!==a.entryPoint||chrome.tabs.update(b,{url:"chrome://cast#"+a.entryPoint})}};var lp=function(a){this.a=a;this.j=kb("mr.cast.ReceiverStatusQuerier")},mp=function(a,b){return Ud(new Sd(p(a.b,a,b),3500,5),2).start().then(null,function(c){a.j.info("Failed to get receiver status from "+b.getId());throw c;})};lp.prototype.b=function(a){this.j.info("Query receiver status: "+a.getId());return this.a.sendRequest(new Qo,a,lo)};var pp=function(a,b){if(!b.applications||1!=b.applications.length)return null;var c=b.applications[0];a=np(a);a=new chrome.cast.M(c.sessionId,c.appId,c.displayName,c.appImages,a);a.senderApps=c.senderApps;a.namespaces=c.namespaces||[];a.transportId=c.transportId;a.statusText=c.statusText;if(!a.sessionId||!(a.namespaces&&0!=a.namespaces.length||op(a)))return null;a.receiver.volume=b.volume;La(b.isActiveInput)&&(a.receiver.isActiveInput=b.isActiveInput);return a},qp=function(a){var b=[];if(!a)return b;
a&1&&b.push(chrome.cast.bd.VIDEO_OUT);a&2&&b.push(chrome.cast.bd.VIDEO_IN);a&4&&b.push(chrome.cast.bd.AUDIO_OUT);a&8&&b.push(chrome.cast.bd.AUDIO_IN);a&32&&b.push(chrome.cast.bd.MULTIZONE_GROUP);return b},np=function(a){return new chrome.cast.bh(a.getId(),a.a.friendlyName,qp(a.Mb))},rp=function(a,b){if(a.statusText!=b.statusText)return!0;var c=a.namespaces||[],d=b.namespaces||[];if(c.length!=d.length)return!0;for(var e={index:0};e.index<c.length;e={index:e.index},e.index++)if(!d.some(function(a){return function(b){return b.name==
c[a.index].name}}(e)))return!0;return a.receiver.volume.level!==b.receiver.volume.level||a.receiver.volume.muted!==b.receiver.volume.muted?!0:!1},sp=function(a){Va(a)?a.forEach(sp):Ya(a)&&Object.keys(a).forEach(function(b){null===a[b]?delete a[b]:(Ya(a[b])||Va(a[b]))&&sp(a[b])})},tp=function(a){return a.namespaces.some(function(a){return a.name==no})},up=["MultizoneLeader","MultizoneFollower"],op=function(a){return null!==a&&"MultizoneLeader"==a.appId},vp=function(a){return"E8C28D3C"==a||"00000000-0000-0000-0000-000000000000"==
a};var wp=function(a,b,c){this.H=kb("mr.MediaRouteController."+a);this.g=new mojo.Binding(mojo.MediaController,this,b);this.f=c;this.a=new mojo.MediaStatus({title:"",description:"",duration:new mojo.TimeDelta({microseconds:0}),current_time:new mojo.TimeDelta({microseconds:0})});this.s=!1;this.g.setConnectionErrorHandler(this.u.bind(this));this.f.ptr.setConnectionErrorHandler(this.u.bind(this))};wp.prototype.u=function(){this.H.info("Encountered Mojo connection error.");this.Na();this.h()};
wp.prototype.Na=function(){this.s||(this.s=!0,this.l(),this.g&&(this.g.close(),this.g=null),this.f&&(this.f.ptr.reset(),this.f=null))};var xp=function(a){if(a.f)a.f.onMediaStatusUpdated(a.a)};wp.prototype.l=function(){};wp.prototype.h=function(){};wp.prototype.play=function(){};wp.prototype.play=wp.prototype.play;wp.prototype.pause=function(){};wp.prototype.pause=wp.prototype.pause;wp.prototype.Yd=function(){};wp.prototype.setMute=wp.prototype.Yd;wp.prototype.Ec=function(){};
wp.prototype.setVolume=wp.prototype.Ec;wp.prototype.seek=function(){};wp.prototype.seek=wp.prototype.seek;wp.prototype.qh=function(a){a.close();throw Error("Not implemented");};wp.prototype.connectHangoutsMediaRouteController=wp.prototype.qh;var yp=function(a){var b=new URL(a);a={};a.scheme=b.protocol.replace(":","");a.host=b.hostname;b=b.port?Number.parseInt(b.port,10):0;switch(a.scheme){case "http":a.port=b||80;break;case "https":a.port=b||443;break;default:throw Error("Scheme must be http or https");}a.suborigin="";return new mojo.Origin(a)},zp=function(a){return new mojo.TimeDelta({microseconds:Math.floor(1E6*a)})};var Ap=function(a,b,c,d){this.type=a;this.mediaSessionId=b;this.requestId=0;this.sessionId=c;this.currentTime=d},Cp=function(a,b,c,d){wp.call(this,"CastRouteController",a,b);this.session=c;this.b=d;Bp(this)};Fa(Cp,wp);
var Bp=function(a){var b=Dp(a);b&&Ep(a,b);a.a.description=a.session.displayName.substring(0,256);a.session.statusText&&a.session.statusText!==a.session.displayName&&(a.a.title=a.session.statusText.substring(0,256));a.a.volume=null===a.session.receiver.volume.level?0:a.session.receiver.volume.level;a.a.is_muted=!!a.session.receiver.volume.muted;a.a.can_mute=a.session.receiver.volume.controlType!==chrome.cast.lj.FIXED;a.a.can_set_volume=a.a.can_mute;xp(a)};Cp.prototype.h=function(){Fp(this.b.a,this.session.sessionId)};
Cp.prototype.play=function(){var a=Dp(this);this.a.can_play_pause&&a&&this.a.play_state===mojo.MediaStatus.PlayState.PAUSED&&Gp(this.b,this.session,new Ap("PLAY",a.mediaSessionId,this.session.sessionId))};Cp.prototype.play=Cp.prototype.play;Cp.prototype.pause=function(){var a=Dp(this);this.a.can_play_pause&&a&&this.a.play_state!==mojo.MediaStatus.PlayState.PAUSED&&Gp(this.b,this.session,new Ap("PAUSE",a.mediaSessionId,this.session.sessionId))};Cp.prototype.pause=Cp.prototype.pause;
Cp.prototype.seek=function(a){var b=Dp(this);a=a?a.microseconds/1E6:0;var c;if(c=this.a.can_seek&&b&&0<=a)c=this.a.duration,c=a<=(c?c.microseconds/1E6:0);c&&Gp(this.b,this.session,new Ap("SEEK",b.mediaSessionId,this.session.sessionId,a))};Cp.prototype.seek=Cp.prototype.seek;Cp.prototype.Yd=function(a){this.a.can_mute&&a!==this.a.is_muted&&Hp(this.b,this.session,new chrome.cast.Volume(null,a))};Cp.prototype.setMute=Cp.prototype.Yd;
Cp.prototype.Ec=function(a){this.a.can_set_volume&&0<=a&&1>=a&&Hp(this.b,this.session,new chrome.cast.Volume(a))};Cp.prototype.setVolume=Cp.prototype.Ec;
var Dp=function(a){return a.session.media.find(function(a){return!a.idleReason})||null},Ep=function(a,b){b.media&&b.media.metadata&&b.media.metadata.title&&(a.a.title=b.media.metadata.title.substring(0,256));a.a.can_play_pause=b.supportedMediaCommands.includes(chrome.cast.media.Ad.PAUSE);a.a.can_seek=b.supportedMediaCommands.includes(chrome.cast.media.Ad.SEEK);var c=b.playerState;a.a.play_state=c===chrome.cast.media.af.PLAYING?mojo.MediaStatus.PlayState.PLAYING:c===chrome.cast.media.af.PAUSED?mojo.MediaStatus.PlayState.PAUSED:
mojo.MediaStatus.PlayState.BUFFERING;a.a.current_time=b.currentTime?zp(b.currentTime):zp(0);a.a.duration=b.media&&b.media.duration?zp(b.media.duration):zp(0)};var Ip=function(a){this.b=a;this.j=kb("mr.cast.SessionLauncher")},Jp=function(a,b,c){Eb("MediaRouter.Cast.Session.Type",0,Kn);return bp(a.b,b,c).then(a.a.bind(a,c),function(a){a&&cp==a?Tn(1):Tn(0);throw a;})};Ip.prototype.a=function(a,b){v(this.j,"Got launch result from "+a.getId());if("LAUNCH_ERROR"==b.type)throw Tn(2),Error(b.reason);a=pp(a,b.status);this.j.info("Launched session: "+a.sessionId);return a};var Kp=function(a,b){this.g=a;this.a=b;this.f=[];this.b=new Uo},Mp=function(a,b){return(a=Lp(a.a,b))?a.routeId:null};Kp.prototype.listen=function(a,b){this.f[a]=b};var Op=function(a,b,c,d){v(Np,"Sending to "+c);v(Np,JSON.stringify(d));d.clientId=c;a.g.b.nd(b,d)},Pp=function(a,b,c){var d=Lp(a.a,b);d&&d.a?Op(a,d.routeId,b,c):a.connect(b).then(function(d){d?(d=Mp(a,b))?Op(a,d,b,c):u(Np,"No route for "+b):u(Np,"No connected client "+b)},null)};
Kp.prototype.connect=function(a){var b=Lp(this.a,a);if(null!=b&&b.a)return Promise.resolve(!0);b=Mp(this,a);if(!b)return u(Np,"No route for client "+a),Promise.resolve(!1);if(a=this.b.a.get(b,null))return a.Ga.a;a=new Ib;Vo(this.b,new Qp(b,a));return a.a};var Np=kb("mr.cast.ApiMessenger"),Qp=function(a,b){To.call(this,a,3E4);this.Ga=b};Fa(Qp,To);Qp.prototype.a=function(){this.Ga.resolve(!1)};var Rp=function(a,b,c,d,e,f){this.f=a;this.h=b;this.l=c;this.a=d;this.v=e;this.g=f;this.b=new Kp(f,c);this.w=new lp(this.f);this.A=new Ip(this.f)};Rp.prototype.init=function(){this.l.init();this.b.listen("v2_message",this.s.bind(this));this.b.listen("app_message",this.u.bind(this));this.b.listen("leave_session",this.m.bind(this))};
var Up=function(a,b,c,d){Sp(a.a,b).slice().forEach(function(b){b!=d&&Tp(a,b,c)})},Tp=function(a,b,c){c.clientId=b;Pp(a.b,b,c)},Vp=function(a,b,c,d){c={receiver:np(c),action:d};Tp(a,b,new bl("receiver_action",c))};
Rp.prototype.s=function(a){var b=a.message,c=b.sessionId;if(c){var d=Wp(this.a,c);if(d)if(c=Xp(this.a,c))if(c=this.h.b(c))switch(b.type){case "STOP":Yp(this,a,c);break;case "LOAD":case "PAUSE":case "PLAY":case "SEEK":case "STOP_MEDIA":case "MEDIA_SET_VOLUME":case "MEDIA_GET_STATUS":case "EDIT_TRACKS_INFO":case "QUEUE_LOAD":case "QUEUE_INSERT":case "QUEUE_UPDATE":case "QUEUE_REMOVE":case "QUEUE_REORDER":case "PRECACHE":Zp(this,a,c,d);break;case "SET_VOLUME":$p(this,a,c);break;default:u(aq,"Unknown request")}else bq(this,
a,chrome.cast.Jc.INVALID_PARAMETER,"No receiver");else bq(this,a,chrome.cast.Jc.INVALID_PARAMETER,"No sink ID");else bq(this,a,chrome.cast.Jc.INVALID_PARAMETER,"Unknown session ID")}else bq(this,a,chrome.cast.Jc.INVALID_PARAMETER,"No session ID")};
var bq=function(a,b,c,d){c=new chrome.cast.Error(c,d);cq(a,b,c)},cq=function(a,b,c){Pp(a.b,b.clientId,new bl("error",c,b.sequenceNumber))},Yp=function(a,b,c){var d=b.message;Db("MediaRouter.Cast.Session.End");var e=d.sessionId,f=dq(a.a,e);f&&(f.g=!0);f=function(){eq(a,e,b)};a.f.sendRequest(d,c,lo,b.timeoutMillis,b.clientId).then(f,f)},Zp=function(a,b,c,d){var e=b.message,f=e.type;f in Wk&&(e.type=Wk[f]);a.f.sendRequest(e,c,no,b.timeoutMillis,b.clientId,d.transportId).then(function(c){fq(a,d,c);Pp(a.b,
b.clientId,new bl("v2_message",c,b.sequenceNumber))},function(c){cq(a,b,c)})},$p=function(a,b,c){var d=b.message;delete d.sessionId;a.f.sendRequest(d,c,lo,b.timeoutMillis,b.clientId).then(function(){Pp(a.b,b.clientId,new bl("v2_message",null,b.sequenceNumber))},function(c){cq(a,b,c)})};
Rp.prototype.u=function(a){var b=this,c=a.message,d=c.sessionId;if(d){var e=Xp(this.a,d);e?(e=this.h.b(e))?(d=Wp(this.a,d),pc(d.namespaces,function(a){return a.name==c.namespaceName})?$o(this.v,e,c.namespaceName,c.message,a.clientId,d.transportId).then(function(){Pp(b.b,a.clientId,new bl("app_message",null,a.sequenceNumber))},function(){bq(b,a,chrome.cast.Jc.CHANNEL_ERROR,"Channel to receiver not available")}):bq(this,a,chrome.cast.Jc.INVALID_PARAMETER,"Invalid namespace")):u(aq,"No receiver from sinkId"):
u(aq,"No sinkId from sessionId")}else u(aq,"No sessionId")};
Rp.prototype.m=function(a){var b=this;aq.info("Leave session");var c=dq(this.a,a.message);if(c){var d=a.clientId,e=Lp(this.l,d);if(e){var f=[],h=[],k=e.tabId,m=e.origin,r=e.autoJoinPolicy;c.b.forEach(function(a){var c=Lp(b.l,a);r==chrome.cast.Ic.TAB_AND_ORIGIN_SCOPED&&k==c.tabId&&m==c.origin||r==chrome.cast.Ic.ORIGIN_SCOPED&&m==c.origin?(c.b=!0,f.push(a)):h.push(a)});Pp(this.b,d,new bl("leave_session",null,a.sequenceNumber));f.forEach(function(a){(a=Lp(b.l,a))&&gq(b.g,a.routeId,!0,!0)});c.b=h}else u(aq,
"No client record")}else u(aq,"No session")};
var hq=function(a,b,c){tp(b)&&a.f.sendRequest(new Qo,c,no,void 0,void 0,b.transportId).catch(Oa)},xo=function(a,b,c){var d=b.getId();aq.info("Query status for "+d);mp(a.w,b).then(function(e){iq(a,d,e);c&&(e=jq(a.a,d))&&hq(a,e,b)},Oa)},kq=function(a,b){if("*"==b.destinationId)return!0;b=b.destinationId;if(b==a.v.u||null!=Lp(a.l,b))return!0;aq.info("Invalid destination "+b);return!1},pq=function(a,b,c){v(aq,function(){return"Cast message: "+JSON.stringify(c)});if(kq(a,c))if(c.namespace_==mo||c.namespace_==
oo)(b=lq(a.a,b))&&b.a.forEach(function(b){var d=a.g,e=d.f.get(b);e&&e.je&&d.b.Jg(b,c)});else{var d=JSON.parse(c.data),e=mq(a,d);e=e?e.sourceId:void 0;switch(d.type){case "RECEIVER_STATUS":iq(a,b,d);break;case "MEDIA_STATUS":nq(a,b,c,e)}}else oq(a.v,b,c.destinationId,c.sourceId,!1)},mq=function(a,b){a=Wo(a.f.a,b.requestId);if(!a)return null;var c=a.Ga;switch(b.type){case "LAUNCH_ERROR":case "INVALID_REQUEST":case "LOAD_CANCELLED":case "LOAD_FAILED":case "INVALID_PLAYER_STATE":delete b.requestId;c.reject(new chrome.cast.Error(chrome.cast.Jc.SESSION_ERROR,
b.reason||b.type,b));break;default:c.resolve(b)}return a},qq=function(a,b,c){v(aq,function(){return"App message: "+JSON.stringify(c)});if(b=jq(a.a,b)){var d;"*"==c.destinationId?d=Sp(a.a,b.sessionId):d=[c.destinationId];var e=new Vk(b.sessionId,c.namespace_,c.data);d.forEach(function(b){Pp(a.b,b,new bl("app_message",e))})}else u(aq,"No session for incoming app message")},rq=function(a,b){a.forEach(function(a){a.sessionId=b;var c=a.supportedMediaCommands,e=[];c&1&&e.push(chrome.cast.media.Ad.PAUSE);
c&2&&e.push(chrome.cast.media.Ad.SEEK);c&4&&e.push(chrome.cast.media.Ad.STREAM_VOLUME);c&8&&e.push(chrome.cast.media.Ad.STREAM_MUTE);a.supportedMediaCommands=e});return a},fq=function(a,b,c){b=b.sessionId;c.sessionId=b;c=rq(c.status,b);sq(a.a,b,c);(a=dq(a.a,b))&&a.controller&&(a=a.controller,(c=Dp(a))?Ep(a,c):(a.a.title="",a.a.can_play_pause=!1,a.a.can_seek=!1),xp(a))},tq=function(a,b){if(b=jq(a.a,b)){b=b.sessionId;var c=dq(a.a,b);c&&c.g||eq(a,b)}},eq=function(a,b,c){c&&Tp(a,c.clientId,c);(c=dq(a.a,
b))&&c.a.slice().forEach(function(b){gq(a.g,b,!0)});uq(a.a,b);vq(a.g)},iq=function(a,b,c){v(aq,"Receiver status for "+b);var d=c.status;if(d)if(c=a.h.b(b)){d=pp(c,d);var e=lq(a.a,b);e?d?d.sessionId==e.session.sessionId?(b=e.session,rp(b,d)&&(v(aq,"Updating session "+d.sessionId),b.statusText=d.statusText,b.namespaces=d.namespaces,b.receiver.volume=d.receiver.volume,wq(a.g,e),Up(a,b.sessionId,new bl("update_session",b)),e.controller&&Bp(e.controller))):(tq(a,b),Qn(1),xq(a.g,null,c,null,d)):(tq(a,b),
Qn(1)):d&&xq(a.g,null,c,null,d)}else Db("MediaRouter.Cast.Error.Sink.Missing.From.Discovery.Service"),u(aq,"Got message from receiver "+b+", but sink is no longer available.")},nq=function(a,b,c,d){if(b=jq(a.a,b))if(c=JSON.parse(c.data))fq(a,b,c),Up(a,c.sessionId,new bl("v2_message",c),d)},yq=function(a,b){var c=qp(b.Mb);return(b=pc(a.l,function(a){return nc(a.capabilities,function(a){return rc(c,a)})}))?b.appId:zl(a)[0]},zq=function(a,b,c){var d=El(b);if(!d)return Promise.reject(Error("Invalid source "+
b));var e=yq(d,c),f=new tb("MediaRouter.Cast.Session.Launch");return Jp(a.A,new chrome.cast.fj(e,void 0,null==d.g?chrome.cast.timeout.requestSession:d.g),c).then(function(a){aq.info("Launched session "+a.sessionId+" for appId "+e);f.a("Success");return a},function(a){aq.error("Failed to session for appId "+e);f.a("Failure");throw a;})};
Rp.prototype.createMediaRouteController=function(a,b,c){a=Aq(this.a,a);if(!a)return Error("Session not found for the route");var d=a.session;if(a.controller)return Error("Controller already exists for the route");var e=Bq(this,d.sessionId);if(!e)return Error("Sink not found for the route");a.controller=new Cp(b,c,d,this);hq(this,d,e);return null};
var Gp=function(a,b,c){var d=Bq(a,b.sessionId);d&&a.f.sendRequest(c,d,no,0,"",b.transportId).catch(function(a){u(aq,"Failed to send a media control request: "+a)})},Hp=function(a,b,c){c=new Xk(c);(b=Bq(a,b.sessionId))&&a.f.sendRequest(c,b,lo).catch(function(a){u(aq,"Failed to send a volume control request: "+a)})},Bq=function(a,b){return(b=Xp(a.a,b))?a.h.b(b):null},aq=kb("mr.cast.ApiHandler");var Cq=function(){this.b=new nj;this.f=new nj;this.a=new nj},Hq=function(a,b,c){c=void 0===c?!1:c;var d=b.getId(),e=b.ab()+":"+b.Oa(),f=a.b.get(d);if(f){if(a.a.get(d)==e)return v(Dq,"Using pending creation to "+d),f;Dq.info("Device "+d+" IP changed from "+a.a.get(b.getId())+" to "+e);Eq(a,b)}b=Fq(a,b,c?15E3:1E4).then(function(b){Gq(a,d);Rn(1);return b},function(b){e==a.a.get(d)&&Gq(a,d);Rn(0);return Promise.reject(b)});a.b.set(d,b);a.a.set(d,e);return b},Eq=function(a,b){b=b.getId();v(Dq,"Aborting connection to device "+
b);var c=a.f.get(b);c&&c.abort();Gq(a,b)},Gq=function(a,b){a.b.remove(b);a.f.remove(b);a.a.remove(b)},Fq=function(a,b,c){var d=new Sd(function(){return Iq(b,c)},1E3,3);a.f.set(b.getId(),d);return Ud(d,1.5).start().then(null,function(a){Dq.info("Failed to create channel to "+b.getId());return Promise.reject(a)})},Iq=function(a,b){var c=Jq++;Dq.info("Connecting to (id "+c+") "+a.getId());var d=new tb("MediaRouter.Cast.Mdns.Channel.Open");return Kq(a,b).then(function(a){Dq.info(function(){return"Channel opened (id "+
c+"): "+JSON.stringify(a)});d.a("Success");return a},function(a){Dq.info("Channel did not open (id "+c+").");d.a("Failure");return Promise.reject(a)})},Kq=function(a,b){var c={ipAddress:a.ab(),port:a.Oa(),auth:"ssl_verified",timeout:1E4,livenessTimeout:b,pingInterval:5E3,capabilities:0};Dq.info(function(){return"Opening channel to "+JSON.stringify(c)});var d=new Ib;chrome.cast.channel.open(c,function(a){a?"open"==a.readyState?d.resolve(a):(Gm("chrome.cast.channel.open",Dq),chrome.cast.channel.close(a,
function(){Gm("chrome.cast.channel.close",Dq)}),d.reject(Error(a.errorState))):(a=Gm("chrome.cast.channel.open",Dq),d.reject(a))});return d.a},Dq=kb("mr.cast.ChannelFactory"),Jq=0;var Lq=function(a,b,c,d){return{namespace_:a,data:Ka(b)?b:JSON.stringify(b),sourceId:c,destinationId:d}};var Mq=function(a){this.type="CLOSE";this.reasonCode=a};var Nq=Kd("Firefox"),Oq=Qd()||Kd("iPod"),Pq=Kd("iPad"),Qq=Kd("Android")&&!(Ld()||Kd("Firefox")||Kd("Opera")||Kd("Silk")),Rq=Ld(),Sq=Kd("Safari")&&!(Ld()||Kd("Coast")||Kd("Opera")||Kd("Edge")||Kd("Silk")||Kd("Android"))&&!Rd();var Tq=function(a){return(a=a.exec(Hd))?a[1]:""},Uq=function(){if(Nq)return Tq(/Firefox\/([0-9.]+)/);if(ae||be||$d)return te;if(Rq)return Rd()?Tq(/CriOS\/([0-9.]+)/):Tq(/Chrome\/([0-9.]+)/);if(Sq&&!Rd())return Tq(/Version\/([0-9.]+)/);if(Oq||Pq){var a=/Version\/(\S+).*Mobile\/(\S+)/.exec(Hd);if(a)return a[1]+"."+a[2]}else if(Qq)return(a=Tq(/Android\s+([0-9.]+)/))?a:Tq(/Version\/([0-9.]+)/);return""}(),Vq=function(a){return 0<=Zb(Uq,a)};var Xq=function(a){this.type="CONNECT";this.origin={};this.userAgent=Hd;var b=this.userAgent.indexOf("(")+1;b=this.userAgent.substr(b,this.userAgent.indexOf(")",b)-1-b+1);this.senderInfo={sdkType:2,version:chrome.runtime.getManifest().version,browserVersion:Uq,platform:Wq(),systemVersion:b,connectionType:1};this.connType=a?0:2},Wq=function(){switch(Of()){case "ChromeOS":return 5;case "Windows":return 3;case "Mac":return 4;case "Linux":return 6}return 0};var Yq=function(){this.a=new nj};Yq.prototype.init=function(){lh(this)};var Zq=function(a,b,c,d,e){if(!a.a.pb([b.channelId,c,d].join("#"))){var f=Lq(ko,new Xq(e),c,d);chrome.cast.channel.send(b,f,a.b.bind(a));a.a.set([b.channelId,c,d].join("#"),e)}};Yq.prototype.b=function(){Gm("chrome.cast.channel.send",$q)};
var yo=function(a,b){a.a.mb().forEach(function(c){c.split("#")[0]==b.channelId.toString()&&a.a.remove(c)})},wo=function(a,b,c){a.a.forEach(function(d,e){var f=e.split("#");f[0]==b.channelId.toString()&&(Zq(a,c,f[1],f[2],d),a.a.remove(e))})};Yq.prototype.ua=function(){return"cast.VirtualConnectionManager"};Yq.prototype.Pa=function(){var a=rj(this.a);return[new ar(a)]};Yq.prototype.Ta=function(){var a=ih(this);if(a)for(var b in a.a)this.a.set(b,a.a[b])};Qa(Yq);
var $q=kb("mr.cast.VirtualConnectionManager"),ar=function(a){this.a=a};var br=function(a,b){this.l=b;this.u=a;this.b=new nj;this.a=new nj;this.f=Yq.Da();this.m=new Cq;this.h=!0;this.v=null;this.g=new nj};Fa(br,pg);br.prototype.handleEvent=function(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];a==chrome.cast.channel.onMessage?this.w.apply(this,[].concat(l(c))):a==chrome.cast.channel.onError&&this.s.apply(this,[].concat(l(c)))};br.prototype.init=function(a){this.h=void 0===a?!0:a;this.f.init();lh(this);zg("mr.cast.ChannelService",this);Uk().forEach(function(a){return a.addListener()})};
var $o=function(a,b,c,d,e,f){var h=e||a.u,k=f||"receiver-0";return Ho(a,b).then(function(b){return cr(a,b,c,d,h,k)})},dr=function(a,b,c,d,e){Ho(a,b).then(function(b){return Zq(a.f,b,c,d,e)})},oq=function(a,b,c,d,e){if(b=a.b.get(b))a=a.f,a.a.pb([b.channelId,c,d].join("#"))&&(a.a.remove([b.channelId,c,d].join("#")),c=Lq(ko,new Mq(e?5:0),c,d),chrome.cast.channel.send(b,c,a.b.bind(a)))};
br.prototype.w=function(a,b){var c=this.a.get(a.channelId);if(c){var d=this.v(c);if(d){if(qo.hasOwnProperty(b.namespace_)){var e=JSON.parse(b.data);switch(e.type){case "CLOSE":this.f.a.remove([a.channelId,b.destinationId,b.sourceId].join("#"));return;case "RPC":break;default:v(vo,function(){return"Got message "+(e.type||e.responseType)+" "+("from "+d.getId())})}}else v(vo,"Got message in "+b.namespace_+" from "+d.getId());er(this.l,d,b)}else u(vo,"Got message for unknown receiver (receiverId="+c+
").")}else u(vo,"Got message for unknown channel (channelId="+a.channelId+").")};var fr=function(a,b){a.h&&chrome.cast.channel.close(b,function(){chrome.runtime.lastError||v(vo,"Channel close success")});var c=a.a.get(b.channelId);c&&(a.a.remove(b.channelId),a.b.remove(c))};br.prototype.s=function(a,b){u(vo,function(){return"Channel error: "+JSON.stringify(a)+(b?", "+JSON.stringify(b):"")});b&&gr(b);hr(this,a)};
var gr=function(a){switch(a.errorState){case "unknown":var b=0;break;case "authentication_error":b=1;break;case "connect_error":b=2;break;case "connect_timeout":b=6;break;case "ping_timeout":b=7;break;default:return}if(-8192<=a.nssErrorCode&&-7192>a.nssErrorCode||2==a.challengeReplyErrorType||8==a.challengeReplyErrorType||9==a.challengeReplyErrorType||11==a.challengeReplyErrorType||-200>=a.netReturnValue&&-300<a.netReturnValue||30==a.eventType||31==a.eventType||32==a.eventType)b=3;if(26==a.eventType||
-201==a.netReturnValue||-8181==a.nssErrorCode||-8162==a.nssErrorCode||-8161==a.nssErrorCode)b=4;-138==a.netReturnValue&&(b=5);if(-8182==a.nssErrorCode||10==a.eventType||12==a.eventType)b=1;u(vo,"Channel error code: "+b);Eb("MediaRouter.Cast.Channel.Error",b,On)},hr=function(a,b){var c=a.a.get(b.channelId);fr(a,b);if(!a.h)v(vo,"Close channel for receiver: "+c+", skip retry");else if(c){var d=a.v(c);d&&Ho(a,d,!0).then(function(c){vo.info("Re-connected to receiver: "+d.getId());wo(a.f,b,c);xo(a.l.g,
d,!0)},function(){vo.info("Failed to re-connect to receiver: "+d.getId());yo(a.f,b);var c=a.l.a,f=d.getId();c.j.info("Channel error for sink "+f);Zn(c,f);Qn(2)})}},Ho=function(a,b,c){c=void 0===c?!1:c;var d=b.getId(),e=a.b.get(d);return e&&"open"==e.readyState?Promise.resolve(e):a.h?Hq(a.m,b,c).then(function(b){if(a.a.pb(b.channelId))return b;a.b.get(d)&&(u(vo,"Duplicate channel to a receiver "+d),fr(a,a.b.get(d)));vo.info("Connected to: "+d);a.b.set(d,b);a.a.set(b.channelId,d);return b},null):(vo.info("Channel not found for receiver: "+
d),Promise.reject(Error("Channel not found for receiver: "+d)))},cr=function(a,b,c,d,e,f){Zq(a.f,b,e,f,0==f.indexOf("receiver-0"));sp(d);var h=Lq(c,d,e,f);"object"===typeof d&&"RPC"==d.type||v(vo,function(){return"Channel is sending message: "+JSON.stringify(h)});return new Promise(function(c,d){chrome.cast.channel.send(b,h,function(b){b?b.errorState?(d(Error("Failed to send message")),hr(a,b)):c(!0):(b=Gm("chrome.cast.channel.send",vo),d(b))})})};br.prototype.ua=function(){return"cast.ChannelService"};
br.prototype.Pa=function(){return[new ir(rj(this.b),rj(this.a),rj(this.g))]};br.prototype.Ta=function(){var a=ih(this);a&&(mj(this.b,a.b),mj(this.a,a.a),mj(this.g,a.f))};var vo=kb("mr.cast.ChannelService"),ir=function(a,b,c){this.b=a;this.a=b;this.f=c};var jr=function(){this.requestId=0;this.type="GET_APP_AVAILABILITY";this.appId=[]};var kr=function(a,b){this.g=a;this.b=b;this.f=new Hl;this.a=new nj};kr.prototype.init=function(){lh(this)};var lr=function(a,b){var c=a.a.get(b);c&&(c.si--,0<c.si||(Yi(a.b.a.ob(!1),function(a){switch(Jn(a,b)){case "available":a.Jb[b]="available_rescan";break;case "unavailable":a.Jb[b]="unavailable_rescan"}}),a.a.remove(b)))};g=kr.prototype;
g.pk=function(a){var b=this;Yi(this.a.ob(!0),function(c){a:{switch(Jn(a,c)){case "unknown":case "available_rescan":case "unavailable_rescan":var d=!0;break a}d=!1}if(d){var e=a.getId()+":"+c;b.f.contains(e)||(b.f.add(e),d=function(){b.f.remove(e)},Ud(new Sd(b.zn.bind(b,a,c),5500,3),2).start().then(b.nl.bind(b,a,c),function(){b.j.error("Failed to get app availability response for "+a.getId()+", appId "+c+" after 3 attempts.");b.nl(a,c,"unknown")}).then(d,d))}})};
g.nl=function(a,b,c){c!=Jn(a,b)&&(this.j.info(b+" on "+a.getId()+" is "+c),a.Jb[b]=c,$n(this.b.f,a))};
g.zn=function(a,b){var c=this,d=new jr;d.appId=[b];var e=new tb("MediaRouter.Cast.App.Availability");return this.g.sendRequest(d,a,lo,5E3).then(function(a){e.a("Success");v(c.j,function(){return"App availability response "+JSON.stringify(a)});for(var b in a.availability){if("APP_AVAILABLE"==a.availability[b])return"available";if("APP_UNAVAILABLE"==a.availability[b])return"unavailable"}return"unknown"},function(d){e.a("Failure");c.j.error("checkAppAvailability_ failed for "+a.getId()+", appId "+b);
throw d;})};g.ua=function(){return"cast.AppDiscoveryService"};g.Pa=function(){return[new nr(rj(this.a))]};g.Ta=function(){var a=ih(this);a&&mj(this.a,a.a)};g.j=kb("mr.cast.AppDiscoveryService");var nr=function(a){this.a=a};var or=function(a,b,c,d){c=Jk(c,"cast",b.getId(),a,d,"");c.supportsMediaRouteController=!0;mojo&&mojo.RouteControllerType&&(c.controllerType=d&&hg(a)&&b.Mb&1&&mojo.RouteControllerType.kMirroring?mojo.RouteControllerType.kMirroring:mojo.RouteControllerType.kGeneric);return c};var pr=function(a,b,c,d,e,f){this.routeId=a;this.clientId=b;this.appIds=c;this.autoJoinPolicy=d;this.origin=e;this.tabId=f;this.b=this.a=!1},qr=function(){this.a=[]};qr.prototype.init=function(){lh(this)};qr.prototype.na=function(){return this.a.length};var Lp=function(a,b){return pc(a.a,function(a){return a.clientId==b})},rr=function(a,b){return pc(a.a,function(a){return a.routeId==b})},sr=function(a,b){a.a=jc(a.a,function(a){return a.clientId!=b})};qr.prototype.ua=function(){return"cast.ClientRecords"};
qr.prototype.Pa=function(){return[new tr(this.a)]};qr.prototype.Ta=function(){var a=ih(this);a&&(this.a=a.a)};var tr=function(a){this.a=a};var ur=function(a){this.a=a},vr=function(){var a=[];nm().l.forEach(function(b){var c="Receiver-"+b.replace(/\./g,"_"),d=nm().a||8009;a.push({serviceName:c+"._googlecast._tcp.local",serviceHostPort:0<b.indexOf(":")?"["+b+"]:"+d:b+":"+d,ipAddress:b,serviceData:["id=mdns:"+c,"ve=02","ca=5","st=1","fn="+c,"md=Chromecast"]})});return a};ur.prototype.init=function(){var a=vr(),b=this.a;b.J(a);b.F=a};var wr=chrome.i18n.getMessage("4528089202128275824");chrome.i18n.getMessage("2810417817914017289");chrome.i18n.getMessage("3413021810593924462");chrome.i18n.getMessage("7603034707785674700");chrome.i18n.getMessage("8009014317872238527");chrome.i18n.getMessage("8636962961150071298");chrome.i18n.getMessage("1802762746589457177");var xr=function(a,b){this.b=[];this.a=[];this.sinkId=a;this.session=b;this.l=this.f=null;this.offTheRecord=this.g=!1;this.controller=null},yr=function(){this.j=kb("mr.cast.SessionRecords");this.a=[]};yr.prototype.init=function(){lh(this)};
var uq=function(a,b){a.j.info("Removing session "+b);Fp(a,b);a.a=jc(a.a,function(a){return a.session.sessionId!=b})},Sp=function(a,b){return(a=dq(a,b))?a.b:[]},jq=function(a,b){return(a=lq(a,b))?a.session:null},zr=function(a,b){return pc(a.a,function(a){return rc(a.b,b)})},Aq=function(a,b){return pc(a.a,function(a){return rc(a.a,b)})},Ar=function(a,b){return pc(a.a,function(a){return null!=pc(a.a,function(a){return Hk(a).a==b})})},lq=function(a,b){return pc(a.a,function(a){return a.sinkId==b||a.f==
b})},dq=function(a,b){return pc(a.a,function(a){return a.session.sessionId==b})},Xp=function(a,b){return(a=dq(a,b))?a.sinkId:null},Wp=function(a,b){return(a=dq(a,b))?a.session:null},sq=function(a,b,c){var d=Wp(a,b);d&&(a=jc(c,function(a){return a.playerState!=chrome.cast.media.af.IDLE}),a.forEach(function(a){if(!a.media){var b=pc(d.media,function(b){return b.mediaSessionId==a.mediaSessionId});b&&(a.media=b.media)}}),d.media=a)};yr.prototype.ua=function(){return"cast.SessionRecords"};
yr.prototype.Pa=function(){return[new Br(this.a)]};yr.prototype.Ta=function(){var a=ih(this);if(a)for(var b=0;b<a.a.length;b++){var c=a.a[b],d=new xr(c.sinkId,c.session);d.b=c.b;d.a=c.a;d.g=c.g;d.l=c.l;d.f=c.f;this.a.push(d)}};
var Fp=function(a,b){(a=dq(a,b))&&a.controller&&(a.controller.Na(),a.controller=null)},Br=function(a){var b=[];a=la(a);for(var c=a.next();!c.done;c=a.next()){c=c.value;var d=new xr(c.sinkId,c.session);d.b=c.b;d.a=c.a;d.g=c.g;d.l=c.l;d.f=c.f;d.offTheRecord=c.offTheRecord;b.push(d)}this.a=b};var Cr=function(a){this.m="sender-"+Xb();this.f=new nj;this.v=null;lh(this);this.b=a;this.h=new qr;this.l=new yr;this.u=new br(this.m,this);this.a=new ro(this.u,this);this.R=new ur(this.a);this.s=new Xo(this.u,this.m);this.w=new kr(this.s,this.a);this.g=new Rp(this.s,this.a,this.h,this.l,this.u,this);this.A=new gp(this.a,this.s);this.F=this.a.start.bind(this.a);this.I=!0};g=Cr.prototype;g.getName=function(){return"cast"};
g.Ya=function(a){a=a?a.enable_cast_discovery:!0;this.j.info("Cast discovery enabled: "+a+"...");this.s.init();this.l.init();this.g.init();this.u.init(a);this.a.init();this.R.init();this.w.init();(this.I=a)?this.b.ri(this.F):this.a.stop()};g.Ld=function(){return this.f.X()};g.kf=function(a){var b=this;if(null!=Dr(a))return new Kl([]);var c=new Hl;Er(a).forEach(function(a){Jo(b.a,a).map(function(a){return a.a}).forEach(function(a){c.add(a)})});return new Kl(c.X(),-1!=a.indexOf("0F5096E8")?lg:null)};
g.startObservingMediaSinks=function(a){var b=this,c=Dr(a);c?(this.j.info("Received broadcast request "+a),Yi(this.a.a.ob(!1),function(a){b.s.sendMessage(c,a,po).catch(function(a){b.j.error("Broadcast failed "+a.message)})})):(Er(a).forEach(function(a){var c=b.w,d=c.a.get(a);d?d.si++:c.a.set(a,{si:1});c.j.info("Scanning sinks for app availability");Yi(c.b.a.ob(!1),c.pk,c)}),this.I&&this.b.Nh()&&this.a.start())};
g.stopObservingMediaSinks=function(a){var b=this;null!=Dr(a)||Er(a).forEach(function(a){lr(b.w,a)})};g.startObservingMediaRoutes=function(){};g.stopObservingMediaRoutes=function(){};g.wf=function(a){return(a=this.a.b(a))?a.a:null};
var Fr=function(a,b,c){a.j.error("Error launching.",c);gq(a,b.id,!1,!0,"error");c=new Df(wr,"warning");c.routeId=b.id;a.b.Nd(c)},Jr=function(a,b,c,d,e,f,h,k){nm().f=new km(c.Lb,c.ab());var m=or(b,c,d,!0);m.forDisplay=!1;m.offTheRecord=e;a.f.set(m.id,m);a.b.He(a,m);vq(a);(e=El(b))&&e.a&&Gr(a,e,m.id,h,k);jg(b)||kg(b)?(m.Zb={tabId:k,sessionId:"",Nf:c.ab()||"",ae:c.Lb||"",Xp:c.a.friendlyName||""},kg(b)&&(m.isOffscreenPresentation=!0),a.b.Th(a,m,d,function(e){return Lf(Hr(a,b,c,d,f,h,k,e))}).a.then(function(){Ir(a,
m)},function(b){Fr(a,m,b)})):Hr(a,b,c,d,f,h,k,m).then(null,function(b){Fr(a,m,b)});return Promise.resolve(m)},Hr=function(a,b,c,d,e,f,h,k){return zq(a.g,Kr(b,c,e),c).then(function(e){xq(a,b,c,d,e,f,h,k);return k})};
Cr.prototype.createRoute=function(a,b,c,d,e,f,h){var k=this,m=this.a.b(b);if(!m)return Kf(Error("No sink with ID "+b));var r=Fl(a);if(r){setTimeout(function(){Vp(k.g,r,m,chrome.cast.bf.CAST)},0);var y=function(){return Jr(k,a,m,c,d,e,f,h)},A=Lp(this.h,r);if(A)return Lf(this.terminateRoute(A.routeId).then(y,y));if(f&&h&&(b=Lr(this,a,f,h,d,e,b)))return b}return Lf(Jr(this,a,m,c,d,e,f,h))};
var gq=function(a,b,c,d,e){d=void 0===d?!1:d;e=void 0===e?"closed":e;a.j.info("Remove route "+b);var f=rr(a.h,b);if(f){c=c||f.b;var h=f.clientId;a.j.info("Remove client "+h);for(var k=a.l,m=0;m<k.a.length;m++)xc(k.a[m].b,h);sr(a.h,h)}if(h=Aq(a.l,b))xc(h.a,b),Mr(a,h.a);if(k=a.f.get(b))if(k.je&&h&&(oq(a.u,k.sinkId,f?f.clientId:a.m,h.session.transportId,c),k.forDisplay&&f&&(a.v={he:f,al:h})),a.f.remove(b),a.b.yf(k),vq(a),d)a.b.onPresentationConnectionClosed(b,e,"Remove route");else a.b.onPresentationConnectionStateChanged(b,
"terminated")},wq=function(a,b){b.a.forEach(function(c){if(c=a.f.get(c)){var d=b.session;c.Zb&&c.forDisplay?Ir(a,c):(c.description=d.statusText||d.displayName,a.b.od(c))}})},Nr=function(a,b){mc(b,function(b){b=a.f.get(b,null);if(!b||!b.mediaSource)return!1;var c=El(b.mediaSource);c=c?c.u:!1;return b.isLocal&&!c})&&w(b,function(b){if(b=a.f.get(b,null))b.isLocal=!0})},Mr=function(a,b){var c=[],d=[],e=null;b.forEach(function(b){if(b=a.f.get(b)){b.forDisplay=!1;var f=El(b.mediaSource);f&&pc(zl(f),vp)||
(b.je?(f=f?Al(f):null,e||f==chrome.cast.Ic.CUSTOM_CONTROLLER_SCOPED||(c.push(b),e=b.sinkId)):e&&e!=b.sinkId?c.push(b):d.push(b))}});w(0<c.length?c:d,function(a){a.forDisplay=!0})},Gr=function(a,b,c,d,e){var f=b.a;if(f&&!Lp(a.h,f)){a.j.info("Add client "+f);var h=zl(b);a.h.a.push(new pr(c,f,h,Al(b),d||null,Ja(e)?e:null))}},Ir=function(a,b){if(a=Aq(a.l,b.id))a=a.session,a.statusText=b.description||a.statusText},xq=function(a,b,c,d,e,f,h,k){var m=lq(a.l,c.getId());if(!m){var r=a.l;m=c.getId();r.j.info("Adding new session: "+
m+", "+e.sessionId);var y=dq(r,e.sessionId);y?(op(e)?(y.l=e,y.f=m):op(y.session)&&(y.l=y.session,y.f=y.sinkId,y.session=e,y.sinkId=m),m=y):(m=new xr(m,e),r.a.push(m))}var A=null!=b;if(!A&&vp(e.appId))return null;null==b?(y=new vl([{appId:e.appId,capabilities:e.capabilities}]),b=Bl(y)[0]):y=El(b);if(r=k){if(!a.f.get(r.id))return u(a.j,"Route "+r.id+" not added"),r}else r=or(b,c,d||e.sessionId,A),a.f.set(r.id,r);d=r.id;a.j.info("Add route "+d);b=null;y&&(b=y.a,Gr(a,y,d,f,h));rc(m.a,d)||m.a.push(d);
r.je&&dr(a.u,c,b||a.m,e.transportId,!(y&&y.u));m.offTheRecord=r.offTheRecord;f=m.a;Nr(a,f);Mr(a,f);f=r;h=e.sessionId;d=e.appId;("0F5096E8"==d||"85CDB22F"==d)&&h&&f.Zb&&(f.Zb.sessionId=h);!tp(e)||null!==e&&rc(up,e.appId)||(f.customControllerPath="cast_route_details.html?"+["sessionId="+h,"appId="+d].join("&"));f.description=e.statusText||e.displayName;k?a.b.od(r):a.b.He(a,r);vq(a);if(k=b)rc(m.b,b)?k=!1:(m.b.push(b),k=!0);k&&(a=a.g,Pp(a.b,b,new bl("new_session",e)),hq(a,e,c));return r};
Cr.prototype.terminateRoute=function(a){var b=this,c=this.f.get(a);if(!c)return Promise.reject(new cm(3,"Route in Cast provider not found for routeId  "+a));var d=Aq(this.l,a);if(!d)return gq(this,a,!0),Promise.resolve();var e=d.session.sessionId,f=this.a.b(c.sinkId);if(!f)return eq(this.g,e),Promise.resolve();(a=rr(this.h,a))&&Vp(this.g,a.clientId,f,chrome.cast.bf.STOP);Qn(0);return new Promise(function(a){var c=function(){tq(b.g,f.getId());a()};b.s.sendRequest(new Yk(e),f,lo).then(c,c)})};
var Or=function(a,b){var c=null;Zi(a.f.ob(!1),function(d){if(!d.je)return!1;var e=a.a.b(d.sinkId);if(!e||!Dl(b,Kr(d.mediaSource,e)))return!1;c=d;return!0});if(!c||!c.mediaSource)return null;var d=Fl(c.mediaSource);if(!d)return null;var e=Lp(a.h,d);return e?(d=zr(a.l,d))?{he:e,al:d}:null:null},Lr=function(a,b,c,d,e,f,h){var k=null;Zi(a.f.ob(!1),function(a){var b=a.Zb;return b&&null!=b.tabId&&b.tabId==d&&hg(a.mediaSource)?(k=a,!0):!1});if(!k)return null;var m=function(){return a.createRoute(b,h||k.sinkId,
"",e,f,c,null==d?void 0:d)};return Lf(a.terminateRoute(k.id).then(m,m))};g=Cr.prototype;g.connectRouteByRouteId=function(a,b,c,d,e){if(!El(a))return Kf(Error("Unsupported presentation URL"));if(!b)return Kf(Error("No routeId"));b=Hk(b);b=dq(this.l,b.a);if(!b)return Kf(Error("No matching route"));var f=this.a.b(b.sinkId);return f?(a=xq(this,a,f,c,b.session,d,e))?Jf(a):Kf(Error("Failed to create route")):Kf(Error("No sink"))};
g.joinRoute=function(a,b,c,d,e,f){var h=El(a);if(!h)return Kf(Error("Unsupported presentation URL"));if(b==chrome.cast.Ki){a:{var k=Or(this,h);if(!k){if(!this.v||this.v.he.origin!=e||this.v.he.tabId!=f){k=null;break a}k=this.v}switch(Al(h)){case chrome.cast.Ic.PAGE_SCOPED:k=null;break a;case chrome.cast.Ic.ORIGIN_SCOPED:if(e!=k.he.origin){k=null;break a}break;case chrome.cast.Ic.TAB_AND_ORIGIN_SCOPED:if(e!=k.he.origin||f!=k.he.tabId){k=null;break a}}k=dq(this.l,k.al.session.sessionId)}if(!k&&(h.f?
h.f:chrome.cast.Wf.CREATE_SESSION)!=chrome.cast.Wf.CAST_THIS_TAB&&(d=Lr(this,a,e,f,c,d)))return d}else k=Pr(this,b);if(!k)return Kf(Error("No matching route"));if(k.offTheRecord!=c)return Kf(Error("Off the record mismatch"));d=this.a.b(k.sinkId);if(!d)return Kf(Error("No sink"));a=xq(this,a,d,b,k.session,e,f);a.offTheRecord=c;return Jf(a)};g.detachRoute=function(a){gq(this,a,!1,!0)};
g.se=function(a){var b=this.a.b(a);if(!b)throw Error("Cannot mirror with no sink.");var c=new Og;b=b.Mb;b&1||(c.shouldCaptureVideo=!1);b&4||(c.shouldCaptureAudio=!1);c.shouldCaptureAudio&&!c.shouldCaptureVideo&&(c.minLatencyMillis=c.maxLatencyMillis,c.animatedLatencyMillis=c.maxLatencyMillis);c.senderSideLetterboxing=!0;Pg(c);Object.freeze(c);this.j.info(function(){return"Settings for "+a+": "+Ng(c)});if(!c.shouldCaptureAudio&&!c.shouldCaptureVideo)throw Error("Cannot start mirroring without video or audio capture");
return c};g.Gd=function(){return"cast_streaming"};
g.sendRouteMessage=function(a,b,c){var d=this;if(!c)return new Promise(function(a,c){"string"!==typeof b&&c(Error("Cannot send non-string messages via ApiHandler."));c=d.g.b;v(Np,"Received: "+b);var e=JSON.parse(b),f=e.clientId;"client_connect"==e.type?(v(Np,"App "+f),(e=Lp(c.a,f))?(e.a=!0,(c=Wo(c.b,e.routeId))&&c.Ga.resolve(!0)):u(Np,"Client not found "+f)):Mp(c,f)?(c=c.f[e.type])&&c(e):u(Np,"No route for "+f);a()});var e=Aq(this.l,a);if(!e)return Promise.reject(Error("Not managing the route "+a));
var f=this.a.b(e.sinkId);if(!f)return Promise.reject(Error("Sink no longer accessible"));var h=(a=rr(this.h,a))?a.clientId:this.m;return new Promise(function(a){$o(d.u,f,c.namespace,b,h,e.session.transportId).then(a,a)})};g.sendRouteBinaryMessage=function(a){return Promise.reject(Error("Route "+a+" does not support sending binary data."))};g.cf=function(a,b){var c=this.a.b(b);if(!c)return!1;a=Kr(a,c);return(a=Cl(a))&&0!=a.length?mc(a,function(a){return Dn(Jn(c,a))}):!1};
g.fe=function(a,b,c){var d=Er(a);return d&&0!=d.length?b==chrome.cast.Ki?!0:c&&c.mediaSource?(a=Cl(c.mediaSource),mc(a,function(a){return rc(d,a)})):void 0==b||Pr(this,b)?!0:!1:!1};
var Kr=function(a,b,c){return jg(a)||kg(a)?(a={appId:0==(b.Mb&1)?"85CDB22F":"0F5096E8",capabilities:qp(b.Mb)},Bl(new vl([a],void 0,void 0,void 0,c))[0]):a},Er=function(a){var b=[];if(jg(a)||kg(a)){var c=Of();ig(a)&&"ChromeOS"!=c&&"Windows"!=c||b.push("85CDB22F");b.push("0F5096E8")}else(a=Cl(a))&&(b=Cc(b,a));return b},Dr=function(a){var b=El(a);if(!b)return null;a=Er(a);var c=b.v||"";b=b.h;return c&&b?new Ro(a,c,JSON.stringify(b)):null},Pr=function(a,b){return 0==b.indexOf(chrome.cast.bj)?dq(a.l,b.substr(chrome.cast.bj.length)):
Ar(a.l,b)},er=function(a,b,c){var d=a.A;if(hp(d)&&qo.hasOwnProperty(c.namespace_)){var e=b.ab();if(e){var f=JSON.parse(c.data);if("RECEIVER_STATUS"===f.type){var h=f.status&&f.status.applications&&f.status.applications[0],k=f=null;h&&(h.appId&&(f=h.appId),h.sessionId&&(k=h.sessionId));h=d.b.get(e);d.b.set(e,new ep(e,f,k));h&&h.appId===f||ip(d)}}}a=a.g;b=b.getId();qo.hasOwnProperty(c.namespace_)?pq(a,b,c):qq(a,b,c)};
Cr.prototype.B=function(a){if(0==this.a.a.na())this.b.onSinkAvailabilityUpdated(this,0);var b=this.g;a=a.getId();(a=lq(b.a,a))&&a.session&&eq(b,a.session.sessionId);jp(this.A);this.b.Bc()};var $n=function(a,b){a.w.pk(b);jp(a.A);a.b.Bc()};g=Cr.prototype;g.ua=function(){return"cast.Provider"};g.Pa=function(){return[new Qr(this.m,rj(this.f),this.v)]};g.Ta=function(){var a=ih(this);a&&(this.m=a.f,mj(this.f,a.b),this.v=a.a)};g.searchSinks=function(){return hb()};
g.createMediaRouteController=function(a,b,c){return(a=this.g.createMediaRouteController(a,b,c))?Promise.reject(a):Promise.resolve()};g.provideSinks=function(a){Ao(this.a,a)};var vq=function(a){var b=a.Ld().some(function(a){return a.isLocal});a.b.Ke(a.ua(),b)};Cr.prototype.j=kb("mr.CastProvider");var Qr=function(a,b,c){this.f=a;this.b=b;this.a=c};var Rr=function(a,b){this.input=a;this.domain=b};var Sr=function(a){this.a=a;this.j=kb("mr.ExternalMessageHandler")};
Sr.prototype.onMessage=function(a,b,c){var d=this;this.j.info("Received a message from "+b.id+" type: "+a.type);var e=chrome.runtime.id;"start"==a.type?(a=a.message,this.a.searchSinks("pseudo:cloud","urn:x-org.chromium.media:source:desktop",new Rr(a.meetingName,a.domain)).then(function(a){var f="PresentationId"+b.id+Tr++;d.a.createRoute("urn:x-org.chromium.media:source:desktop",a,f).then(function(a){c(new xe(e,"route",a.id))}).catch(function(a){c(new xe(e,"error",a))})},function(){c(new xe(e,"error",
Error("Failed to find sink.")))})):"stop"==a.type?this.a.terminateRoute(a.message.routeId).then(function(){c(new xe(e,"stopped"))}):"subscribe_log_data"==a.type?(mb.push(function(a){chrome.runtime.sendMessage(b.id,new xe(e,"log_message",a))}),c(new xe(e,"subscribed"))):(c(new xe(e,"error",Error("Unhandled message type"))),this.j.error("Unhandled message type "+a.type))};var Tr=0;var Ur=function(){this.a=[];this.b=[]},Vr=function(a,b){if(1E3<=a.na()){if(a.Yb())throw Error("Empty queue");0==a.a.length&&(a.a=a.b,a.a.reverse(),a.b=[]);a.a.pop()}a.b.push(b)};Ur.prototype.na=function(){return this.a.length+this.b.length};Ur.prototype.Yb=function(){return 0==this.na()};Ur.prototype.X=function(){var a=this.a.slice();a.reverse();a.push.apply(a,[].concat(l(this.b)));return a};Ur.prototype.clear=function(){this.a=[];this.b=[]};var Wr=function(){this.a=new Ur;this.b=Date.now()},Yr=function(){null==Xr&&(Xr=new Wr);return Xr};Wr.prototype.init=function(){lb=1;var a=kb("browser"),b=window.onerror;window.onerror=function(c,e,f,h,k){b&&b(c,e,f,h,k);a.error("Error: "+c+" ("+e+" @ Line: "+f+")",k)};mb.push(this.g.bind(this));var c=window.localStorage["debug.logs"];c&&(lb=rb(c.toUpperCase()));window.localStorage["debug.console"]&&mb.push(this.f.bind(this))};
Wr.prototype.g=function(a){Vr(this.a,Zr(this,a,!1));a=a.Oc;a instanceof Error&&a.stack&&Vr(this.a,a.stack)};Wr.prototype.f=function(a){var b=[Zr(this,a,!0)];a.Oc&&b.push(a.Oc);switch(a.level){case 3:console.error.apply(console,[].concat(l(b)));break;case 2:console.warn.apply(console,[].concat(l(b)));break;case 1:console.log.apply(console,[].concat(l(b)));break;default:console.debug.apply(console,[].concat(l(b)))}};
var Zr=function(a,b,c){var d=["["];if(c)d.push(("       "+((Date.now()-a.b)/1E3).toFixed(3)).slice(-7));else{a=new Date(b.time);var e=function(a){return 10>a?"0"+a:a};d.push(a.getFullYear().toString(),"-",e(a.getMonth()+1),"-",e(a.getDate())," ",e(a.getHours()),":",e(a.getMinutes()),":",e(a.getSeconds()),".",e(Math.floor(a.getMilliseconds()/10)))}d.push("][",qb[b.level],"][",b.H,"] ",b.message);if(!c&&null!=b.Oc)if(d.push("\n"),b.Oc instanceof Error)d.push(b.Oc.message);else try{d.push(JSON.stringify(b.Oc))}catch(f){d.push(b.Oc.toString())}d.push("\n");
return d.join("")},$r=function(){var a=Yr();return 0==a.a.na()?"NA":a.a.X().join("")},as=function(){var a=Yr();lh(a)};Wr.prototype.ua=function(){return"LogManager"};Wr.prototype.Pa=function(){return[this.a.X()]};Wr.prototype.Ta=function(){var a=this.a.X();this.a.clear();for(var b=la(ih(this)||[]),c=b.next();!c.done;c=b.next())Vr(this.a,c.value);a=la(a);for(c=a.next();!c.done;c=a.next())Vr(this.a,c.value)};var Xr=null;var bs=function(a){this.a=a;this.j=kb("mr.InternalMessageHandler")};
bs.prototype.onMessage=function(a,b,c){var d=this;if("retrieve_log_data"!=a.type)c(new xe(chrome.runtime.id,"error",Error("Unhandled message type")));else{var e={logs:$r(),device:pm()};b=[];var f=Ce(e.device.ip).then(function(a){a.a&&(e.device.version=a.a)});b.push(f);var h=this.a.m;h&&(a=cs(this,h,a.source).then(function(a){a&&(e.castStreamingLogs=a)},function(){d.j.error("Log upload failed for service: "+h)}),b.push(a));b.push(ds(this,e,"mr.cast.SinkDiscoveryService","castDeviceCounts"));b.push(ds(this,
e,"mr.dial.SinkDiscoveryService","dialDeviceCounts"));Am(b).then(function(){c(e)})}};var ds=function(a,b,c,d){return tg(c).then(function(a){a=a.Mj();b[d]=a.ld+"."+a.dd},function(){a.j.error("Failed to get device counts for "+d+".")})},cs=function(a,b,c){return es(a.a,b).then(function(a){return a.Xh(c)})};var fs=function(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];d=a;c=la(c);for(var e=c.next();!e.done;e=c.next()){if(void 0==d||"object"!=typeof d)return;d=d[e.value]}return d};var gs=function(){Mk.call(this,5,"cloud.GcmEventListener","mr.cloud.discovery.CloudSinkDiscoveryService",chrome.gcm.onMessage);this.j=kb("mr.CloudGcmEventListener")};Fa(gs,Mk);gs.prototype.Xg=function(a){a=fs(a,"data","notification");if(!a)return this.j.error("Notification json not found"),!1;try{var b=JSON.parse(a);return!!b&&Array.isArray(b.events)&&0<b.events.length}catch(c){return this.j.error("Invalid json: "+a),!1}};var is=function(){hs||(hs=new gs);return hs},hs=null;var js={ACCEPTED:0,Fr:1,TIMEOUT:2},ks={SUCCESS:0,Jl:1},ls={Vm:0,om:1,Ov:2,vs:3,us:4,tt:5,TIMEOUT:6,tu:7},ms={ss:0,kv:1},ns={Zt:0,dt:1,USER:2,ns:3},os=function(a){Eb("MediaRouter.Cloud.Knock.Result",a,js)},ps=function(a){Eb("MediaRouter.Cloud.Session.Start",a,ks)},qs=function(a){Eb("MediaRouter.Cloud.Session.Type",a,ms)},rs=function(a){Eb("MediaRouter.Cloud.Device.UserRole",a,ns)};var ws=function(a,b){this.f=a;this.v=b;this.h=new Ib;this.a=this.h.a;this.l=ss(a.id);this.b=new Ib;this.g=!1;ts(this);us(this);vs(this,new Qg("GET_TURN_CREDENTIALS"))};ws.prototype.start=function(){var a=this;return this.a.then(function(b){if(b.b)return Promise.reject(Error("Presentation already started"));b.start();return a.b.a})};ws.prototype.stop=function(){var a=this;this.g=!1;return this.a.then(function(b){b.stop();a.a=Promise.reject(Error("Peer connection has already been stopped"))})};
var ts=function(a){a.l.onMessage=function(b){if(b.type)switch(b.type){case "TURN_CREDENTIALS":a.h.resolve(new Vg(a.f.id,b.data.credentials));break;case "ANSWER":a.a.then(function(a){ch(a,b.data)});break;case "STOP":a.b.reject("Stop signal received");a.stop();break;default:throw Error("Unknown message type: "+b.type);}else a.a.then(function(a){var c={type:"PRESENTATION_CONNECTION_MESSAGE",data:b};"string"==typeof c?a.l.send(c):a.l.send(JSON.stringify(c))})}},us=function(a){a.a.then(function(b){Zg(b,
function(b){vs(a,new Qg("OFFER",new Sg(b,null,null,a.v,a.f.id)))});$g(b,function(b){b=Rg(b);"STOP"==b.type&&a.stop();vs(a,b)});Wg(b,function(){a.g=!0;vs(a,new Qg("SESSION_START_SUCCESS"));a.b.resolve(a.f)});Yg(b,function(){vs(a,new Qg("SESSION_END"))});Xg(b,function(b){a.g||a.b.reject(b);vs(a,new Qg("SESSION_FAILURE"))})})},vs=function(a,b){a.l.sendMessage(b,xs)},xs={channelType:"cloud"};var ys=function(a,b,c,d,e,f){c=void 0===c?null:c;a||null==c&&(c="default");this.dk=a;this.Ka=b;this.Xb=c;this.De=void 0===d?null:d;this.uc=void 0===e?null:e;this.Td=void 0===f?null:f};ys.prototype.b=function(){var a="";this.uc?a=this.uc:this.De&&(a=this.De);return a};ys.prototype.tc=function(){return this.dk};ys.prototype.getId=function(){return this.Ka};ys.prototype.merge=function(a){!this.Td&&a.Td&&(this.Td=a.Td);!this.uc&&a.uc&&(this.uc=a.uc);this.uc&&a.uc&&this.Td&&(this.uc=a.uc)};var zs=function(a,b){this.a=a;this.b=b},As=new zs("https://www.googleapis.com/clouddevices/v1","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA"),Bs=new zs("https://www.googleapis.com/calendar/v3",""),Cs=new zs("https://www.googleapis.com/hangouts/v1",""),Ds=new zs("https://networktraversal.googleapis.com/v1alpha","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA");var Es=function(a,b){this.b=a;this.f=b;this.j=kb("mr.cloud.calendar.CalendarService")},Is=function(a){return Fs(a,a.f.a).then(function(b){a.j.info(Gs(b.length)+" events discovered before filtering.");return Hs(a,b)},function(b){u(a.j,"Error getting Hangouts from calendar.",b);return[]})},Gs=function(a){return 20<a?"20+":a.toString()},Fs=function(a,b){var c=Date.now();return Js(a,b,new Date(c),new Date(c+9E5)).then(function(b){return b.filter(a.a)})};
Es.prototype.a=function(a){return!(!a.start||!a.end||a.start.date||a.end.date||!a.start.dateTime||!a.end.dateTime)};
var Js=function(a,b,c,d){b=Ks(Bs.a,["calendars",b,"events"],{timeMin:c.toJSON(),timeMax:d.toJSON(),singleEvents:!0});v(a.j,"Retrieving Hangouts from Calendar: "+b);return Ls(a.b,b,"GET").then(function(a){return a.items?a.items:[]})},Hs=function(a,b){var c=[];b.filter(function(a){return a.hangoutLink}).forEach(function(b){var d=new cl(b.hangoutLink);if("meet.google.com"==d.Xb)c.push(new ys(!0,d.a.substring(1),void 0,void 0,b.summary));else if(d=d.a.substring(12).split("/"),2==d.length){var f=la(d);
d=f.next().value;f=f.next().value;if(-1!=d.indexOf(".")){var h=f;var k=d}c.push(new ys(!1,f+"@"+d,k,h,b.summary,void 0))}else u(a.j,"Invalid hangout link from calendar event: "+b.hangoutLink)});a.j.info(Gs(c.length)+" events discovered with Hangout links.");return c};var Ms=function(a){this.email=a;this.imageUrl=null},Ns=function(a){this.type=a},Os=function(a,b,c,d){this.type="__cloud_webrtc_session_message__";this.sessionDescription=a;this.user=b||null;this.flungUrl=c||null;this.presentationId=d||null};Fa(Os,Ns);
var Ps=function(a,b,c){this.name=a;this.parameters=b;this.minimalRole=null!=c?c:"user"},Qs={_settings:{type:"string"},_presentationRequest:{type:"string"},_optMediaConstraints:{type:"string"},_webrtcMessage:{type:"string"},_user:{type:"string"}},Rs=new Ps("_knockingStartWebrtcSession",Qs,"viewer"),Ss=new Ps("_startWebrtcSession",Qs),Ts=new Ps("_stopSession",{},"viewer");var Us=function(a){this.a=a;this.id=a.id;this.j=kb("mr.cloud.devices.CloudDevice")};Us.prototype.isAvailable=function(){if(this.getState().appStatus){var a="online"==this.a.connectionStatus,b="available"==this.getState().appStatus,c=Vs(this,864E5);v(this.j,"Device id: "+this.id+", availability: GCM connected "+a+", app Available: "+b+", checked in: "+c);return a&&b&&c}a=Vs(this,9E5);this.j.info("Availability for legacy receiver app: "+a);return a};
var Vs=function(a,b){a=a.a.lastUpdateTimeMs?Number(a.a.lastUpdateTimeMs):null;return!!(a&&a>Date.now()-b)};Us.prototype.b=function(){return this.getState().settings.receiverName};Us.prototype.getId=function(){return this.id};Us.prototype.getState=function(){return this.a.state._cloudCast};var Ws=function(a){this.h=a;this.b=this.f=this.a=null;this.l=this.g=!1;this.j=kb("mr.cloud.devices.CloudDevicesService");lh(this)};Ws.prototype.getDevice=function(a){a=Ks(As.a,["devices",a]);return Ls(this.h,a,"GET").then(function(a){return new Us(a)})};
var Xs=function(a,b){var c=Ks(As.a,["devices"],b);return Ls(a.h,c,"GET").then(function(c){var d=(c.devices||[]).filter(function(a){return null!=a.commandDefs&&null!=a.commandDefs._cloudCast}).map(function(a){return new Us(a)});if(c=c.nextPageToken){var f=cd(b);f.token=c;return Xs(a,f).then(function(a){return d.concat(a)})}return d})};Ws.prototype.ua=function(){return"CloudDevicesService"};Ws.prototype.Pa=function(){return[new Ys(this.a,this.b,this.f)]};
Ws.prototype.Ta=function(){var a=ih(this);a&&(this.a=a.ho,this.b=a.gcmRegistrationId,this.f=a.fo)};
var Zs=function(a){return new Promise(function(b,c){a.g?c(Error("Registering...")):(a.g=!0,a.b&&a.f&&a.f+864E5>=Date.now()?(a.g=!1,b(a.b)):chrome.gcm.register(["919648714761"],function(d){a.g=!1;d?(v(a.j,"Got GCM ID: "+d),a.b=d,a.f=Date.now(),a.a=null,b(d)):(u(a.j,"Error: "+chrome.runtime.lastError.message),a.b=null,a.f=null,a.a=null,c(Error(chrome.runtime.lastError.message)))}))})},$s=function(a,b){if(a.l)Promise.resolve();else if(a.l=!0,b&&(!a.a||a.a+864E5<Date.now())){b={filters:["myDevices"],
gcmRegistrationId:b,gcmSenderId:"919648714761",expirationTimeMs:864E5};var c=Ks(As.a,["subscriptions","subscribe"],{});Ls(a.h,c,"POST",b).then(function(){v(a.j,"Subscribed on: "+Date.now());a.a=Date.now();a.l=!1;return Promise.resolve()},function(b){a.l=!1;throw b;})}else Promise.resolve()},Ys=function(a,b,c){this.ho=a;this.gcmRegistrationId=b;this.fo=c};var at=function(a,b,c,d,e,f,h){var k=om(nm(),a);this.Ua=new Bm(k,b,f,h,e);this.deviceId=a;this.a=c;this.model=d},bt=function(a,b,c,d,e){at.call(this,a,b,["cloud"],"Chrome Streaming Receiver",d,"education");this.fh=c;this.isAvailable=e};Fa(bt,at);var ct=function(a){var b=a.Xb,c;a.De&&a.b()!=a.De&&(c=a.De);at.call(this,a.getId(),a.b(),["mesi"],"Hangout",b,a.tc()?"meeting":"hangout",c);this.tc=a.tc();this.Sd=a.Td||""};Fa(ct,at);var dt=function(a){this.a=a;this.j=kb("mr.cloud.messaging.GcmMessageHandler")};dt.prototype.onMessage=function(a){var b=this;a=JSON.parse(a.data.notification);var c=nm();a.events.forEach(function(a){if(a.deviceId){var d=om(c,a.deviceId);switch(a.type){case "deviceCreated":et(b,a);break;case "deviceUpdated":ft(b,a,d);break;case "deviceDeleted":gt(b.a,{sinkId:d});break;default:v(b.j,function(){return"[unhandled event] "+JSON.stringify(a)})}}else b.j.error("Device ID not provided")})};
var et=function(a,b){var c=fs(b,"statePatch","_cloudCast","settings","receiverName");"string"!=typeof c?a.j.error("Receiver name not a string: "+c):(b=new bt(b.deviceId,c,"owner","default",!0),a=a.a,a.a.a.set(b.Ua.id,b),a.a.b=Date.now(),ht(a.f,[b.Ua]))},ft=function(a,b,c){b=fs(b,"statePatch","_cloudCast","appStatus");if("string"!=typeof b)a.j.error("App status not a string: "+b);else if(a=a.a,b="available"==b,c=a.a.Od(c))c.isAvailable=b,a.a.b=Date.now(),it(a.f,[c.Ua])};var jt=function(a,b){this.l=a;this.g=b;this.a=new Map;this.f=new Map;this.b=null};jt.prototype.Fe=function(){var a=this.b+2E4;if(null==this.b||a<Date.now())this.b=Date.now(),kt(this);return Array.from(this.a.values())};jt.prototype.Od=function(a){return this.a.get(a)||null};
var kt=function(a){a.l().then(function(b){lt(a,b)})},lt=function(a,b){var c=new Map(a.a),d=new Map,e=new Map,f=[],h=[];b.forEach(function(a){var b=a.Ua.id;d.set(b,a);e.set(b,a.deviceId);c.has(b)?c.has(b)&&JSON.stringify(c.get(b))!=JSON.stringify(a)&&h.push(a.Ua):f.push(a.Ua);c.delete(b)});b=[].concat(l(c.values())).map(function(a){return a.Ua});a.f.clear();a.f=e;a.a.clear();a.a=d;mt(a,f,h,b)},mt=function(a,b,c,d){0<b.length&&ht(a.g,b);0<c.length&&it(a.g,c);0<d.length&&nt(a.g,d)},pt=function(a){for(var b=
{},c=la(a.a.entries()),d=c.next();!d.done;d=c.next()){var e=la(d.value);d=e.next().value;e=e.next().value;b[d]=e}c={};d=la(a.f.entries());for(e=d.next();!e.done;e=d.next()){var f=la(e.value);e=f.next().value;f=f.next().value;c[e]=f}return new ot(b,c,a.b)},qt=function(a,b){for(var c in b.sinks){var d=b.sinks[c],e=null;"Hangout"==d.model?e=new ct(new ys(d.tc,d.deviceId,d.Ua.domain,d.Ua.description,d.Ua.friendlyName,d.Sd)):"Chrome Streaming Receiver"==d.model&&(e=new bt(d.deviceId,d.Ua.friendlyName,
d.fh,d.Ua.domain,d.isAvailable));a.a.set(c,e)}for(c in b.a)a.f.set(c,b.a[c]);b.b&&(a.b=b.b)},ot=function(a,b,c){this.sinks=a;this.a=b;this.b=c};var rt=function(a,b){this.b=a;this.f=b;this.a=new jt(this.qo.bind(this),b);this.g=new dt(this);is().addListener();lh(this);zg("mr.cloud.discovery.CloudSinkDiscoveryService",this)};Fa(rt,pg);g=rt.prototype;g.Fe=function(){var a=this;Zs(this.b).then(function(b){$s(a.b,b)},function(){});return this.a.Fe().filter(function(a){return a.isAvailable})};g.Od=function(a){return this.a.Od(a)};
g.handleEvent=function(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];if(a==chrome.gcm.onMessage)this.g.onMessage.apply(this.g,[].concat(l(c)));else throw Error("Unhandled event: expected chrome.gcm.onMessage");};
g.qo=function(){return Xs(this.b,{descriptionSubstring:"Chrome Streaming Receiver"}).then(function(a){return a.map(function(a){Db("MediaRouter.Cloud.CloudReceiver.Sink.Discovered");var b=a.isAvailable()&&!(a.a.invitations&&0!=a.a.invitations.length);return new bt(a.getId(),a.b(),a.a.personalizedInfo.maxRole,"default",b)})})};g.ua=function(){return"CloudSinkDiscoveryService"};g.Pa=function(){return[{cache:pt(this.a)}]};g.Ta=function(){var a=ih(this);a&&qt(this.a,a.cache)};
var gt=function(a,b){if(b=a.a.Od(b.sinkId))a.a.a.delete(b.Ua.id),a.a.b=Date.now(),nt(a.f,[b.Ua])};var ut=function(a,b,c){if(!st){ji();var d=ii;d.xg=ei;var e=tt;d.tf||(d.tf=[]);d.tf.push(e);st=!0}this.f=a;this.g=b;this.a=new jt(this.l.bind(this),c);this.b=new Map;lh(this)},tt=function(a){nb({H:a.f,level:sb(a.b.value),time:a.l,message:a.getMessage(),Oc:a.a})};ut.prototype.Fe=function(){return this.a.Fe()};ut.prototype.Od=function(a){return this.a.Od(a)};
ut.prototype.l=function(){var a=this;this.j.info("Fetching hangouts");return Am([vt(this.g),Is(this.f)]).then(function(b){var c=Array.from(a.b.values());b.forEach(function(b){b.Ed?c=c.concat(b.value):a.j.error("Error discovering Hangouts",b.reason)});var d=c.reduce(function(a,b){var c=a[b.getId()];c?c.merge(b):c=b;a[c.getId()]=c;return a},{});return Object.keys(d).map(function(a){a=d[a];Db("MediaRouter.Cloud.Hangout.Sink.Discovered");return new ct(a)})})};
var xt=function(a,b){return tg("mr.mirror.hangouts.MeetingsService").then(function(a){return a.dc(b)}).then(function(b){return wt(a,b)},function(){return b.input.match(/^#/)?Promise.reject(Error("Failed to resolve meeting alias.")):wt(a,b.input,b.domain)})},wt=function(a,b,c){c=c||void 0;var d=!c;b=new ys(d,d?b:b+"@"+c,c,b,void 0,void 0);a.b.set(b.getId(),b);b=new ct(b);a.a.a.set(b.Ua.id,b);return b.Ua};ut.prototype.ua=function(){return"HangoutSinkDiscoveryService"};
ut.prototype.Pa=function(){for(var a={},b=la(this.b.entries()),c=b.next();!c.done;c=b.next()){var d=la(c.value);c=d.next().value;d=d.next().value;a[c]=d}return[{cache:pt(this.a),manualHangouts:a}]};ut.prototype.Ta=function(){var a=ih(this);if(a){qt(this.a,a.cache);for(var b in a.manualHangouts){var c=a.manualHangouts[b];this.b.set(b,new ys(c.dk,c.Ka,c.Xb,c.De,c.uc,c.Td))}}};ut.prototype.j=kb("mr.cloud.discovery.HangoutSinkDiscoveryService");var st=!1;var yt=function(a,b,c,d,e,f,h,k){this.a=null;this.s=!1;this.m=ad();this.b=[];this.u=a?encodeURIComponent(String(a)):null;this.w=null;!d&&b&&(this.w=b);this.B=c||null;this.f=!d;this.g=null!=e?e:null;this.h=f||null;this.R=!!h;this.A=k||null};t(yt,li);var zt;var At=od("https://apis.google.com/js/client.js");At instanceof nd&&At.constructor===nd&&At.b===ld?zt=At.a:(ec("expected object of type Const, got '"+At+"'"),zt="type_error:Const");var Bt=Ad(zt);
yt.prototype.init=function(){var a=p(function(a){this.a=a;var b=Ma("auth",a);Ma("client.request",a)&&b?this.I():a.load("client",p(this.I,this))},this),b=Ct("gapi");b?a(b.gapi):Dt(this,a);return this.m.O};
var Ct=function(a){for(var b=window,c=Ma(a,b);!c&&b!=window.top&&Et(b.parent,a);)b=b.parent,c=Ma(a,b);return c?b:null},Et=function(a,b){try{return!!a&&null!=a.location.href&&Wd(a,b)}catch(c){return!1}},Dt=function(a,b){var c=Ct("gapi_onload");if(c){var d=c.gapi_onload;c.gapi_onload=function(){d();b(c.gapi)}}else{window.gapi_onload=function(){b(window.gapi)};var e=document.createElement("SCRIPT");e.src=zd(Bt);a.A&&Le(e,bj(a.A));document.getElementsByTagName("head")[0].appendChild(e)}};
yt.prototype.I=function(){for(var a=0;a<this.b.length;a++)this.b[a].Ga.resolve(Ft(this,this.b[a].requestData));this.s=!0;this.m.resolve(this.a)};yt.prototype.sendRequest=function(a){if(this.s)return Ft(this,a);var b=ad();this.b.push({requestData:a,Ga:b});return b.O};
var Ft=function(a,b){var c,d=Ma("config.get",a.a);if(!a.f){var e=d("googleapis.config/auth/useFirstPartyAuth");var f=d("googleapis.config/auth/useOriginToken")}null!=a.g&&(c=d("client/cors"));try{var h=Ma("config.update",a.a);a.f||(h("googleapis.config/auth/useFirstPartyAuth",!1),h("googleapis.config/auth/useOriginToken",!1));null!=a.g&&h("client/cors",a.g);var k=Ma("client.request",a.a),m=Gt(a);b.headers&&gd(m,b.headers);var r={headers:m,root:a.B,path:b.path,method:b.method,body:b.body},y=b.params||
{};a.u&&!a.h?gd(y,{key:a.u}):a.h&&gd(y,{key:null});Zc(y)||(r.params=y);var A=Hj(k(r));b.callback&&A.then(function(a){b.callback.apply(null,[a.result,a])},function(a){b.callback.apply(null,[a.result,a])});return A}finally{h=Ma("config.update",a.a),a.f||(h("googleapis.config/auth/useFirstPartyAuth",e),h("googleapis.config/auth/useOriginToken",f)),null!=a.g&&h("client/cors",c)}},Gt=function(a){if(a.f){if(a.h)return{Authorization:"Bearer "+a.h};var b=Ma("auth.getAuthHeaderValueForFirstParty",a.a);return{Authorization:a.R?
b([]):b(),"X-Goog-AuthUser":a.w}}return{}};var Ht=function(a){this.a=a},Ks=function(a,b,c){var d="";b.forEach(function(a){d+="/"+encodeURIComponent(a)});a=new cl(a+d);c&&(c=tl(c),fl(a,c));return a},Ls=function(a,b,c,d){return a.a.getAuthToken().then(function(e){var f=It(e);return Jt(f,b,c,d).catch(function(f){if("INVALID_ACCESS_ERROR"==f)return Kt(a,e,b,c,d);throw f;})})},Kt=function(a,b,c,d,e){return Lt(b).then(function(){return Ls(a,c,d,e)})},Jt=function(a,b,c,d){return new Promise(function(e,f){a.sendRequest(Mt(b,c,function(a){a&&!a.error?
e(a):a&&401==a.error.code?f("INVALID_ACCESS_ERROR"):f(a&&a.error?a.error.errors?a.error.errors[0]:a:Error(a))},d))})},It=function(a){a=new yt(void 0,void 0,void 0,!1,!1,a);a.init();return a},Mt=function(a,b,c,d){a={callback:c,method:b,path:a.toString()};d&&(a.body=d);return a};var Pt=function(){this.b=!1;this.a=null;this.f=!1;this.j=kb("mr.cloud.identity.IdentityService");lh(this);Nt(this);Ot(this)},Qt=function(a){return a.a?a.a.substr(a.a.indexOf("@")+1):""};Pt.prototype.getAuthToken=function(){return chrome.identity?new Promise(function(a,b){chrome.identity.getAuthToken({interactive:!1},function(c){chrome.runtime.lastError?b(Error("Unable to get user auth token: "+chrome.runtime.lastError.message)):null==c?b(Error("User is not logged in (no token found)")):a(c)})}):Promise.reject(Error("chrome.identity permission required for auth."))};
var Lt=function(a){return new Promise(function(b){chrome.identity.removeCachedAuthToken({token:a},function(){b()})})},Ot=function(a){a.getAuthToken().then(function(b){chrome.identity.getProfileUserInfo(function(c){a.b=!!c.email||!!c.id;a.a=c.email||null;b&&!a.b&&(a.f=!0)})},function(b){v(a.j,"Unable to set sign in and email.",b)})},Nt=function(a){chrome.identity.onSignInChanged.addListener(function(b,c){gg(6);a.b=c;a.j.info("Signed in change: "+a.b);a.b?Ot(a):(a.a=null,a.f=!1)})},Rt=function(a){return a.getAuthToken().then(function(b){var c=
window.gapi;if(!c)return a.j.error("gapi not loaded."),!1;a.j.info("Setting gapi auth token");c.auth.setToken({access_token:b});return!0})};Pt.prototype.ua=function(){return"IdentityService"};Pt.prototype.Pa=function(){return[null,{signedIn:this.b,userEmail:this.a,kioskAuth:this.f}]};Pt.prototype.Ta=function(){var a=jh(this);a&&(a.signedIn&&(this.b=a.signedIn),a.userEmail&&(this.a=a.userEmail),a.kioskAuth&&(this.f=a.kioskAuth))};var St="cloudview.test@gmail.com castouts.qa.nohangouts@gmail.com castouts.qa@gmail.com castouts-qa.com castouts-test.com google.com youtube.com nest.com waze.com netflix.com twitter.com yahoo.com salesforce.com whirlpool.com nytimes.com kohls.com squareup.com ivci.com".split(" ");var Tt={ur:{1E3:{other:"0K"},1E4:{other:"00K"},1E5:{other:"000K"},1E6:{other:"0M"},1E7:{other:"00M"},1E8:{other:"000M"},1E9:{other:"0B"},1E10:{other:"00B"},1E11:{other:"000B"},1E12:{other:"0T"},1E13:{other:"00T"},1E14:{other:"000T"}},tr:{1E3:{other:"0 thousand"},1E4:{other:"00 thousand"},1E5:{other:"000 thousand"},1E6:{other:"0 million"},1E7:{other:"00 million"},1E8:{other:"000 million"},1E9:{other:"0 billion"},1E10:{other:"00 billion"},1E11:{other:"000 billion"},1E12:{other:"0 trillion"},1E13:{other:"00 trillion"},
1E14:{other:"000 trillion"}}},Ut=Tt;Ut=Tt;var Vt={AED:[2,"dh","\u062f.\u0625.","DH"],ALL:[0,"Lek","Lek"],AUD:[2,"$","AU$"],BDT:[2,"\u09f3","Tk"],BGN:[2,"lev","lev"],BRL:[2,"R$","R$"],CAD:[2,"$","C$"],CDF:[2,"FrCD","CDF"],CHF:[2,"CHF","CHF"],CLP:[0,"$","CL$"],CNY:[2,"\u00a5","RMB\u00a5"],COP:[32,"$","COL$"],CRC:[0,"\u20a1","CR\u20a1"],CZK:[50,"K\u010d","K\u010d"],DKK:[50,"kr.","kr."],DOP:[2,"RD$","RD$"],EGP:[2,"\u00a3","LE"],ETB:[2,"Birr","Birr"],EUR:[2,"\u20ac","\u20ac"],GBP:[2,"\u00a3","GB\u00a3"],HKD:[2,"$","HK$"],HRK:[2,"kn","kn"],HUF:[34,
"Ft","Ft"],IDR:[0,"Rp","Rp"],ILS:[34,"\u20aa","IL\u20aa"],INR:[2,"\u20b9","Rs"],IRR:[0,"Rial","IRR"],ISK:[0,"kr","kr"],JMD:[2,"$","JA$"],JPY:[0,"\u00a5","JP\u00a5"],KRW:[0,"\u20a9","KR\u20a9"],LKR:[2,"Rs","SLRs"],LTL:[2,"Lt","Lt"],MNT:[0,"\u20ae","MN\u20ae"],MVR:[2,"Rf","MVR"],MXN:[2,"$","Mex$"],MYR:[2,"RM","RM"],NOK:[50,"kr","NOkr"],PAB:[2,"B/.","B/."],PEN:[2,"S/.","S/."],PHP:[2,"\u20b1","PHP"],PKR:[0,"Rs","PKRs."],PLN:[50,"z\u0142","z\u0142"],RON:[2,"RON","RON"],RSD:[0,"din","RSD"],RUB:[50,"\u20bd",
"RUB"],SAR:[2,"Rial","Rial"],SEK:[50,"kr","kr"],SGD:[2,"$","S$"],THB:[2,"\u0e3f","THB"],TRY:[2,"\u20ba","TRY"],TWD:[2,"NT$","NT$"],TZS:[0,"TSh","TSh"],UAH:[2,"\u0433\u0440\u043d.","UAH"],USD:[2,"$","US$"],UYU:[2,"$","$U"],VND:[48,"\u20ab","VN\u20ab"],YER:[0,"Rial","Rial"],ZAR:[2,"R","ZAR"]};var Wt={Li:".",Yg:",",Zi:"%",eh:"0",am:"+",Ti:"-",Pi:"E",aj:"\u2030",Zg:"\u221e",Wl:"NaN",zl:"#,##0.###",Wu:"#E0",ku:"#,##0%",Cr:"\u00a4#,##0.00",Mi:"USD"},Xt=Wt;Xt=Wt;var Zt=function(){this.w=40;this.b=1;this.u=3;this.A=this.l=0;this.R=!1;this.s=this.v="";this.f=Xt.Ti;this.m="";this.a=1;this.h=!1;this.g=[];this.I=this.B=!1;var a=Xt.zl;a.replace(/ /g,"\u00a0");var b=[0];this.v=Yt(this,a,b);for(var c=b[0],d=-1,e=0,f=0,h=0,k=-1,m=a.length,r=!0;b[0]<m&&r;b[0]++)switch(a.charAt(b[0])){case "#":0<f?h++:e++;0<=k&&0>d&&k++;break;case "0":if(0<h)throw Error('Unexpected "0" in pattern "'+a+'"');f++;0<=k&&0>d&&k++;break;case ",":0<k&&this.g.push(k);k=0;break;case ".":if(0<=
d)throw Error('Multiple decimal separators in pattern "'+a+'"');d=e+f+h;break;case "E":if(this.I)throw Error('Multiple exponential symbols in pattern "'+a+'"');this.I=!0;this.A=0;b[0]+1<m&&"+"==a.charAt(b[0]+1)&&(b[0]++,this.R=!0);for(;b[0]+1<m&&"0"==a.charAt(b[0]+1);)b[0]++,this.A++;if(1>e+f||1>this.A)throw Error('Malformed exponential pattern "'+a+'"');r=!1;break;default:b[0]--,r=!1}0==f&&0<e&&0<=d&&(f=d,0==f&&f++,h=e-f,e=f-1,f=1);if(0>d&&0<h||0<=d&&(d<e||d>e+f)||0==k)throw Error('Malformed pattern "'+
a+'"');h=e+f+h;this.u=0<=d?h-d:0;0<=d&&(this.l=e+f-d,0>this.l&&(this.l=0));this.b=(0<=d?d:h)-e;this.I&&(this.w=e+this.b,0==this.u&&0==this.b&&(this.b=1));this.g.push(Math.max(0,k));this.B=0==d||d==h;c=b[0]-c;this.s=Yt(this,a,b);b[0]<a.length&&";"==a.charAt(b[0])?(b[0]++,1!=this.a&&(this.h=!0),this.f=Yt(this,a,b),b[0]+=c,this.m=Yt(this,a,b)):(this.f+=this.v,this.m+=this.s)};
Zt.prototype.parse=function(a,b){b=b||[0];a=a.replace(/ /g,"\u00a0");var c=a.indexOf(this.v,b[0])==b[0],d=a.indexOf(this.f,b[0])==b[0];c&&d&&(this.v.length>this.f.length?d=!1:this.v.length<this.f.length&&(c=!1));c?b[0]+=this.v.length:d&&(b[0]+=this.f.length);if(a.indexOf(Xt.Zg,b[0])==b[0]){b[0]+=Xt.Zg.length;var e=Infinity}else{e=a;for(var f=!1,h=!1,k=!1,m=-1,r=1,y=Xt.Li,A=Xt.Yg,C=Xt.Pi,Q="";b[0]<e.length;b[0]++){var qa=e.charAt(b[0]),ua=$t(qa);if(0<=ua&&9>=ua)Q+=ua,k=!0;else if(qa==y.charAt(0)){if(f||
h)break;Q+=".";f=!0}else if(qa==A.charAt(0)&&("\u00a0"!=A.charAt(0)||b[0]+1<e.length&&0<=$t(e.charAt(b[0]+1)))){if(f||h)break}else if(qa==C.charAt(0)){if(h)break;Q+="E";h=!0;m=b[0]}else if("+"==qa||"-"==qa){if(k&&m!=b[0]-1)break;Q+=qa}else if(1==this.a&&qa==Xt.Zi.charAt(0)){if(1!=r)break;r=100;if(k){b[0]++;break}}else if(1==this.a&&qa==Xt.aj.charAt(0)){if(1!=r)break;r=1E3;if(k){b[0]++;break}}else break}1!=this.a&&(r=this.a);e=parseFloat(Q)/r}if(c){if(a.indexOf(this.s,b[0])!=b[0])return NaN;b[0]+=
this.s.length}else if(d){if(a.indexOf(this.m,b[0])!=b[0])return NaN;b[0]+=this.m.length}return d?-e:e};
Zt.prototype.format=function(a){if(isNaN(a))return Xt.Wl;var b=[];var c=au;a/=Math.pow(10,c.Hn);b.push(c.prefix);var d=0>a||0==a&&0>1/a;b.push(d?this.f:this.v);if(isFinite(a))if(a=a*(d?-1:1)*this.a,this.I){var e=a;if(0==e)bu(this,e,this.b,b),cu(this,0,b);else{a=Math.floor(Math.log(e)/Math.log(10)+2E-15);var f=Math.pow(10,a);isFinite(f)&&0!==f?e/=f:(f=Math.pow(10,Math.floor(a/2)),e=e/f/f,1==a%2&&(e=0<a?e/10:10*e));f=this.b;if(1<this.w&&this.w>this.b){for(;0!=a%this.w;)e*=10,a--;f=1}else 1>this.b?(a++,
e/=10):(a-=this.b-1,e*=Math.pow(10,this.b-1));bu(this,e,f,b);cu(this,a,b)}}else bu(this,a,this.b,b);else b.push(Xt.Zg);b.push(d?this.m:this.s);b.push(c.cq);return b.join("")};
var bu=function(a,b,c,d){if(a.l>a.u)throw Error("Min value must be less than max value");d||(d=[]);var e=Math.pow(10,a.u);var f=Math.round(b*e);isFinite(f)?(b=Math.floor(f/e),f=Math.floor(f-b*e)):f=0;var h=e=b;b=f;var k=0<a.l||0<b||!1;e=a.l;k&&(e=a.l);var m="";for(f=h;1E20<f;)m="0"+m,f=Math.round(f/10);m=f+m;var r=Xt.Li;f=Xt.eh.charCodeAt(0);var y=m.length,A=0;if(0<h||0<c){for(h=y;h<c;h++)d.push(String.fromCharCode(f));if(2<=a.g.length)for(c=1;c<a.g.length;c++)A+=a.g[c];c=y-A;if(0<c){h=a.g;A=y=0;
for(var C,Q=Xt.Yg,qa=m.length,ua=0;ua<qa;ua++)if(d.push(String.fromCharCode(f+1*Number(m.charAt(ua)))),1<qa-ua)if(C=h[A],ua<c){var cc=c-ua;(1===C||0<C&&1===cc%C)&&d.push(Q)}else A<h.length&&(ua===c?A+=1:C===ua-c-y+1&&(d.push(Q),y+=C,A+=1))}else{c=m;m=a.g;h=Xt.Yg;C=c.length;Q=[];for(y=m.length-1;0<=y&&0<C;y--){A=m[y];for(qa=0;qa<A&&0<=C-qa-1;qa++)Q.push(String.fromCharCode(f+1*Number(c.charAt(C-qa-1))));C-=A;0<C&&Q.push(h)}d.push.apply(d,Q.reverse())}}else k||d.push(String.fromCharCode(f));(a.B||k)&&
d.push(r);k=String(b);b=k.split("e+");if(2==b.length){if(k=parseFloat(b[0])){r=k;if(isFinite(r)){for(c=0;1<=(r/=10);)c++;r=c}else r=0<r?r:0;r=0-r-1;-1>r?(r=Math.pow(10,1),k=Math.round(k/r)*r):(r=Math.pow(10,r),k=Math.round(k*r)/r)}k=String(k);k=k.replace(".","");k+=Tb("0",parseInt(b[1],10)-k.length+1)}a.u+1>k.length&&(k="1"+Tb("0",a.u-k.length)+k);for(a=k.length;"0"==k.charAt(a-1)&&a>e+1;)a--;for(h=1;h<a;h++)d.push(String.fromCharCode(f+1*Number(k.charAt(h))))},cu=function(a,b,c){c.push(Xt.Pi);0>
b?(b=-b,c.push(Xt.Ti)):a.R&&c.push(Xt.am);b=""+b;for(var d=Xt.eh,e=b.length;e<a.A;e++)c.push(d);c.push(b)},$t=function(a){a=a.charCodeAt(0);if(48<=a&&58>a)return a-48;var b=Xt.eh.charCodeAt(0);return b<=a&&a<b+10?a-b:-1},Yt=function(a,b,c){for(var d="",e=!1,f=b.length;c[0]<f;c[0]++){var h=b.charAt(c[0]);if("'"==h)c[0]+1<f&&"'"==b.charAt(c[0]+1)?(c[0]++,d+="'"):e=!e;else if(e)d+=h;else switch(h){case "#":case "0":case ",":case ".":case ";":return d;case "\u00a4":c[0]+1<f&&"\u00a4"==b.charAt(c[0]+1)?
(c[0]++,d+=Xt.Mi):d+=Vt[Xt.Mi][1];break;case "%":if(!a.h&&1!=a.a)throw Error("Too many percent/permill");if(a.h&&100!=a.a)throw Error("Inconsistent use of percent/permill characters");a.a=100;a.h=!1;d+=Xt.Zi;break;case "\u2030":if(!a.h&&1!=a.a)throw Error("Too many percent/permill");if(a.h&&1E3!=a.a)throw Error("Inconsistent use of percent/permill characters");a.a=1E3;a.h=!1;d+=Xt.aj;break;default:d+=h}}return d},au={prefix:"",cq:"",Hn:0};var du=function(a){return 1==a%10&&11!=a%100?"one":2==a%10&&12!=a%100?"two":3==a%10&&13!=a%100?"few":"other"},eu=du;eu=du;var fu=function(a,b){if(void 0===b){b=a+"";var c=b.indexOf(".");b=Math.min(-1==c?0:b.length-c-1,3)}return 1==(a|0)&&0==b?"one":"other"},gu=fu;gu=fu;var lu=function(){this.g=hu;this.b=this.a=this.l=null;var a=Xt,b=Ut;if(iu!==a||ju!==b)iu=a,ju=b,ku=new Zt;this.h=ku},iu=null,ju=null,ku=null,mu=/'([{}#].*?)'/g,nu=/''/g;lu.prototype.format=function(a){if(this.g){this.l=[];var b=ou(this,this.g);this.b=pu(this,b);this.g=null}if(this.b&&0!=this.b.length)for(this.a=x(this.l),b=[],qu(this,this.b,a,!1,b),a=b.join("");0<this.a.length;)a=a.replace(this.f(this.a),this.a.pop());else a="";return a};
var qu=function(a,b,c,d,e){for(var f=0;f<b.length;f++)switch(b[f].type){case 4:e.push(b[f].value);break;case 3:var h=b[f].value,k=a,m=e,r=c[h];Ja(r)?(k.a.push(r),m.push(k.f(k.a))):m.push("Undefined parameter - "+h);break;case 2:h=b[f].value;k=e;m=h.gg;Ja(c[m])?(m=h[c[m]],Ja(m)||(m=h.other),qu(a,m,c,d,k)):k.push("Undefined parameter - "+m);break;case 0:h=b[f].value;ru(a,h,c,gu,d,e);break;case 1:h=b[f].value;ru(a,h,c,eu,d,e);break;default:ec("Unrecognized block type: "+b[f].type)}},ru=function(a,b,
c,d,e,f){var h=b.gg,k=b.tj,m=+c[h];isNaN(m)?f.push("Undefined or invalid parameter - "+h):(k=m-k,h=b[c[h]],Ja(h)||(d=a.h.F?d(k,a.h.F()):d(k),h=b[d],Ja(h)||(h=b.other)),b=[],qu(a,h,c,e,b),c=b.join(""),e?f.push(c):(a=a.h.format(k),f.push(c.replace(/#/g,a))))},ou=function(a,b){var c=a.l,d=p(a.f,a);b=b.replace(nu,function(){c.push("'");return d(c)});return b=b.replace(mu,function(a,b){c.push(b);return d(c)})},su=function(a){var b=0,c=[],d=[],e=/[{}]/g;e.lastIndex=0;for(var f;f=e.exec(a);){var h=f.index;
"}"==f[0]?(c.pop(),0==c.length&&(f={type:1},f.value=a.substring(b,h),d.push(f),b=h+1)):(0==c.length&&(b=a.substring(b,h),""!=b&&d.push({type:0,value:b}),b=h+1),c.push("{"))}b=a.substring(b);""!=b&&d.push({type:0,value:b});return d},tu=/^\s*(\w+)\s*,\s*plural\s*,(?:\s*offset:(\d+))?/,uu=/^\s*(\w+)\s*,\s*selectordinal\s*,/,vu=/^\s*(\w+)\s*,\s*select\s*,/,pu=function(a,b){var c=[];b=su(b);for(var d=0;d<b.length;d++){var e={};if(0==b[d].type)e.type=4,e.value=b[d].value;else if(1==b[d].type){var f=b[d].value;
switch(tu.test(f)?0:uu.test(f)?1:vu.test(f)?2:/^\s*\w+\s*/.test(f)?3:5){case 2:e.type=2;e.value=wu(a,b[d].value);break;case 0:e.type=0;e.value=xu(a,b[d].value);break;case 1:e.type=1;e.value=yu(a,b[d].value);break;case 3:e.type=3;e.value=b[d].value;break;default:ec("Unknown block type for pattern: "+b[d].value)}}else ec("Unknown part of the pattern.");c.push(e)}return c},wu=function(a,b){var c="";b=b.replace(vu,function(a,b){c=b;return""});var d={};d.gg=c;b=su(b);for(var e=0;e<b.length;){var f=b[e].value;
e++;if(1==b[e].type)var h=pu(a,b[e].value);else ec("Expected block type.");d[f.replace(/\s/g,"")]=h;e++}return d},xu=function(a,b){var c="",d=0;b=b.replace(tu,function(a,b,e){c=b;e&&(d=parseInt(e,10));return""});var e={};e.gg=c;e.tj=d;b=su(b);for(var f=0;f<b.length;){var h=b[f].value;f++;if(1==b[f].type)var k=pu(a,b[f].value);else ec("Expected block type.");e[h.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=k;f++}return e},yu=function(a,b){var c="";b=b.replace(uu,function(a,b){c=b;return""});var d={};d.gg=c;
d.tj=0;b=su(b);for(var e=0;e<b.length;){var f=b[e].value;e++;if(1==b[e].type)var h=pu(a,b[e].value);else ec("Expected block type.");d[f.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=h;e++}return d};lu.prototype.f=function(a){return"\ufddf_"+(a.length-1).toString(10)+"_"};var zu=chrome.i18n.getMessage("1522140683318860351"),Au=chrome.i18n.getMessage("4246483347873264186"),Bu=chrome.i18n.getMessage("5991427458288444010"),Ef=chrome.i18n.getMessage("6063910461797960050"),Cu=chrome.i18n.getMessage("7735695102441495789"),Du=chrome.i18n.getMessage("4575332923598659024"),hu=chrome.i18n.getMessage("2297080986956220930"),Eu=new lu;var Fu=function(a){this.a=a;this.j=kb("mr.cloud.mesi.MesiService")},vt=function(a){var b=Cs.a;.1>Math.random()&&(b=b.replace("v1","v1_preprod"));b=Ks(b,["hangouts","search"]);a.j.info("Retrieving Hangouts from MESI: "+b);return Ls(a.a,b,"POST",Gu).then(function(a){var b=[];a.result&&(b=a.result.map(function(a){var b=a.hangout,c=b.meeting_room_name,d;b.meeting_domain?d=b.meeting_domain:"BUSINESS"==b.type&&b.company_title&&(d=b.company_title.toLowerCase());var e=Eu.format({ORGANIZER:"",PARTICIPANTS:0});
if((a=a.participant)&&0<a.length){var r=a[0].display_name;e=a.reduce(function(a,b){a.add(b.user_id);"ORGANIZER"==b.role&&(r=b.display_name);return a},new Set);e=Eu.format({ORGANIZER:r,PARTICIPANTS:e.size})}return c&&d?new ys(!1,c+"@"+d,d,c,e,b.hangout_id):new ys(!1,b.hangout_id,d,c,e,b.hangout_id)}));return b})},Gu={request_header:{client_version:{client_id:"39"}},search_sources:["0"]};var Hu=function(a,b,c){this.state=a;this.type=null!=b?b:null;this.a=null!=c?c:null},Iu=function(a){this.a=a},Lu=function(a,b,c,d){return Ju(a,Rs,b,c,d,35E3).then(function(b){return Ku(a,b)})},Nu=function(a,b,c,d){return Ju(a,Ss,b,c,d,23E3).then(function(a){var b=a.state;return"done"==b?(a=Mu(a),new Hu(b,a.type,new Os(a.sessionDescription))):new Hu(b)})},Ju=function(a,b,c,d,e,f){var h={_webrtcMessage:JSON.stringify(d.presentationUrl?new Os(d.description,null,d.presentationUrl,d.presentationId):new Os(d.description))};
d.settings&&(h._settings=Ng(d.settings));d.mediaConstraints&&(h._optMediaConstraints=JSON.stringify(d.mediaConstraints));e&&(h._user=JSON.stringify(e));return Ou(a,c,b,h,f)},Ku=function(a,b){var c=b.state;switch(c){case "done":return Promise.resolve(Pu(b));case "queued":case "inProgress":return Qu(a,b).then(function(b){return Ku(a,b)});default:return Promise.resolve(new Hu(c))}},Qu=function(a,b){return new Promise(function(c){var d=setInterval(function(){Ru(a,b.id).then(function(a){"queued"!=a.state&&
"inProgress"!=a.state&&(clearInterval(d),c(a))})},2E3)})},Pu=function(a){a=Mu(a);return"__cloud_webrtc_session_message__"==a.type?new Hu("done","knocking_cloud_webrtc_session_message",new Os(a.sessionDescription)):new Hu("done",a.type)},Ou=function(a,b,c,d,e){b={deviceId:b,name:"_cloudCast."+c.name,parameters:d,expirationTimeoutMs:e||1E4};c={};e&&(c.responseAwaitMs=Math.min(e+5E3,25E3));e=Ks(As.a,["commands"],c);return Ls(a.a,e,"POST",b)},Mu=function(a){return a.results&&a.results.results?JSON.parse(a.results.results):
null},Ru=function(a,b){b=Ks(As.a,["commands",b]);return Ls(a.a,b,"GET")};Iu.$inject=["gapiService"];var Su=function(a,b,c,d){this.b=a;this.f=b;this.g=c;this.a=d},Wu=function(a,b,c,d){return Tu(a,b,d).then(function(b){a:{var d=c.id;if("done"!=b.state)d=Promise.reject(Error("Offer not executed by receiver. State: "+b.state));else{switch(b.type){case "__cloud_webrtc_session_message__":b=new Qg("ANSWER",b.a.sessionDescription);Uu(a.a,b,d);break;case "knocking_cloud_webrtc_session_message":os(0);b=new Qg("KNOCK_ANSWER",b.a.sessionDescription);Uu(a.a,b,d);break;case "knock_denied":os(1);Vu(a,Au,d);break;
case "knock_timeout":os(2);Vu(a,Bu,d);break;default:d=Promise.reject(Error("Invalid message type: "+b.type));break a}d=Promise.resolve()}}return d})},Yu=function(a,b){return Xu(a.g).then(function(c){Uu(a.a,new Qg("TURN_CREDENTIALS",{credentials:c}),b.id)})},Tu=function(a,b,c){var d=c.deviceId,e=a.f.a;e=e?new Ms(e):void 0;b=b.data;switch(c.fh){case "owner":rs(0);break;case "manager":rs(1);break;case "user":rs(2);break;case "viewer":rs(3)}return"viewer"==c.fh?Lu(a.b,d,b,e):Nu(a.b,d,b,e)},Vu=function(a,
b,c){b=new Df(b,"warning");b.isBlocking=!0;a.a.a.Nd(b);Uu(a.a,new Qg("STOP"),c)};var Zu=function(a,b){this.b=a;this.a=b},av=function(a,b,c,d){switch(b.type){case "REFRESH_AUTH":var e=d.tc,f=d.deviceId,h=d.Sd;return Rt(a.b).then(function(){Uu(a.a,new Qg("AUTH_READY",{tc:e,Xa:f,Sd:h}),c.id)});case "LOCAL_PRESENT":return Uu(a.a,new Qg("AUTH_READY",{tc:d.tc,Xa:d.deviceId,Sd:d.Sd,ed:!b.data.local}),c.id),Promise.resolve();case "STATUS_REQUEST":return Uu(a.a,b,c.id),Promise.resolve();case "STATUS_RESPONSE":return Uu(a.a,b,c.id,!0),b.data.routeDescription||Uu(a.a,b,c.id),Promise.resolve();
case "HANGOUT_INACTIVE":return $u(a.a,c,4,new Df(Cu,"warning"));case "HANGOUT_INVALID":return $u(a.a,c,3,new Df(Du,"warning"));default:return Promise.reject(Error("Unknown type: "+b.type))}};var bv=function(a,b,c){this.b=a;this.f=b;this.a=c},cv=function(a,b,c,d,e){return new Promise(function(f){switch(b){case "cloud":case "mesi":break;default:throw Error("Unrecognized channel type");}if(!c.type)throw Error("Message has no type");switch(c.type){case "STOP":f($u(a.a,d,1,null));return;case "SESSION_START_SUCCESS":ps(0);break;case "SESSION_END":break;case "SESSION_FAILURE":ps(1);f($u(a.a,d,2,new Df(zu,"warning")));return;case "__webrtc_stats__":break;case "PRESENTATION_CONNECTION_MESSAGE":Uu(a.a,
c.data,d.id,!0);break;case "OFFER":f(Wu(a.b,c,d,e));return;case "GET_TURN_CREDENTIALS":f(Yu(a.b,d));return;case "REFRESH_AUTH":case "LOCAL_PRESENT":case "MUTE":case "STATUS_REQUEST":case "STATUS_RESPONSE":case "HANGOUT_INACTIVE":case "HANGOUT_INVALID":f(av(a.f,c,d,e));return;case "new_session":Uu(a.a,c,d.id,!0);break;case "remove_session":Uu(a.a,c,d.id,!0);a.a.terminateRoute(d.id);break;default:throw Error("Unknown type: "+c.type);}f()})};var dv=function(){var a=this;this.j=kb("mr.cloud.settings.SettingsService");this.a=null;chrome.settingsPrivate.onPrefsChanged.addListener(function(b){gg(13);if(a.a){b=la(b);for(var c=b.next();!c.done;c=b.next())if(c=c.value,"media_router.cloudservices.enabled"==c.key){a.a.call(null,c.value);break}}})},ev=function(a,b){a.a=b},fv=function(a){var b=a.j;chrome.storage.sync.set({"mr.cloud.cloudEnabled":!0},function(){chrome.runtime.lastError&&u(b,"Error setting cloud setting: "+JSON.stringify(chrome.runtime.lastError))})},
hv=function(a){return gv().catch(function(){return gv().catch(function(b){u(a.j,"Error retrieving cloud on setting.",b);return!1})})},gv=function(){return iv("mr.cloud.cloudEnabled").then(function(a){return!!a["mr.cloud.cloudEnabled"]})},iv=function(a){return new Promise(function(b,c){chrome.storage.sync.get(a,function(a){chrome.runtime.lastError?c(chrome.runtime.lastError):b(a)})})},kv=function(a){return jv().catch(function(){return jv().catch(function(b){u(a.j,"Error retrieving cloud enabled setting.",
b);return!1})})},jv=function(){return lv().then(function(a){return!!a.value})},lv=function(){return new Promise(function(a,b){chrome.settingsPrivate.getPref("media_router.cloudservices.enabled",function(c){chrome.runtime.lastError?b(chrome.runtime.lastError):a(c)})})},mv=function(a){var b=a.j;chrome.storage.sync.set({"mr.cloud.notifiedHangouts":!0},function(){chrome.runtime.lastError&&u(b,"Error setting notified Hangout privacy.",chrome.runtime.lastError)})},ov=function(a){return nv().catch(function(){return nv().catch(function(b){u(a.j,
"Error retrieving hangouts notified setting.",b);return!1})})},nv=function(){return iv("mr.cloud.notifiedHangouts").then(function(a){return!!a["mr.cloud.notifiedHangouts"]})};var pv=function(){var a=window.crypto.getRandomValues(new Uint8Array(16));return kc(a,function(a){a=a.toString(16);return 1<a.length?a:"0"+a}).join("")},qv=function(a){for(var b=[],c=0,d=0;d<a.length;d++){var e=a.charCodeAt(d);128>e?b[c++]=e:(2048>e?b[c++]=e>>6|192:(55296==(e&64512)&&d+1<a.length&&56320==(a.charCodeAt(d+1)&64512)?(e=65536+((e&1023)<<10)+(a.charCodeAt(++d)&1023),b[c++]=e>>18|240,b[c++]=e>>12&63|128):b[c++]=e>>12|224,b[c++]=e>>6&63|128),b[c++]=e&63|128)}return b},rv=function(a){for(var b=
[],c=0,d=0;c<a.length;){var e=a[c++];if(128>e)b[d++]=String.fromCharCode(e);else if(191<e&&224>e){var f=a[c++];b[d++]=String.fromCharCode((e&31)<<6|f&63)}else if(239<e&&365>e){f=a[c++];var h=a[c++],k=a[c++];e=((e&7)<<18|(f&63)<<12|(h&63)<<6|k&63)-65536;b[d++]=String.fromCharCode(55296+(e>>10));b[d++]=String.fromCharCode(56320+(e&1023))}else f=a[c++],h=a[c++],b[d++]=String.fromCharCode((e&15)<<12|(f&63)<<6|h&63)}return b.join("")};var sv=null,tv=null,vv=function(a){uv();for(var b=sv,c=[],d=0;d<a.length;d+=3){var e=a[d],f=d+1<a.length,h=f?a[d+1]:0,k=d+2<a.length,m=k?a[d+2]:0,r=e>>2;e=(e&3)<<4|h>>4;h=(h&15)<<2|m>>6;m&=63;k||(m=64,f||(h=64));c.push(b[r],b[e],b[h],b[m])}return c.join("")},xv=function(a){var b=a.length,c=0;"="===a[b-2]?c=2:"="===a[b-1]&&(c=1);var d=new Uint8Array(Math.ceil(3*b/4)-c),e=0;wv(a,function(a){d[e++]=a});return d.subarray(0,e)},wv=function(a,b){function c(b){for(;d<a.length;){var c=a.charAt(d++),e=tv[c];
if(null!=e)return e;if(!Kb(c))throw Error("Unknown base64 encoding at char: "+c);}return b}uv();for(var d=0;;){var e=c(-1),f=c(0),h=c(64),k=c(64);if(64===k&&-1===e)break;b(e<<2|f>>4);64!=h&&(b(f<<4&240|h>>2),64!=k&&b(h<<6&192|k))}},uv=function(){if(!sv){sv={};tv={};for(var a=0;65>a;a++)sv[a]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(a),tv[sv[a]]=a,62<=a&&(tv["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(a)]=a)}};var yv=function(a,b){this.a=a;this.b=b},zv=function(a){return new yv((a.a>>>1|(a.b&1)<<31)>>>0,a.b>>>1>>>0)},Av=function(a){return new yv(a.a<<1>>>0,(a.b<<1|a.a>>>31)>>>0)};yv.prototype.add=function(a){return new yv((this.a+a.a&4294967295)>>>0>>>0,((this.b+a.b&4294967295)>>>0)+(4294967296<=this.a+a.a?1:0)>>>0)};yv.prototype.sub=function(a){return new yv((this.a-a.a&4294967295)>>>0>>>0,((this.b-a.b&4294967295)>>>0)-(0>this.a-a.a?1:0)>>>0)};
var Bv=function(a){var b=a&65535,c=a>>>16;a=10*b+65536*(0*b&65535)+65536*(10*c&65535);for(b=0*c+(0*b>>>16)+(10*c>>>16);4294967296<=a;)a-=4294967296,b+=1;return new yv(a>>>0,b>>>0)};
yv.prototype.toString=function(){for(var a="",b=this;0!=b.a||0!=b.b;){var c=new yv(0,0);b=new yv(b.a,b.b);for(var d=new yv(10,0),e=new yv(1,0);!(d.b&2147483648);)d=Av(d),e=Av(e);for(;0!=e.a||0!=e.b;)0>=(d.b<b.b||d.b==b.b&&d.a<b.a?-1:d.b==b.b&&d.a==b.a?0:1)&&(c=c.add(e),b=b.sub(d)),d=zv(d),e=zv(e);c=[c,b];b=c[0];a=c[1].a+a}""==a&&(a="0");return a};
var Cv=function(a){for(var b=new yv(0,0),c=new yv(0,0),d=0;d<a.length;d++){if("0">a[d]||"9"<a[d])return null;c.a=parseInt(a[d],10);var e=Bv(b.a);b=Bv(b.b);b.b=b.a;b.a=0;b=e.add(b).add(c)}return b},Dv=function(a,b){this.a=a;this.b=b};Dv.prototype.add=function(a){return new Dv((this.a+a.a&4294967295)>>>0>>>0,((this.b+a.b&4294967295)>>>0)+(4294967296<=this.a+a.a?1:0)>>>0)};Dv.prototype.sub=function(a){return new Dv((this.a-a.a&4294967295)>>>0>>>0,((this.b-a.b&4294967295)>>>0)-(0>this.a-a.a?1:0)>>>0)};
Dv.prototype.toString=function(){var a=0!=(this.b&2147483648),b=new yv(this.a,this.b);a&&(b=(new yv(0,0)).sub(b));return(a?"-":"")+b.toString()};var Ev=0,Fv=0,Gv=function(a){var b=0>a;a=Math.abs(a);var c=a>>>0;a=Math.floor((a-c)/4294967296);a>>>=0;b&&(a=~a>>>0,c=(~c>>>0)+1,4294967295<c&&(c=0,a++,4294967295<a&&(a=0)));Ev=c;Fv=a},Hv=function(a){if(a.constructor===Uint8Array)return a;if(a.constructor===ArrayBuffer)return new Uint8Array(a);if(a.constructor===Array)return new Uint8Array(a);if(a.constructor===String)return xv(a);ec("Type not convertible to Uint8Array.");return new Uint8Array(0)};var Jv=function(a){this.f=null;this.u=this.m=this.a=this.g=this.l=0;this.h=!1;a&&Iv(this,a)},Kv=[];Jv.prototype.clear=function(){this.f=null;this.a=this.g=this.l=0;this.h=!1};var Iv=function(a,b){a.f=Hv(b);a.l=Ja(void 0)?void 0:0;a.g=Ja(void 0)?a.l+void 0:a.f.length;a.a=a.l};Jv.prototype.reset=function(){this.a=this.l};
Jv.prototype.b=function(){var a=this.f;var b=a[this.a+0];var c=b&127;if(128>b)return this.a+=1,c;b=a[this.a+1];c|=(b&127)<<7;if(128>b)return this.a+=2,c;b=a[this.a+2];c|=(b&127)<<14;if(128>b)return this.a+=3,c;b=a[this.a+3];c|=(b&127)<<21;if(128>b)return this.a+=4,c;b=a[this.a+4];c|=(b&15)<<28;if(128>b)return this.a+=5,c>>>0;this.a+=5;128<=a[this.a++]&&128<=a[this.a++]&&128<=a[this.a++]&&128<=a[this.a++]&&this.a++;return c};Jv.prototype.v=Jv.prototype.b;
var Lv=function(a){a:{for(var b,c=0,d,e=0;4>e;e++)if(b=a.f[a.a++],c|=(b&127)<<7*e,128>b){a.m=c>>>0;a.u=0;break a}b=a.f[a.a++];c|=(b&127)<<28;d=0|(b&127)>>4;if(128>b)a.m=c>>>0,a.u=d>>>0;else{for(e=0;5>e;e++)if(b=a.f[a.a++],d|=(b&127)<<7*e+3,128>b){a.m=c>>>0;a.u=d>>>0;break a}ec("Failed to read varint, encoding is invalid.");a.h=!0}}b=a.m;c=a.u;if(a=c&2147483648)b=~b+1>>>0,c=~c>>>0,0==b&&(c=c+1>>>0);b=4294967296*c+b;return a?-b:b};Jv.prototype.s=function(){return this.v()};var Mv=function(){this.a=[]};Mv.prototype.length=function(){return this.a.length};var Nv=function(a){var b=a.a;a.a=[];return b},Ov=function(a,b,c){for(;0<c||127<b;)a.a.push(b&127|128),b=(b>>>7|c<<25)>>>0,c>>>=7;a.a.push(b)},Pv=function(a,b){for(;127<b;)a.a.push(b&127|128),b>>>=7;a.a.push(b)},Qv=function(a,b){if(0<=b)Pv(a,b);else{for(var c=0;9>c;c++)a.a.push(b&127|128),b>>=7;a.a.push(1)}},Rv=function(a,b){a.a.push(b>>>0&255);a.a.push(b>>>8&255);a.a.push(b>>>16&255);a.a.push(b>>>24&255)};var Sv=function(a){if(Kv.length){var b=Kv.pop();a&&Iv(b,a);a=b}else a=new Jv(a);this.a=a;this.g=this.b=-1;this.l=!1},Tv=function(a){return 4==a.g};Sv.prototype.reset=function(){this.a.reset();this.g=this.b=-1};
var Uv=function(a){var b=a.a;if(b.a==b.g)return!1;(b=a.l)||(b=a.a,b=b.h||0>b.a||b.a>b.g);if(b)return ec("Decoder hit an error"),!1;var c=a.a.b();b=c>>>3;c&=7;if(0!=c&&5!=c&&1!=c&&2!=c&&3!=c&&4!=c)return ec("Invalid wire type"),a.l=!0,!1;a.b=b;a.g=c;return!0},Vv=function(a){switch(a.g){case 0:if(0!=a.g)ec("Invalid wire type for skipVarintField"),Vv(a);else{for(a=a.a;a.f[a.a]&128;)a.a++;a.a++}break;case 1:1!=a.g?(ec("Invalid wire type for skipFixed64Field"),Vv(a)):(a=a.a,a.a+=8);break;case 2:if(2!=
a.g)ec("Invalid wire type for skipDelimitedField"),Vv(a);else{var b=a.a.b();a=a.a;a.a+=b}break;case 5:5!=a.g?(ec("Invalid wire type for skipFixed32Field"),Vv(a)):(a=a.a,a.a+=4);break;case 3:b=[a.b];do{if(!Uv(a)){ec("Unmatched start-group tag: stream EOF");a.l=!0;break}if(3==a.g)b.push(a.b);else if(4==a.g&&a.b!=b.pop()){ec("Unmatched end-group tag");a.l=!0;break}}while(0<b.length);break;default:ec("Invalid wire encoding for field.")}};
Sv.prototype.f=function(a,b){var c=this.a.g,d=this.a.b();d=this.a.a+d;this.a.g=d;b(a,this);this.a.a=d;this.a.g=c};
var Wv=function(a){var b=a.a.b();a=a.a;var c=a.f,d=a.a,e=d+b,f=[];for(b="";d<e;){var h=c[d++];if(128>h)f.push(h);else if(192>h)continue;else if(224>h){var k=c[d++];f.push((h&31)<<6|k&63)}else if(240>h){k=c[d++];var m=c[d++];f.push((h&15)<<12|(k&63)<<6|m&63)}else if(248>h){k=c[d++];m=c[d++];var r=c[d++];h=(h&7)<<18|(k&63)<<12|(m&63)<<6|r&63;h-=65536;f.push((h>>10&1023)+55296,(h&1023)+56320)}8192<=f.length&&(b+=String.fromCharCode.apply(null,f),f.length=0)}if(8192>=f.length)f=String.fromCharCode.apply(null,
f);else{c="";for(e=0;e<f.length;e+=8192)c+=String.fromCharCode.apply(null,Fc(f,e,e+8192));f=c}a.a=d;return b+f},Xv=function(a,b){var c=a.a.b();c=a.a.a+c;for(var d=[];a.a.a<c;)d.push(b.call(a.a));return d};var F=function(){this.g=[];this.f=0;this.b=new Mv},Zv=function(a,b){Yv(a,b,2);b=Nv(a.b);a.g.push(b);a.f+=b.length;b.push(a.f);return b},$v=function(a,b){var c=b.pop();for(c=a.f+a.b.length()-c;127<c;)b.push(c&127|128),c>>>=7,a.f++;b.push(c);a.f++};F.prototype.reset=function(){this.g=[];Nv(this.b);this.f=0};
var H=function(a){for(var b=new Uint8Array(a.f+a.b.length()),c=a.g,d=c.length,e=0,f=0;f<d;f++){var h=c[f];b.set(h,e);e+=h.length}c=Nv(a.b);b.set(c,e);a.g=[b];return b},Yv=function(a,b,c){Pv(a.b,8*b+c)},I=function(a,b,c){null!=c&&null!=c&&(Yv(a,b,0),Qv(a.b,c))},K=function(a,b,c){null!=c&&null!=c&&(Yv(a,b,0),a=a.b,Gv(c),Ov(a,Ev,Fv))},aw=function(a,b,c){if(null!=c){var d=c;(c=0<d.length&&"-"==d[0])&&(d=d.substring(1));d=Cv(d);null===d?c=null:(c&&(d=(new yv(0,0)).sub(d)),c=new Dv(d.a,d.b));Yv(a,b,0);
Ov(a.b,c.a,c.b)}},bw=function(a,b,c){null!=c&&null!=c&&(Yv(a,b,0),Pv(a.b,c))},cw=function(a,b,c){null!=c&&null!=c&&(Yv(a,b,0),a=a.b,Gv(c),Ov(a,Ev,Fv))},dw=function(a,b,c){null!=c&&(c=Cv(c),Yv(a,b,0),Ov(a.b,c.a,c.b))},ew=function(a,b,c){null!=c&&(Yv(a,b,5),Rv(a.b,c))},fw=function(a,b,c){if(null!=c){Yv(a,b,5);a=a.b;var d=c;d=(c=0>d?1:0)?-d:d;0===d?0<1/d?Ev=Fv=0:(Fv=0,Ev=2147483648):isNaN(d)?(Fv=0,Ev=2147483647):3.4028234663852886E38<d?(Fv=0,Ev=(c<<31|2139095040)>>>0):1.1754943508222875E-38>d?(d=Math.round(d/
Math.pow(2,-149)),Fv=0,Ev=(c<<31|d)>>>0):(b=Math.floor(Math.log(d)/Math.LN2),d*=Math.pow(2,-b),d=Math.round(8388608*d)&8388607,Fv=0,Ev=(c<<31|b+127<<23|d)>>>0);Rv(a,Ev)}},M=function(a,b,c){null!=c&&(Yv(a,b,0),a.b.a.push(c?1:0))},N=function(a,b,c){null!=c&&(Yv(a,b,0),Qv(a.b,c))},O=function(a,b,c){if(null!=c){b=Zv(a,b);for(var d=a.b,e=0;e<c.length;e++){var f=c.charCodeAt(e);if(128>f)d.a.push(f);else if(2048>f)d.a.push(f>>6|192),d.a.push(f&63|128);else if(65536>f)if(55296<=f&&56319>=f&&e+1<c.length){var h=
c.charCodeAt(e+1);56320<=h&&57343>=h&&(f=1024*(f-55296)+h-56320+65536,d.a.push(f>>18|240),d.a.push(f>>12&63|128),d.a.push(f>>6&63|128),d.a.push(f&63|128),e++)}else d.a.push(f>>12|224),d.a.push(f>>6&63|128),d.a.push(f&63|128)}$v(a,b)}},gw=function(a,b,c){null!=c&&(c=Hv(c),Yv(a,b,2),Pv(a.b,c.length),b=Nv(a.b),a.g.push(b),a.g.push(c),a.f+=b.length+c.length)};F.prototype.a=function(a,b,c){null!=b&&(a=Zv(this,a),c(b,this),$v(this,a))};
var hw=function(a,b,c){if(null!=c)for(var d=0;d<c.length;d++){var e=a,f=c[d];null!=f&&(Yv(e,b,0),Qv(e.b,f))}},iw=function(a,b,c){if(null!=c)for(var d=0;d<c.length;d++){var e=a,f=c[d];null!=f&&(Yv(e,b,0),e=e.b,Gv(f),Ov(e,Ev,Fv))}},jw=function(a,b,c){if(null!=c)for(var d=0;d<c.length;d++){var e=a,f=c[d];null!=f&&(Yv(e,b,0),Pv(e.b,f))}},kw=function(a,b,c){if(null!=c)for(var d=0;d<c.length;d++)ew(a,b,c[d])},lw=function(a,b,c){if(null!=c)for(var d=0;d<c.length;d++)N(a,b,c[d])},mw=function(a,b,c){if(null!=
c)for(var d=0;d<c.length;d++)O(a,b,c[d])},nw=function(a,b,c){if(null!=c)for(var d=0;d<c.length;d++)gw(a,b,c[d])},P=function(a,b,c,d){if(null!=c)for(var e=0;e<c.length;e++){var f=Zv(a,b);d(c[e],a);$v(a,f)}},ow=function(a,b,c,d){if(null!=c)for(var e=0;e<c.length;e++)Yv(a,b,3),d(c[e],a),Yv(a,b,4)},pw=function(a,b,c){if(null!=c&&c.length){b=Zv(a,b);for(var d=0;d<c.length;d++)Qv(a.b,c[d]);$v(a,b)}};var qw=function(){var a=[];Object.freeze&&(a=Object.freeze(a));this.a=a};new qw;qw.prototype.equals=function(a){if(null==a)return!1;if(this===a)return!0;if(!(a instanceof qw)||a.a.length!=this.a.length)return!1;for(var b=0;b<this.a.length;b++)if(a.a[b]!==this.a[b])return!1;return!0};var R=function(){},rw="function"==typeof Uint8Array,S=function(a,b,c,d,e){a.a=null;b||(b=c?[c]:[]);a.A=c?String(c):void 0;a.g=0===c?-1:0;a.b=b;a:{if(a.b.length&&(b=a.b.length-1,(c=a.b[b])&&"object"==typeof c&&!Va(c)&&!(rw&&c instanceof Uint8Array))){a.l=b-a.g;a.f=c;break a}-1<d?(a.l=d,a.f=null):a.l=Number.MAX_VALUE}a.I={};if(e)for(d=0;d<e.length;d++)b=e[d],b<a.l?(b+=a.g,a.b[b]=a.b[b]||sw):(tw(a),a.f[b]=a.f[b]||sw)},sw=Object.freeze?Object.freeze([]):[],tw=function(a){var b=a.l+a.g;a.b[b]||(a.f=a.b[b]=
{})},uw=function(a,b,c,d){for(var e in c){var f=c[e],h=f.Mn;if(!f.nh)throw Error("Message extension present that was generated without binary serialization support");var k=d.call(a,h);if(null!=k)if(h.df)if(f.vj)f.nh.call(b,h.vh,k,f.vj);else throw Error("Message extension present holding submessage without binary support enabled, and message is being serialized to binary format");else f.nh.call(b,h.vh,k)}},T=function(a,b){if(b<a.l){b+=a.g;var c=a.b[b];return c===sw?a.b[b]=[]:c}if(a.f)return c=a.f[b],
c===sw?a.f[b]=[]:c},U=function(a,b){if(b<a.l){b+=a.g;var c=a.b[b];return c===sw?a.b[b]=[]:c}c=a.f[b];return c===sw?a.f[b]=[]:c},vw=function(a,b){a=T(a,b);return null==a?a:+a},ww=function(a){if(null==a||a instanceof Uint8Array)return a;if(Ka(a))return xv(a);ec("Cannot coerce to Uint8Array: "+Ra(a));return null},yw=function(a){xw(a);return!a.length||a[0]instanceof Uint8Array?a:kc(a,ww)},xw=function(a){if(a&&1<a.length){var b=Ra(a[0]);w(a,function(a){Ra(a)!=b&&ec("Inconsistent type in JSPB repeated field array. Got "+
Ra(a)+" expected "+b)})}},V=function(a,b,c){a=T(a,b);return null==a?c:a},W=function(a,b,c){b<a.l?a.b[b+a.g]=c:(tw(a),a.f[b]=c)},Aw=function(a,b,c){zw(a,b,c,"")},zw=function(a,b,c,d){c!=d?W(a,b,c):a.b[b+a.g]=null},X=function(a,b,c,d){a.a||(a.a={});if(!a.a[c]){var e=T(a,c);if(d||e)a.a[c]=new b(e)}return a.a[c]},Y=function(a,b,c){Bw(a,b,c);b=a.a[c];b==sw&&(b=a.a[c]=[]);return b},Bw=function(a,b,c){a.a||(a.a={});if(!a.a[c]){for(var d=U(a,c),e=[],f=0;f<d.length;f++)e[f]=new b(d[f]);a.a[c]=e}},Z=function(a,
b,c){a.a||(a.a={});var d=c?c.Gc():c;a.a[b]=c;W(a,b,d)},Cw=function(a,b,c){a.a||(a.a={});c=c||[];for(var d=[],e=0;e<c.length;e++)d[e]=c[e].Gc();a.a[b]=c;W(a,b,d)},Dw=function(a,b,c,d){Bw(a,d,b);var e=a.a[b];e||(e=a.a[b]=[]);c=c?c:new d;a=U(a,b);e.push(c);a.push(c.Gc())},Ew=function(a){if(a.a)for(var b in a.a){var c=a.a[b];if(Va(c))for(var d=0;d<c.length;d++)c[d]&&c[d].Gc();else c&&c.Gc()}};R.prototype.Gc=function(){Ew(this);return this.b};
R.prototype.xa=rw?function(){var a=Uint8Array.prototype.toJSON;Uint8Array.prototype.toJSON=function(){return vv(this)};try{return JSON.stringify(this.b&&this.Gc(),Fw)}finally{Uint8Array.prototype.toJSON=a}}:function(){return JSON.stringify(this.b&&this.Gc(),Fw)};var Fw=function(a,b){return n(b)&&(isNaN(b)||Infinity===b||-Infinity===b)?String(b):b},Hw=function(a){var b=Gw[a[0]];if(!b)throw Error("Unknown JsPb message type: "+a[0]);return new b(a)};R.prototype.toString=function(){Ew(this);return this.b.toString()};
R.prototype.v=function(a){if(this.f){this.a||(this.a={});var b=a.vh;if(a.a){if(a.df)return this.a[b]||(this.a[b]=kc(this.f[b]||[],function(b){return new a.df(b)})),this.a[b]}else if(a.df)return!this.a[b]&&this.f[b]&&(this.a[b]=new a.df(this.f[b])),this.a[b];return this.f[b]}};
var Jw=function(a,b){a=a||{};b=b||{};var c={},d;for(d in a)c[d]=0;for(d in b)c[d]=0;for(d in c)if(!Iw(a[d],b[d]))return!1;return!0},Iw=function(a,b){if(a==b)return!0;if(!Ya(a)||!Ya(b))return n(a)&&isNaN(a)||n(b)&&isNaN(b)?String(a)==String(b):!1;if(a.constructor!=b.constructor)return!1;if(rw&&a.constructor===Uint8Array){if(a.length!=b.length)return!1;for(var c=0;c<a.length;c++)if(a[c]!=b[c])return!1;return!0}if(a.constructor===Array){var d=void 0,e=void 0,f=Math.max(a.length,b.length);for(c=0;c<f;c++){var h=
a[c],k=b[c];h&&h.constructor==Object&&(d=h,h=void 0);k&&k.constructor==Object&&(e=k,k=void 0);if(!Iw(h,k))return!1}return d||e?(d=d||{},e=e||{},Jw(d,e)):!0}if(a.constructor===Object)return Jw(a,b);throw Error("Invalid type in JSPB array");},Lw=function(a){return new a.constructor(Kw(a.Gc()))},Kw=function(a){var b;if(Va(a)){for(var c=Array(a.length),d=0;d<a.length;d++)null!=(b=a[d])&&(c[d]="object"==typeof b?Kw(b):b);return c}if(rw&&a instanceof Uint8Array)return new Uint8Array(a);c={};for(d in a)null!=
(b=a[d])&&(c[d]="object"==typeof b?Kw(b):b);return c},Mw=function(a,b){Gw[a]=b;b.messageId=a},Gw={};var Nw=function(a){S(this,a,0,-1,null)};t(Nw,R);Nw.prototype.o=function(){var a=new F;Ow(this,a);return H(a)};var Ow=function(a,b){var c=T(a,1);null!=c&&K(b,1,c);c=T(a,2);null!=c&&O(b,2,c);c=X(a,Pw,3);null!=c&&b.a(3,c,Qw)},Pw=function(a){S(this,a,0,-1,null)};t(Pw,R);Pw.prototype.o=function(){var a=new F;Qw(this,a);return H(a)};var Qw=function(a,b){var c=T(a,1);null!=c&&O(b,1,c);c=T(a,2);null!=c&&K(b,2,c)};Nw.prototype.fc=function(){return T(this,1)};var Rw=function(){this.a=null},Sw=function(a,b){if(!a.a||T(a.a,2)<T(b,2))a.a=Lw(b)},Tw=function(a){return a.a?T(a.a,2)+";"+T(a.a,1):null};var Uw=function(){this.j=kb("mr.cloud.CredentialService")},Xu=function(a){var b=new Ib,c=Ds.a+"/iceconfig?key="+Ds.b;a.j.info("Requesting TURN credentials from "+c);var d=rk(c,function(){Bk(d)?(a.j.info("Got TURN credentials: "+Ck(d)),b.resolve(Vw(a,Dk(d)))):b.resolve(Ww(a))},"POST",void 0,{"Content-Type":"application/json"});return b.a},Vw=function(a,b){try{var c=[];b.iceServers.forEach(function(a){a.urls.forEach(function(b){0==b.indexOf("turn:")&&c.push({url:b,credential:a.credential,username:a.username})})});
return c}catch(d){return a.j.error("Error parsing TURN credentials.",d),[]}},Ww=function(a){a.j.error("XHR failed fetching TURN credentials.",null);return[]};var Xw=function(){this.u=this.B=this.I=this.A=this.w=this.v=this.s=this.l=this.b=this.h=this.g=this.f=this.m=this.a=null},Yw=function(){var a=Xw.Da();null==a.u&&(a.u=new Rw);return a.u},Zw=function(a){null==a.a&&(a.a=new Pt);return a.a},$w=function(a){null==a.m&&(a.m=new Ht(Zw(a)));return a.m},ax=function(a){null==a.s&&(a.s=new Iu($w(a)));return a.s};Qa(Xw);var bx=function(a){this.a=a;this.b=new Map;this.A=new Map;this.s=[];this.l=this.B=this.m=this.I=this.h=null;this.v=this.g=this.f=!1;this.w=new Map;this.u=new Map;lh(this)};bx.prototype.getName=function(){return"cloud"};
bx.prototype.Ya=function(){var a=this;this.j.info("Initializing Cloud MRP");var b=Xw.Da();null==b.g&&(null==b.f&&(b.f=new Ws($w(b))),b.g=new rt(b.f,this));this.s.push(b.g);if(null==b.l){null==b.b&&(b.b=new Es($w(b),Zw(b)));var c=b.b;null==b.h&&(b.h=new Fu($w(b)));b.l=new ut(c,b.h,this)}this.h=b.l;this.s.push(this.h);this.I=ax(b);this.m=Zw(b);if(null==b.A){if(null==b.v){c=ax(b);var d=Zw(b);null==b.B&&(b.B=new Uw($w(b)));b.v=new Su(c,d,b.B,this)}c=b.v;null==b.w&&(b.w=new Zu(Zw(b),this));b.A=new bv(c,
b.w,this)}this.B=b.A;null==b.I&&(b.I=new dv);this.l=b.I;kv(this.l).then(function(b){a.f=b;a.j.info("Cloud enabled setting: "+a.f)});hv(this.l).then(function(b){a.g=b;a.j.info("Cloud on setting: "+a.g)});ev(this.l,function(b){a.f=b;a.j.info("Cloud enabled setting: "+a.f);a.f&&cx(a)});ov(this.l).then(function(b){a.v=b;a.j.info("Privacy notified setting: "+a.v)})};bx.prototype.Ld=function(){return Array.from(this.b.values())};
bx.prototype.kf=function(a){if(!dx(this,a))return Ll;v(this.j,"GetAvailableSinks for "+a);var b=[];if(this.g||ex())b=cx(this);this.u.clear();for(var c={},d=la(this.w.values()),e=d.next();!e.done;c={Me:c.Me,sg:c.sg},e=d.next())c.Me=e.value,c.sg=!1,b.forEach(function(a){return function(b){b.Ua.id==a.Me.Ua.id&&(a.sg=!0,b.Ua.friendlyName=a.Me.Ua.friendlyName)}}(c)),c.sg||this.u.set(c.Me.Ua.id,c.Me);b=b.concat.apply(b,[].concat(l(this.u.values())));v(this.j,function(){return"Available sinks are..."+JSON.stringify(b)});
c=b.map(function(a){return a.Ua});this.h&&(c=c.concat(fx));return new Kl(c,-1!=a.indexOf("0F5096E8")?lg:null)};var cx=function(a){var b=[];a.j.info("Checking cloud discovery services");nm().g=gb();a.s.forEach(function(a){a=a.Fe();b=b.concat(a)});return b};g=bx.prototype;g.startObservingMediaSinks=function(){};g.stopObservingMediaSinks=function(){};g.startObservingMediaRoutes=function(){};g.stopObservingMediaRoutes=function(){};g.wf=function(a){return(a=gx(this,a))?a.Ua:null};
g.createRoute=function(a,b,c,d,e,f,h){var k=this;this.j.info("createRoute called");v(this.j,"urn: "+a+" sinkId:"+b);if(e=this.A.get(b))return Hf(this.a.ik(this,e,a,c,h,function(b){b.mediaSource=a;b.Zb.tabId=h;return Jf(b)}),function(a){k.a.od(a);return a});e=gx(this,b);return hx(this,a,e,b,c,d,h)};
var ix=function(a,b,c,d,e){b instanceof cm&&2==b.errorCode?$u(a,c,6,null):(a.j.error("Error on start session",b instanceof Error?b:Error("Expected an Error value, got "+b)),a.b.has(c.id)&&$u(a,c,e,new Df(zu,"warning")));if(b=a.h)b=a.h,b.b.delete(d.deviceId)?(b.a.a.delete(d.Ua.id),b=!0):b=!1;b&&nt(a,[d.Ua])},hx=function(a,b,c,d,e,f,h){if(f)return Kf(Error("not supported"));f=!1;switch(jx(c)){case "cloud":qs(1);break;case "mesi":f=!0;if(!a.v){a.v=!0;mv(a.l);var k=Ff();a.a.Nd(k)}qs(0)}nm().f=new km(c.model,
null);var m=Jk(e,a.getName(),d,b,!0,"");f&&(m.customControllerPath="cloud_route_details/view.html?routeId="+m.id,m.controllerType=mojo.RouteControllerType&&mojo.RouteControllerType.kHangouts);a.b.set(m.id,m);a.A.set(d,m);a.w.set(m.id,c);a.a.He(a,m);a.a.Ke(a.ua(),!0);if(kg(b)&&!f)return a.j.info("starting presentation on route: "+m.id),If(kx(m,b),function(b){ix(a,b,m,c,7);throw b;});a.j.info("starting mirroring on route: "+m.id);m.Zb={tabId:h,sessionId:"",Nf:"",ae:c.model};kg(b)&&(m.isOffscreenPresentation=
!0);return If(a.a.Th(a,m,e),function(b){ix(a,b,m,c,5);throw b;})};bx.prototype.terminateRoute=function(a){var b=this.b.get(a);return b?$u(this,b,0,null):Promise.reject(new cm(3,"Route in cloud provider not found for routeId "+a))};
var $u=function(a,b,c,d){a.j.info("terminating route: "+b.id);a.b.delete(b.id);a.A.delete(b.sinkId);var e=a.w.get(b.id);a.w.delete(b.id);d&&a.a.Nd(d);Eb("MediaRouter.Cloud.Session.End",c,ls);switch(c){case 1:break;default:switch(jx(e)){case "cloud":Ou(a.I,e.deviceId,Ts,{})}}a.a.yf(b);0==a.b.size&&a.a.Ke(a.ua(),!1);a.a.onPresentationConnectionStateChanged(b.id,"terminated");a.u.has(b.sinkId)&&(c=a.u.get(b.sinkId),nt(a,[c.Ua]),a.u.delete(b.sinkId));return Promise.resolve()};g=bx.prototype;
g.sendRouteMessage=function(a,b,c){if(c&&c.channelType){c=c.channelType;var d=(a=this.b.get(a)||void 0)?gx(this,a.sinkId):void 0;return cv(this.B,c,b,a,d)}return Ka(b)?(Uu(this,b,a),Promise.resolve()):Promise.reject(Error("Channel type missing"))};g.sendRouteBinaryMessage=function(a){return Promise.reject(Error("Route "+a+" does not support sending binary data."))};
g.se=function(a){var b=new Og;5>b.minFrameRate&&(b.minFrameRate=5);"hangouts"!=this.Gd(a)&&(b.senderSideLetterboxing=!0);Pg(b);Object.freeze(b);this.j.info("Settings for "+a+": "+Ng(b));if(!b.shouldCaptureAudio&&!b.shouldCaptureVideo)throw Error("Cannot start mirroring without video or audio capture.");return b};g.Gd=function(a){var b=null;a=gx(this,a);switch(jx(a)){case "cloud":b="webrtc";break;case "mesi":b=a.tc?"meetings":"hangouts"}return b};
g.cf=function(a,b){v(this.j,"Checking canRoute: "+a+" for sinkId: "+b);return dx(this,a)&&!!this.wf(b)};g.fe=function(a,b){return("https://hangouts.google.com/cloudmrp-mirroring"==a||kg(a))&&this.b.has(b)};g.joinRoute=function(a,b){return(a=this.b.get(b))?(this.j.info("joining route: "+a.id),Jf(a)):Kf(Error("not supported"))};g.connectRouteByRouteId=function(){return Kf(Error("not supported"))};g.detachRoute=function(){};
var ht=function(a,b){a.j.info(b.length+" sinks added");0<b.length&&!a.g&&(fv(a.l),a.g=!0);b=gx(a,b[0].id);nm().b=new km(b.model,null);a.a.Bc();a.a.onSinkAvailabilityUpdated(a,2);a.j.info("sinkAvailability changed to AVAILABLE")},nt=function(a,b){a.j.info(b.length+" sinks removed");a.s.some(function(a){return 0<a.Fe().length})||(a.a.onSinkAvailabilityUpdated(a,0),a.j.info("sinkAvailability changed to UNAVAILABLE"));a.a.Bc()},it=function(a,b){a.j.info(b.length+" sinks updated");a.a.Bc()},Uu=function(a,
b,c,d){(void 0===d?0:d)?a.a.nd(c,b):a.a.Jg(c,b)},gx=function(a,b){var c=lx(a,b);c||(c=null,(b=a.A.get(b))&&(c=a.w.get(b.id)));return c},lx=function(a,b){var c=null;a.s.some(function(a){c=a.Od(b);return!!c});return c},jx=function(a){return rc(a.a,"cloud")?"cloud":rc(a.a,"mesi")?"mesi":null},ex=function(){var a=nm().g;return 3E5<=Date.now()-a},dx=function(a,b){var c=jg(b);b=kg(b);if(a.m.f&&!a.m.b&&c)return a.a.onSinkAvailabilityUpdated(a,2),!0;var d=!1;a.f&&a.m.b&&(d=!0);var e;if(e=!chrome.declarativeWebRequest)a=
a.m,e=!(a.f||a.b&&a.a&&(-1!=St.indexOf(a.a)||-1!=St.indexOf(Qt(a))))&&b;return e?!1:d&&(c||b)};bx.prototype.searchSinks=function(a,b){var c=this;if(!dx(this,a))return Promise.reject(Error("err"));a=xt(this.h,b);a.then(function(a){ht(c,[a])});return a};
var mx=function(a,b){b=a.b.get(b);if(!b)return Promise.reject(Error("Route not found"));a=a.Gd(b.sinkId);if("hangouts"!=a&&"meetings"!=a)a=Promise.reject(Error("Unsupported sink channel type"));else{b=es;var c=qg.get("mr.ProviderManager")||null;a=b(c,a)}return a};g=bx.prototype;g.createMediaRouteController=function(a,b,c){return mx(this,a).then(function(d){return d.createMediaRouteController(a,b,c)})};g.provideSinks=function(){};g.ua=function(){return"CloudProvider"};
g.Pa=function(){return[void 0,{cloudEnabled:this.f,cloudOn:this.g,notifiedHangoutsPrivacy:this.v}]};g.Ta=function(){var a=jh(this);a&&(a.cloudEnabled&&(this.f=a.cloudEnabled),a.cloudOn&&(this.g=a.cloudOn),a.notifiedHangoutsPrivacy&&(this.v=a.notifiedHangoutsPrivacy))};var kx=function(a,b){a=new ws(a,b);return Lf(a.start())};bx.prototype.j=kb("mr.CloudProvider");var fx=new Bm("pseudo:cloud","","meeting","","default");var nx=function(){Mk.call(this,12,"ExternalMessageListener","mr.ProviderManager",chrome.runtime.onMessageExternal)};Fa(nx,Mk);nx.prototype.Xg=function(a,b){return b.id&&-1!=ox.indexOf(b.id)?"start"==a.type||"stop"==a.type||"subscribe_log_data"==a.type:!1};nx.prototype.sh=function(){return!0};var qx=function(){px||(px=new nx);return px},px=null,ox=["idmofbkcelhplfjnmmdolenpigiiiecc","ggedfkijiiammpnbdadhllnehapomdge","njjegkblellcjnakomndbaloifhcoccg"];var rx=function(){Mk.call(this,11,"InternalMessageListener","mr.ProviderManager",chrome.runtime.onMessage)};Fa(rx,Mk);rx.prototype.Xg=function(a,b){return"retrieve_log_data"==a.type&&b.id==chrome.runtime.id&&b.url=="chrome-extension://"+b.id+"/feedback.html"};rx.prototype.sh=function(){return!0};var tx=function(){sx||(sx=new rx);return sx},sx=null;function ux(){var a=vx;var b=new Cr(a);var c=new ao(a,b);b=[b,c];b.push(new bx(a));return b};var wx=function(a,b){this.routeId=a;this.message=b},xx=function(a){return"string"!=typeof a.message};var yx=function(a){this.s=a;this.g=this.l=null},zx=function(a){if(null==a.g)if(null==a.l||Date.now()-a.l>=a.s)a.h();else{var b=Math.max(a.l+a.s-Date.now(),5);a.g=setTimeout(a.h.bind(a),b)}};yx.prototype.h=function(){null!=this.g&&(clearTimeout(this.g),this.g=null);this.m();this.l=Date.now()};yx.prototype.m=function(){};var Ax=function(a,b){yx.call(this,20);this.a=new Map;this.b=new Set;this.u=null;this.v=this.f=0;this.w=!1;this.I=a;this.A=b;this.j=kb("mr.RouteMessageSender")};Fa(Ax,yx);Ax.prototype.init=function(a){this.u=a;lh(this)};Ax.prototype.stopListeningForRouteMessages=function(a){this.b.delete(a)};
Ax.prototype.send=function(a,b){var c=this.a.get(a);c||(c=[],this.a.set(a,c));b=new wx(a,b);c.push(b);50<c.length&&1==c.length%50&&u(this.j,function(){return"Message queue length is excessively large "+("("+c.length+") for route "+a)});this.f+=xx(b)?0:b.message.length;xx(b)&&this.v++;Bx(this);this.b.has(a)&&zx(this)};
var Cx=function(a,b){if(0!=b.length){b=la(b);for(var c=b.next();!c.done;c=b.next())c=c.value,a.f-=xx(c)?0:c.message.length,xx(c)&&a.v--}},Bx=function(a){var b=0<a.v||a.f>a.A;b!=a.w&&(a.w=b,a.I.Ke(a.ua(),b))};Ax.prototype.m=function(){if(this.u){for(var a=la(this.b),b=a.next();!b.done;b=a.next()){b=b.value;var c=this.a.get(b);c&&0!=c.length&&(this.u(b,c),Cx(this,c),this.a.set(b,[]))}Bx(this)}else this.j.error("sendMessagesCallback not set. Messages not delivered.")};Ax.prototype.ua=function(){return"mr.RouteMessageSender"};
Ax.prototype.Pa=function(){var a=[].concat(l(this.a.entries())).map(function(a){return[a[0],a[1].map(function(a){return a.message})]});return[new Dx(a,Array.from(this.b),this.f)]};Ax.prototype.Ta=function(){var a=ih(this);if(a){this.a=new Map;for(var b={},c=la(a.b),d=c.next();!d.done;b={routeId:b.routeId},d=c.next())d=d.value,b.routeId=d[0],d=d[1].map(function(a){return function(b){return new wx(a.routeId,b)}}(b)),this.a.set(b.routeId,d);this.b=new Set(a.a);this.f=a.f}};
var Dx=function(a,b,c){this.b=a;this.a=b;this.f=c};var Ex=function(a,b){this.h=null!=b?a.bind(b):a;this.l=this.v.bind(this);this.g=[];this.a=!1;this.b=null};Ex.prototype.f=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];this.g=[].concat(l(b));null==this.b?Fx(this):this.a=!0};var Fx=function(a){a.b=setTimeout(a.l,500);a.h.apply(a,[].concat(l(a.g)))};Ex.prototype.v=function(){this.b=null;this.a&&(this.a=!1,Fx(this))};var Gx=function(a,b){this.type="internal_message";this.routeId=a;this.message=b};var Hx=function(a,b,c){this.a=a;this.g=b;this.f=c;this.onMessage=function(){};c.listen("internal_message",this.b,this)};Hx.prototype.sendMessage=function(a,b){return this.g(this.a,a,b)};Hx.prototype.b=function(a){if(a.routeId==this.a)this.onMessage(a.message)};Hx.prototype.Na=function(){this.onMessage=function(){};this.f.u("internal_message",this.b,this)};
var Ix=new Hx("",function(){return Promise.resolve()},new Ml),Jx=function(a){this.a=a},ss=function(a){var b=Bf,c=b.a.zh(a);return c?new Hx(a,c.sendRouteMessage.bind(c),b.a.Bh()):Ix};var Kx=function(){this.j=kb("mr.ProviderManager");this.b=[];this.a=new Map;this.v=new Map;this.g=new Set;this.l=new Set;this.s=new Map;this.f=this.m=null;this.F=new Ml;this.oa=new Ex(this.Kp,this);this.T=new Ex(this.R,this);this.h=new Ax(this,524288);this.B=0;this.u=new Map;this.I=-1==window.navigator.userAgent.indexOf("Windows");this.A=[];this.w=[];var a=new bs(this);this.N=a.onMessage.bind(a);a=new Sr(this);this.J=a.onMessage.bind(a);this.onBeforeInvokeHandler=this.onBeforeInvokeHandler;this.createRoute=
this.createRoute;this.joinRoute=this.joinRoute;this.connectRouteByRouteId=this.connectRouteByRouteId;this.terminateRoute=this.terminateRoute;this.startObservingMediaSinks=this.startObservingMediaSinks;this.stopObservingMediaSinks=this.stopObservingMediaSinks;this.sendRouteMessage=this.sendRouteMessage;this.sendRouteBinaryMessage=this.sendRouteBinaryMessage;this.startListeningForRouteMessages=this.startListeningForRouteMessages;this.stopListeningForRouteMessages=this.stopListeningForRouteMessages;
this.startObservingMediaRoutes=this.startObservingMediaRoutes;this.stopObservingMediaRoutes=this.stopObservingMediaRoutes;this.detachRoute=this.detachRoute;this.enableMdnsDiscovery=this.enableMdnsDiscovery;this.searchSinks=this.searchSinks;this.provideSinks=this.provideSinks;this.updateMediaSinks=this.updateMediaSinks;this.createMediaRouteController=this.createMediaRouteController};Fa(Kx,pg);
Kx.prototype.handleEvent=function(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];if(a==chrome.runtime.onMessage)this.N.apply(this,[].concat(l(c)));else if(a==chrome.runtime.onMessageExternal)this.J.apply(this,[].concat(l(c)));else throw Error("Unhandled event");};
var es=function(a,b){b=a.s.get(b);return tg(b).then(function(b){b.Ya(a);return b})},Mx=function(a,b,c){b.forEach(function(b){if(Lx(a,b.getName()))u(a.j,"Provider "+b.getName()+" already registered.");else try{b.Ya(c),a.b.push(b),a.u.set(b.getName(),0)}catch(e){u(a.j,"Provider "+b.getName()+" failed to initialize.",e)}})};
Kx.prototype.Ya=function(a,b,c){this.s.set("webrtc","mr.mirror.webrtc.WebRtcService");this.s.set("cast_streaming","mr.mirror.cast.Service");this.s.set("hangouts","mr.mirror.hangouts.HangoutsService");this.s.set("meetings","mr.mirror.hangouts.MeetingsService");var d=new Jx(this);Bf||(Bf=d);this.f=a;this.h.init(this.f.onRouteMessagesReceived.bind(this.f));Mx(this,b,c);lh(this);zg("mr.ProviderManager",this)};
var Ox=function(a,b,c){return new Promise(function(d,e){var f=null;a.B++;Nx(a);f=window.setTimeout(function(){f=null;b.cancel(new cm(2,"timeout after "+c+" ms."))},c);b.a.then(function(b){a.B--;Nx(a);null!=f&&window.clearTimeout(f);d(b)},function(b){a.B--;Nx(a);null!=f&&window.clearTimeout(f);e(b instanceof cm?b:b instanceof Error?new cm(0,b.message,b.stack):new cm(0))})})};Kx.prototype.onBeforeInvokeHandler=function(){gg(0)};
var Px=function(a){return"string"==typeof a?a:a.unique?"":a.scheme+"://"+a.host+"\n       "+(a.port?":"+a.port:"")+"/"};g=Kx.prototype;
g.createRoute=function(a,b,c,d,e,f,h){var k=this;h=void 0===h?!1:h;var m=Qx(this,a,b);if(!m)return Promise.reject(new cm(7,"No provider supports createRoute with source: "+a+" and sink: "+b));var r=void 0;void 0!==d&&(r=Px(d));f=f&&0<f?f:6E4;a=m.createRoute(a,b,c,h,f,r,e);return Ox(this,a,f).then(function(a){return a},function(a){k.j.error("Error creating route.",a);throw a;})};
g.connectRouteByRouteId=function(a,b,c,d,e,f){var h=this.a.get(b);if(!h)return Promise.reject(new cm(7,"No provider supports join "+b));a=h.connectRouteByRouteId(a,b,c,Px(d),e);return Ox(this,a,f&&0<f?f:3E4)};g.joinRoute=function(a,b,c,d,e,f){f=void 0===f?!1:f;var h=Rx(this,a,b);if(!h)return Promise.reject(new cm(7,"No provider supports join "+b));e=e&&0<e?e:3E4;a=h.joinRoute(a,b,f,e,Px(c),d);return Ox(this,a,e)};
g.terminateRoute=function(a){var b=this.a.get(a);return b?Sx(this,a).then(function(){return b.terminateRoute(a)}):Promise.reject(new cm(3,"Route not found for routeId "+a))};g.startObservingMediaSinks=function(a){this.g.has(a)||(this.g.add(a),this.b.forEach(function(b){b.startObservingMediaSinks(a)}));Tx(this,a)};g.stopObservingMediaSinks=function(a){this.g.delete(a)?Ux(this,a):this.j.info("No existing query "+a)};
var Ux=function(a,b){a.b.forEach(function(a){a.stopObservingMediaSinks(b)})},Tx=function(a,b){if("urn:x-org.chromium.media:source:tab:-1"==b)u(a.j,"No sinks for sourceUrn: "+b);else{var c=new Map,d=[];a.b.forEach(function(e){var f=e.kf(b);0<f.sinks.length&&(d=f.origins);f.sinks.forEach(function(b){c.has(b.id)?u(a.j,"Detected duplicate sink "+b.id+" from provider: "+e.getName()):c.set(b.id,b)})});Vx(a,b,Array.from(c.values()),d||[])}},Vx=function(a,b,c,d){a.j.info("Sending "+c.length+" sinks to MR for "+
b);a.f.onSinksReceived(b,c,d.map(yp))};g=Kx.prototype;g.sendRouteMessage=function(a,b,c){var d=this.a.get(a);d?(a=d.sendRouteMessage(a,b,c),a=Ox(this,Lf(a),3E4)):a=Promise.reject(Error("Invalid route ID "+a));return a};g.sendRouteBinaryMessage=function(a,b){var c=this.a.get(a);c?(a=c.sendRouteBinaryMessage(a,b),a=Ox(this,Lf(a),3E4)):a=Promise.reject(Error("Invalid route ID "+a));return a};
g.startListeningForRouteMessages=function(a){var b=this.h;b.b.has(a)||(b.b.add(a),(a=b.a.get(a))&&0<a.length&&zx(b))};g.stopListeningForRouteMessages=function(a){this.h.stopListeningForRouteMessages(a)};g.detachRoute=function(a){var b=this.a.get(a);b?b.detachRoute(a):this.j.info("Route "+a+" does not exist.")};g.enableMdnsDiscovery=function(){this.I=!0;this.A.forEach(function(a){a()});this.A.length=0};
var Qx=function(a,b,c){return a.b.find(function(a){return a.cf(b,c)})||null},Rx=function(a,b,c){return a.b.find(function(a){return a.fe(b,c)})||null};Kx.prototype.R=function(){var a=this;this.g.forEach(function(b){Tx(a,b)})};var Nx=function(a){a.f.setKeepAlive(0<a.B||0<a.w.length)};g=Kx.prototype;g.startObservingMediaRoutes=function(a){this.l.has(a)||(this.l.add(a),this.b.forEach(function(b){b.startObservingMediaRoutes(a)}));this.oa.f()};
g.stopObservingMediaRoutes=function(a){this.l.delete(a)?this.b.forEach(function(b){b.stopObservingMediaRoutes(a)}):this.j.info("No existing route query "+a)};g.Kp=function(){var a=this;if(0!=this.l.size){var b=[];this.b.forEach(function(a){b=b.concat(a.Ld())});this.l.forEach(function(c){var d=[];a.b.forEach(function(a){a.Ld().forEach(function(b){!b.je&&a.fe(c,void 0,b)&&d.push(b.id)})});a.f.onRoutesUpdated(b,c,d)})}};g.ua=function(){return"ProviderManager"};
g.Pa=function(){return[new Wx(this.b.map(function(a){return a.getName()}),Array.from(this.g),Array.from(this.l),Array.from(this.a,function(a){var b=la(a);a=b.next().value;b=b.next().value;return[a,b.getName()]}),Array.from(this.u),this.I,this.m)]};g.Ta=function(){var a=ih(this);if(a){this.g=new Set(a.h);this.l=new Set(a.g);for(var b=la(a.f),c=b.next();!c.done;c=b.next()){var d=la(c.value);c=d.next().value;d=d.next().value;d=Lx(this,d);this.a.set(c,d)}this.u=new Map(a.l);this.m=a.a||null;a.b&&this.enableMdnsDiscovery()}};
g.zh=function(a){return this.a.get(a)};g.He=function(a,b){this.a.set(b.id,a);this.od(b)};g.yf=function(a){Sx(this,a.id);this.a.delete(a.id);var b=this.h,c=a.id;b.b.delete(c);var d=b.a.get(c);d&&(b.a.delete(c),Cx(b,d),Bx(b));this.od(a)};g.od=function(){0<this.l.size&&this.oa.f()};g.ai=function(a){this.a.get(a.id)&&this.od(a)};g.nd=function(a,b){this.a.has(a)?("string"===typeof b||b instanceof Uint8Array||(b=JSON.stringify(b)),this.h.send(a,b)):u(this.j,"Got route message for closed route "+a)};
g.onPresentationConnectionStateChanged=function(a,b){"terminated"==b&&this.h.h();this.f.onPresentationConnectionStateChanged(a,b)};g.onPresentationConnectionClosed=function(a,b,c){this.h.h();this.f.onPresentationConnectionClosed(a,b,c)};g.bi=function(a){this.v.delete(a);var b=this.a.get(a);b&&b.terminateRoute(a)};g.Jg=function(a,b){Nl(this.F,new Gx(a,b))};g.Bc=function(){this.T.f()};
g.onSinkAvailabilityUpdated=function(a,b){var c=this;if(this.u.get(a.getName())!=b){var d=Xx(this);this.u.set(a.getName(),b);a=Xx(this);d!=a&&(0==a&&this.R(),this.f.onSinkAvailabilityUpdated(a),0==a&&(this.g.forEach(function(a){Ux(c,a)}),this.g.clear()))}};var Xx=function(a){return Array.from(a.u.values()).reduce(function(a,c){return Math.max(a,c)},0)};Kx.prototype.Bh=function(){return this.F};Kx.prototype.Nd=function(a){this.f.onIssue(a)};
var Sx=function(a,b){return a.v.has(b)?es(a,a.v.get(b)).then(function(c){a.v.delete(b);return Cg(c)}):Promise.resolve(!1)};g=Kx.prototype;g.Th=function(a,b,c,d){var e=this,f=a.Gd(b.sinkId);this.j.info("Starting mirroring using service: "+f);this.v.set(b.id,f);return Mf(es(this,f),function(h){e.m=f;return If(Fg(h,b,b.mediaSource,a.se(b.sinkId),c,d),function(a){if(a instanceof Wf&&3==a.reason)throw new cm(8);throw a;})})};
g.ik=function(a,b,c,d,e,f){var h=this,k=this.v.get(b.id);return k?Mf(es(this,k),function(m){h.m=k;var r=a.se(b.sinkId);m.H.info("Update mirroring on route "+b.id);return m.g?Lf(Bg(c,e).then(m.B.bind(m,b,c,r,d,f))):Kf(Error("Not initialized"))}):Kf(Error("Route "+b.id+" is not mirroring"))};g.ri=function(a){this.I?a():-1==this.A.indexOf(a)&&this.A.push(a)};g.Nh=function(){return this.I};g.Ke=function(a,b){var c=this.w.indexOf(a),d=0<=c;b&&!d?this.w.push(a):!b&&d&&this.w.splice(c,1);Nx(this)};
var Lx=function(a,b){return a.b.find(function(a){return a.getName()==b})||null};g=Kx.prototype;g.searchSinks=function(a,b,c){var d=a.startsWith("pseudo:")?a.substring(7):null;return(d=d?Lx(this,d):null)?d.searchSinks(b,c).then(function(a){return a.id}):Promise.reject(Error("No provider supports "+a))};g.provideSinks=function(a,b){var c=Lx(this,a);c?c.provideSinks(b):this.j.error("provideSinks: Provider not found for providerName "+a)};g.updateMediaSinks=function(a){this.g.has(a)||Tx(this,a)};
g.createMediaRouteController=function(a,b,c){var d=this,e=this.a.get(a);return e?e.createMediaRouteController(a,b,c).catch(function(a){d.j.error("createMediaRouteController failed: "+a.message);b.close();c.ptr.reset();throw a;}):(a="createMediaRouteController: Provider not found for "+a,this.j.error(a),b.close(),c.ptr.reset(),Promise.reject(Error(a)))};g.onMediaRemoterCreated=function(a,b,c){this.f.onMediaRemoterCreated(a,b,c)};
var Wx=function(a,b,c,d,e,f,h){this.h=b;this.g=c;this.f=d;this.l=e;this.b=f;this.a=h};
