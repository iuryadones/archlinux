<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Full Hacker News</title>
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <link rel="stylesheet" href="css/style.css">
    <link rel="apple-touch-icon" href="apple-touch-icon.png">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-41968904-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-41968904-1');
    </script>
</head>
<body>
<div id="reload">
    <a href=".">Reload to view new articles</a>
</div>
<header>
    <h1>Full Hacker News <img src="/css/img/loader.gif" width="16" height="16" class="loader"></h1>
    <p>
        Last update: <span id="lastupdate" title="Thu, 18 Jan 2018 17:00:10 +0000">Thu, 18 Jan 2018 17:00:10 +0000</span>
    </p>
</header>
<div role="main" class="main">
    <ul class="toc" id="toc">
        <li><a href="#article-1">Venezuelan Hyperinflation Explodes, Soaring Over 440,000 Percent</a></li>
        <li><a href="#article-2">Why Walkable Streets Are More Economically Productive</a></li>
        <li><a href="#article-3">Inventor Claims to Have Solved Floating Point Error Problem</a></li>
        <li><a href="#article-4">China’s Economic Growth Looks Strong, Maybe Too Strong</a></li>
        <li><a href="#article-5">For These Young Entrepreneurs, Silicon Valley Is, Like, Lame</a></li>
        <li><a href="#article-6">Bypassing CloudFlare using Internet-wide scan data</a></li>
        <li><a href="#article-7">Client cheques that I rejected</a></li>
        <li><a href="#article-8">'Text bomb' is latest Apple bug</a></li>
        <li><a href="#article-9">Permutive (YC S14) is hiring a front end product engineer (Elm) in London</a></li>
        <li><a href="#article-10">Amazon announces candidate cities for HQ2</a></li>
        <li><a href="#article-11">A modest primer for Ethereum programming</a></li>
        <li><a href="#article-12">Fuze for Nintendo Switch: An easy-to-learn text-based programming language</a></li>
        <li><a href="#article-13">Piknik – Copy and paste anything over the network</a></li>
        <li><a href="#article-14">Stream Processing for Go</a></li>
        <li><a href="#article-15">The Fall of Travis Kalanick</a></li>
        <li><a href="#article-16">Emirates Orders 20 A380s Worth $9B</a></li>
        <li><a href="#article-17">Librem 5 Phone Progress Report</a></li>
        <li><a href="#article-18">Indistinguishable from Magic: Manufacturing Modern Computer Chips (2012) [video]</a></li>
        <li><a href="#article-19">Intel: Firmware Updates and Initial Performance Data for Data Center Systems</a></li>
        <li><a href="#article-20">Show HN: AirHelp flight scanner finds all past flights and checks for eligibility</a></li>
        <li><a href="#article-21">Cape Town could be the first city to run out of water</a></li>
        <li><a href="#article-22">It is possible to detect and block Chrome headless</a></li>
        <li><a href="#article-23">TIS-100 Signal Averager (2016) [video]</a></li>
        <li><a href="#article-24">The Neopets HTML Guide</a></li>
        <li><a href="#article-25">JS Paint – A web-based MS Paint remake</a></li>
        <li><a href="#article-26">North Korea’s fabric made of stone</a></li>
        <li><a href="#article-27">Urban Housing Solution That Has No Good Name</a></li>
        <li><a href="#article-28">The Real Adam Smith</a></li>
        <li><a href="#article-29">Building Cross-Lingual End-to-End Product Search with Tensorflow</a></li>
        <li><a href="#article-30">End of the conference era</a></li>
    </ul>

    <article id="article-1" class="hn-article" data-index="1">
        <h1 class="title">
            <a href="https://www.bloomberg.com/news/articles/2018-01-18/venezuelan-hyperinflation-explodes-soaring-over-440-000-percent">
                Venezuelan Hyperinflation Explodes, Soaring Over 440,000 Percent
            </a>
        </h1>
        <p class="meta">
            <a href="https://www.bloomberg.com/news/articles/2018-01-18/venezuelan-hyperinflation-explodes-soaring-over-440-000-percent">www.bloomberg.com</a>
            -
            <a href="https://news.ycombinator.com/item?id=16178407" target="_blank">Comments</a>
        </p>
        <div>
            <div>
            <p>If there was any doubt about whether Venezuela had sunk into an inflationary spiral, it’s gone now.</p><p>The price of a cup of coffee in <a href="https://www.bloomberg.com/features/2016-venezuela-cafe-con-leche-index/" title="The Cafe Con Leche Index">Bloomberg’s Cafe Con Leche Index</a> has risen six of the past 12 weeks. During that period, the cost climbed from 5,500 bolivars to 45,000 bolivars. That’s an increase of 718 percent. Translated into an annualized pace, it comes to 448,025 percent. (As breathtaking a figure as this is, it is still a far cry from the worst hyperinflation <a href="https://object.cato.org/sites/cato.org/files/pubs/pdf/workingpaper-8.pdf" title="CATO Institute Report on Hyperinflation">episodes</a> in history, like those in Hungary in the 1940s or Zimbabwe last decade.)</p><p>The index’s explosion underscores how the socialist government’s frantic bid to goose the economy by printing reams of cash is only adding to the chaos and suffering in the country. </p>
        
        <p>Inflation had been alarmingly high in recent years but nowhere near the current pace. The Cafe Con Leche Index -- which Bloomberg created after the government stopped releasing most economic indicators -- put the rate at 1,718 percent at the end of 2017.</p><p><em>— With assistance by Alexander McIntyre</em></p>
        </div>
        </div>
    </article>
    <article id="article-2" class="hn-article" data-index="2">
        <h1 class="title">
            <a href="https://www.strongtowns.org/journal/2018/1/16/why-walkable-streets-are-more-economically-productive">
                Why Walkable Streets Are More Economically Productive
            </a>
        </h1>
        <p class="meta">
            <a href="https://www.strongtowns.org/journal/2018/1/16/why-walkable-streets-are-more-economically-productive">www.strongtowns.org</a>
            -
            <a href="https://news.ycombinator.com/item?id=16177916" target="_blank">Comments</a>
        </p>
        <div>
            <div><p>Streets where walking is easy and safe are not just economically significant because of their impact on retail sales or tax values, though. They are also economically significant because of their incredibly high return on public investment. The cost of paving sidewalks for people or even providing enhancements to pedestrian space such as trees and benches is minuscule compared with the cost of paving wide roads for cars, installing traffic signals, paying the salaries of traffic cops, etc.</p><p>Furthermore, the wear and tear caused by foot traffic is also negligible compared with the wear and tear caused by car and truck traffic, meaning that long-term maintenance costs for walk-friendly areas are also much lower than for auto-oriented places. (Ironically, most cities spend exponentially more on their roads while utterly neglecting their sidewalks.)</p><p>In short, a simple sidewalk could serve millions of people traveling on foot for decades, even centuries, with only a small amount of up-front investment and minimal maintenance costs for the city — yet it would support dozens or hundreds of local businesses. The same length of street designed primarily for cars would cost exponentially more to build and keep up and would only serve a handful of businesses.</p><p>And if that’s not enough to convince you, note that not only is walk infrastructure more affordable to build and maintain in and of itself, the businesses and homes that exist in walkable areas <em>also</em> provide a better return on investment than the buildings in auto-oriented areas. Below, two streets — one people-oriented and one auto-oriented — illustrate this.</p></div>
        </div>
    </article>
    <article id="article-3" class="hn-article" data-index="3">
        <h1 class="title">
            <a href="https://www.hpcwire.com/2018/01/17/inventor-claims-solved-floating-point-error-problem/">
                Inventor Claims to Have Solved Floating Point Error Problem
            </a>
        </h1>
        <p class="meta">
            <a href="https://www.hpcwire.com/2018/01/17/inventor-claims-solved-floating-point-error-problem/">www.hpcwire.com</a>
            -
            <a href="https://news.ycombinator.com/item?id=16177832" target="_blank">Comments</a>
        </p>
        <div>
            <div>
		<p>“The decades-old floating point error problem has been solved,” proclaims a <a href="http://www.boundedfloatingpoint.com/PressRelease_011718.pdf">press release</a> from inventor Alan Jorgensen. The computer scientist has filed for and received a patent for a “processor design, which allows representation of real numbers accurate to the last digit.” The patent (No. 9,817,662, “Apparatus for Calculating and Retaining a Bound on Error During Floating Point Operations and Methods Thereof”) was issued on November 14, 2017.</p>
<img class="wp-image-46154" src="https://6lli539m39y3hpkelqsm3c2fg-wpengine.netdna-ssl.com/wp-content/uploads/2018/01/Alan-Jorgensen-LI-image.jpg" alt="" width="155" height="155" />Alan Jorgensen
<p>Jorgensen presents his bounded floating point system as “a game changer for the computing industry,” tackling a pernicious problem that (as he cites) has been implicated in catastrophic failures, including the <a href="https://en.wikipedia.org/wiki/MIM-104_Patriot#Failure_at_Dhahran">1991 Patriot missile failure</a>, which resulted in 28 U.S. military deaths.</p>
<p>The inventor patented a process that addresses floating point errors by computing “two limits (or bounds) that contain the represented real number. These bounds are carried through successive calculations. When the calculated result is no longer sufficiently accurate the result is so marked, as are all further calculations made using that value.”</p>
<p>Jorgensen says the method performs in real time and can operate in conjunction with existing hardware and software. Also, converting between existing standardized floating point and this new bounded floating point format can be done with simple operations, he says.</p>
<p>Unreported floating point errors are relevant for highly compute-intensive functions, especially where accuracy and safety are paramount, such as weather prediction, GPS, autonomous vehicles and finance. Jorgenson claims that his system guarantees accuracy of floating point values to plus or minus one in the last digit.</p>
<p>The invention is said to provide error information with minimal impact to performance or memory space compared with current methods. “In the current art, static error analysis requires significant mathematical analysis and cannot determine actual error in real time,” reads a section of the patent. “This work must be done by highly skilled mathematician programmers. Therefore, error analysis is only used for critical projects because of the greatly increased cost and time required. In contrast, the present invention provides error computation in real time with, at most, a small increase in computation time and a small increase in the maximum number of bits available for the significand.”</p>
<p>Read <a href="http://boundedfloatingpoint.com/US9817662_Jorgensen.pdf">the patent filing in-full here</a>.</p>
<p>The abstract offers a few more details:</p>
<p><em>The apparatus and method for calculating and retaining a bound on error during floating point operations inserts an additional bounding field into the standard floating-point format that records the retained significant bits of the calculating with notification upon insufficient retention. The bounding field, which accounts for both rounding and cancellation errors, has two parts, the lost bits D Field and the accumulated rounding error R Field. The D Field states the number of bits in the floating point representation that are no longer meaningful. The bounds on the real value represented are determined from the truncated floating point value (first bound) and the addition of the error determined by the number of lost bits (second bound). The true, real value is absolutely contained by the first and second bounds. The allowed loss (optionally programmable) of significant bits provides a fail-safe, real-time notification of loss of significant bits.</em></p>
<p><img class="alignnone size-full wp-image-46153" src="https://6lli539m39y3hpkelqsm3c2fg-wpengine.netdna-ssl.com/wp-content/uploads/2018/01/Jorgensen-Bounded-Floating-Point-patent-fig1.png" alt="" width="1200" height="846" /></p>
<p>According to Jorgensen’s LinkedIn profile, he has a PhD in Computer Science and is a part time instructor at the University of Nevada, Las Vegas (UNLV) where he teaches computer science to non-computer science students.</p>
<div class="sharing-container">
<h4>Share this:</h4>




<div class="sharing-button"><a href="//www.reddit.com/submit?url=https://www.hpcwire.com/2018/01/17/inventor-claims-solved-floating-point-error-problem/"><img src="https://www.redditstatic.com/spreddit7.gif" alt="submit to reddit" style="border:0px solid;" /> </a></div>
</div>
<span class="et_social_bottom_trigger"></span>	</div>
        </div>
    </article>
    <article id="article-4" class="hn-article" data-index="4">
        <h1 class="title">
            <a href="https://www.nytimes.com/2018/01/18/business/china-gdp-economy-growth.html">
                China’s Economic Growth Looks Strong, Maybe Too Strong
            </a>
        </h1>
        <p class="meta">
            <a href="https://www.nytimes.com/2018/01/18/business/china-gdp-economy-growth.html">www.nytimes.com</a>
            -
            <a href="https://news.ycombinator.com/item?id=16177816" target="_blank">Comments</a>
        </p>
        <div>
            <div>
        <p class="story-body-text story-content">China’s annual growth figures have long been quite steady. Other large countries have had somewhat steadier growth than usual in the last several years. But China’s quarterly growth figures are suspiciously smooth, unlike quarterly growth in many other countries.</p><p class="story-body-text story-content">Politics are a major reason. Local officials often face pressure to meet targets from the central government. At the first hint of economic weakness, they have tended to step up spending to stabilize economic output.</p><p class="story-body-text story-content">Increasingly, China is owning up to data shortcomings, particularly in provincial data. The region of Inner Mongolia revealed this month that <a href="http://www.xinhuanet.com/2018-01/03/c_1122206020.htm">two-fifths of the industrial production</a> it reported for 2016 did not exist. A year ago, Liaoning Province in northeastern China revealed that local governments had <a href="https://www.nytimes.com/2017/01/19/business/china-gdp-economic-growth.html">padded their economic growth statistics</a> from 2011 to 2014.</p><p class="story-body-text story-content">Tianjin, a sprawling metropolis, briefly posted on one of its official websites last week that previous data had been inflated. The post was quickly deleted.</p><p class="story-body-text story-content">Ning Jizhe, the director of the National Bureau of Statistics, said at a news conference on Thursday afternoon in Beijing that there had long been discrepancies between provincial and national data, but that the gap had been narrowing. “Local data will not influence the reliability of national statistics data,” he said.</p><p class="story-body-text story-content">It can work the other way, too: Some economists cite evidence that China also understates its growth during booms to smooth its results.</p><div class="story-ad ad ad-placeholder nocontent robots-nocontent">
    
<a class="visually-hidden skip-to-text-link" href="#story-continues-8">Continue reading the main story</a>
</div>
<h4 class="story-subheading story-content">Slower Than Stated?</h4>        <a class="visually-hidden skip-to-text-link" href="#story-continues-8">Continue reading the main story</a>
    </div>
        </div>
    </article>
    <article id="article-5" class="hn-article" data-index="5">
        <h1 class="title">
            <a href="https://www.wsj.com/articles/for-these-entrepreneurs-silicon-valley-is-like-lame-1516270601">
                For These Young Entrepreneurs, Silicon Valley Is, Like, Lame
            </a>
        </h1>
        <p class="meta">
            <a href="https://www.wsj.com/articles/for-these-entrepreneurs-silicon-valley-is-like-lame-1516270601">www.wsj.com</a>
            -
            <a href="https://news.ycombinator.com/item?id=16177768" target="_blank">Comments</a>
        </p>
        <div>
            <div>
    

 <p>Last week, a group of Chinese startup founders and investors made a pilgrimage to Silicon Valley. They toured a Tesla assembly line, complained to senior Apple executives about its slow app-reviewing process in China and brunched on baked eggs and avocado at Russian billionaire investor Yuri Milner’s hilltop mansion.</p> <p>Silicon Valley has loomed large in China’s tech world in the past two decades. China’s internet industry started by copying Silicon Valley technologies and business models. That’s why there’s the Google of China...
  </p></div>
        </div>
    </article>
    <article id="article-6" class="hn-article" data-index="6">
        <h1 class="title">
            <a href="https://blog.christophetd.fr/bypassing-cloudflare-using-internet-wide-scan-data/">
                Bypassing CloudFlare using Internet-wide scan data
            </a>
        </h1>
        <p class="meta">
            <a href="https://blog.christophetd.fr/bypassing-cloudflare-using-internet-wide-scan-data/">blog.christophetd.fr</a>
            -
            <a href="https://news.ycombinator.com/item?id=16177651" target="_blank">Comments</a>
        </p>
        <div>
            <div>
<p>CloudFlare is a service that acts as a middleman between a website and its end users, protecting it from various attacks. Unfortunately, those websites are often poorly configured, allowing an attacker to entirely bypass Cloudflare and run DDoS attacks or exploit web-based vulnerabilities that would otherwise be blocked. This post demonstrates the weakness and introduces <em>CloudFlair</em>, an automated detection tool.</p>

<p> </p>
<a href="https://blog.christophetd.fr/wp-content/uploads/2018/01/cloud-143152_1920.jpg"><img class="wp-image-669 size-large" src="https://blog.christophetd.fr/wp-content/uploads/2018/01/cloud-143152_1920-1024x607.jpg" alt="" width="720" height="427" /></a>A cloud hiding the sun from plain sight. Photo from <a href="https://pixabay.com/fr/nuage-ciel-jaune-rayon-sunshine-143152/">Pixabay</a>.
<p><a href="https://cloudflare.com">CloudFlare</a> allows websites to protect against all sorts of attacks. It can also act as a Web Application Firewall (WAF) to block the exploitation of web-based vulnerabilities such as XSS and SQL injections. It gained even more traction recently by <a href="https://blog.cloudflare.com/unmetered-mitigation/">announcing unmetered mitigation of DDoS attacks</a>: CloudFlare is essentially stating they will protect their customers against DDoS attacks of any scale without charging any extra, no matter what pricing plan they are on (including the free one).</p>
<p>In the past few weeks, I found that multiple websites using CloudFlare were misconfigured, and allowed an attacker to bypass any CloudFlare protection in place easily. Several of the companies behind these websites had more than 1 million users and were among the top companies of their market segment.</p>
<div>


<p><em>Some of the vulnerable companies had a public bug bounty program</em></p>
</div>
<p> </p>
<p>To be clear, this article is not talking about a vulnerability in the CloudFlare service itself, but rather about a <em>configuration mistake</em> commonly made by website owners protecting their website with CloudFlare.</p>
<p><em>Note: A few minutes before publishing this article, someone brought to my attention that a <a href="http://www.chokepoint.net/2017/10/exposing-server-ips-behind-cloudflare.html">similar piece</a> had been written a few months ago. I am publishing it nonetheless because I believe it can help raise awareness on the topic (and I spent too much time writing it anyway).</em></p>
</div><div>
<div>

<h2><span>Background: protecting a website with CloudFlare</span></h2>
<p>Here’s what a typical request flow looks like for a website which is not protected by CloudFlare.</p>
<ol>
<li>The user contacts the DNS server of the website’s hosting provider, and asks for the IP of <tt>example.com</tt></li>
<li>The DNS server responds with the IP of the web server hosting <tt>example.com</tt> (e.g., <tt>93.184.216.34</tt>)</li>
<li>The user makes an HTTP request to that web server</li>
<li>The web server responds with the web page</li>
</ol>
<a href="https://blog.christophetd.fr/wp-content/uploads/2018/01/Without-CloudFlare-1.png"><img class="wp-image-565 size-full" src="https://blog.christophetd.fr/wp-content/uploads/2018/01/Without-CloudFlare-1.png" alt="" width="674" height="458" /></a>Typical request flow for a website not protected by CloudFlare
<p>Since anyone can directly access the web server hosting <tt>example.com</tt>, an attacker can potentially harm the website by running a DDoS attack against it. If the infrastructure behind<tt> example.com</tt> is not large enough to absorb or block the traffic, the site can be completely knocked out.</p>
<p>When a company (or individual) decides to use CloudFlare to protect its website, it</p>
<ol>
<li>goes to its domain registrar, and sets the DNS servers to CloudFlare’s (e.g., <tt>kim.ns.cloudflare.com</tt>) ;</li>
<li>sets up its CloudFlare account to work with the domain name (e.g., <tt>mycompany.com</tt>).</li>
</ol>
<p>Now, when a user accesses <tt>mycompany.com</tt>, the following happens.</p>
<ol>
<li>The user contacts the DNS server <tt>kim.ns.cloudflare.com</tt>, and asks for the IP of <tt>mycompany.com</tt></li>
<li>The DNS server responds with the IP <span>of an intermediary CloudFlare server</span> (e.g., <tt>104.16.109.208</tt>)</li>
<li>The user makes an HTTP request to this server</li>
<li>CloudFlare checks the legitimacy of the request (presence of malicious-looking content, source IP address, in addition to other factors), and decides whether to let the request pass through or block it</li>
<li>If CloudFlare chooses to allow the request to pass through, it forwards it to the real web server responsible for <tt>mycompany.com</tt> (e.g., <tt>188.226.197.73</tt>). This server is commonly called the <strong>origin server</strong>.</li>
</ol>
<a href="https://blog.christophetd.fr/wp-content/uploads/2018/01/With-CloudFlare.png"><img class="wp-image-567 size-full" src="https://blog.christophetd.fr/wp-content/uploads/2018/01/With-CloudFlare.png" alt="" width="1029" height="470" /></a>Request flow for a website using CloudFlare
<p>In theory, an attacker can not access the origin server directly, and in particular, does not know its IP address. However, <strong>this protection relies on the origin server being only accessible through CloudFlare</strong>.</p>
<p>For this protection to work, an attacker must not be able to access the origin server directly. Otherwise, it can just contact the origin server without passing through CloudFlare, and bypass any protection.</p>
<h2><span>Exposed origin servers</span></h2>
<p>The proper way an origin server behind CloudFlare should behave is only to accept traffic coming from <a href="https://www.cloudflare.com/ips/">CloudFlare’s IP ranges</a>. However, many origin servers are gladly taking incoming traffic from any source. I believe this is partly due to the lack of emphasis on this issue in CloudFlare’s documentation. The closest thing I found in the docs lies in a page entitled <a href="https://support.cloudflare.com/hc/en-us/articles/201897700-Step-4-Recommended-First-Steps-for-all-Cloudflare-users"><em>Recommended First Steps for all Cloudflare users</em></a>:</p>
<blockquote><p><strong>Step 1: Whitelist Cloudflare’s IP addresses</strong></p>
<p>Once you’ve <a href="https://support.cloudflare.com/hc/en-us/articles/205195708">changed your name servers to Cloudflare</a>, web traffic will be routed through Cloudflare’s network. Hooray! This means that your webserver will see a lot of traffic proxied through Cloudflare, and in order to allow all this traffic to access it, <strong>you will need to make sure that Cloudflare IPs are whitelisted and not rate-limited in any way on your server</strong> (you can ask about this at your host). We have a <a href="https://www.cloudflare.com/ips/">page with all the CloudFlare IPs</a>.</p></blockquote>
<p>(emphasis mine)</p>
<p>As you can read, this only tells system administrators to whitelist CloudFlare’s IP addresses, without explicitly instructing to block the incoming traffic coming from other sources. The post from CloudFlare’s blog <em><a href="https://blog.cloudflare.com/ddos-prevention-protecting-the-origin/">DDoS Prevention: Protecting The Origin</a></em> makes it even worse in my opinion, by implying that keeping the IP address of the origin server “secret” is enough.</p>
<blockquote><p>CloudFlare doesn’t stop clever attackers who know your IP address from sending traffic to it directly. Just because your origin server’s IP address is no longer advertised over DNS, it’s still connected to the internet. <strong>If your IP address is not kept secret</strong>, attackers can bypass the CloudFlare network and attack your servers directly.</p></blockquote>
<p>(emphasis mine)</p>
<p>To sum up – a publicly accessible origin server is safe… as long as nobody finds its IP addresses.</p>
<h2><span>Internet-wide scan data with Censys</span></h2>
<p>Unfortunately, in 2018, relying on someone not finding your IP address is a bit optimistic to say the least. Projects like <span> </span><a href="https://shodan.io">Shodan</a><span> or </span><a href="https://censys.io">Censys</a><span> continuously scan the Internet and make their data accessible to anyone for free.</span></p>
<p>As a random example, it takes about one second to retrieve a list of all the HTTP servers on the Internet who return a page with a title containing <tt>Nicolas Cage</tt> or <tt>Rick Astley</tt>.</p>
<a href="https://blog.christophetd.fr/wp-content/uploads/2018/01/censys.png"><img class="wp-image-575 size-large" src="https://blog.christophetd.fr/wp-content/uploads/2018/01/censys-1024x499.png" alt="" width="720" height="351" /></a>An example of a Censys search (click to enlarge)
<p>Censys is very well-suited to find exposed origin servers efficiently. The following sections describe a method to detect exposed origin servers of a specific domain, using Censys.</p>
<h2><span>Finding exposed origin servers of a domain with Censys</span></h2>
<p>An efficient way to find publicly accessible origin servers is to use their SSL certificate. Using Censys <a href="https://censys.io/certificates">Certificate search feature</a>, we can search for valid SSL certificates for a specific domain name. Censys collects those certificates from multiple sources (direct probe on port 443, and logs of the <a href="https://www.certificate-transparency.org/">Certificate Transparency project</a>).</p>
<p>For instance, the query <span><span>parsed.names: reddit.com and tags.raw: trusted</span></span> can be used to find valid certificates issued to <span><span>reddit.com</span></span> or one of its subdomains. Here’s a <a href="https://censys.io/certificates?q=parsed.names%3A+reddit.com+and+tags.raw%3A+trusted">direct link</a> to the associated Censys search.</p>
<a href="https://blog.christophetd.fr/wp-content/uploads/2018/01/reddit.png"><img class="wp-image-579 size-large" src="https://blog.christophetd.fr/wp-content/uploads/2018/01/reddit-1024x508.png" alt="" width="720" height="357" /></a>Finding SSL certificates issued to reddit.com and its subdomains (click to enlarge)
<p>As you can see, Censys found 7 individual certificates. If you click on one, you will have the option to find all IPv4 hosts that were found to present this certificate when probed on port 443.</p>
<p><a href="https://blog.christophetd.fr/wp-content/uploads/2018/01/Untitled-drawing-4.png"><img class="aligncenter wp-image-578" src="https://blog.christophetd.fr/wp-content/uploads/2018/01/Untitled-drawing-4.png" alt="" width="400" height="486" /></a></p>
</div>
<a href="https://blog.christophetd.fr/wp-content/uploads/2018/01/reddit2.png"><img class="wp-image-580 size-large" src="https://blog.christophetd.fr/wp-content/uploads/2018/01/reddit2-1024x508.png" alt="" width="720" height="357" /></a>Finding IPv4 hosts using a specific SSL certificate (click to enlarge)
<p>In this <a href="https://censys.io/ipv4?q=36f755363ad6e03d63d9db05faf961be5691efb607e673318a9096cc87815a0a">view, </a>we can see all IPv4 hosts using the SSL certificate whose SHA256 fingerprint is 36f7[…]815a0a.</p>
<p>This simple method to search for IPv4 hosts using SSL certificates issued to a specific domain can be used to find exposed origin servers.</p>
<ul>
<li>Search for SSL certificates issued to <tt>mytarget.tld</tt></li>
<li>Find all IPv4 hosts using one of these certificates</li>
<li>Check if these hosts seem to be origin servers of <tt>mytarget.tld</tt></li>
</ul>
<h3><span>Checking if a host is a (likely) origin</span></h3>
<p>Once we have a list of potential origin servers, the next question is: how do we assess if a host is an origin server of a specific CloudFlare protected domain? There is no silver bullet here since only a company’s sysadmins will be able to tell for sure, but some basic heuristics can help.</p>
<p>First, the IP of the candidate host should not fall into CloudFlare IP ranges, otherwise, we have just found the CloudFlare server which acts as a middleman between the end-users and the origin server. Then, the HTML response of the candidate host should be similar to the response we get when accessing the website using its standard domain name (e.g., <tt>mytarget.tld</tt>). I say <em>similar</em> because exact equality is too strict here, since it is common that parts of the same webpage change every time – CSRF tokens, session identifiers, and so on.</p>
<p>Once we find a set of hosts matching these criteria, we can be quite confident we have found a set of exposed origin servers. Of course, these hosts could be very similar to <tt>mytarget.tld</tt> but actually be development or staging instances. We cannot know with 100 % confidence, but what can help is to browse to the candidate host’s IP directly, and see if it behaves like the production website accessible via <tt>mytarget.tld</tt>: can you register an account on it? Can you login to an account you created from <tt>mytarget.tld</tt>, and vice versa? If the answer is yes, you should be pretty confident you found an origin server which shouldn’t be publicly exposed.</p>
<p>Keep in mind that accessing an origin server by entering directly its IP in your browser’s address bar will sometimes not work, as the web server running on it might be expecting an HTTP <tt>Host</tt> header. When this is the case, you can add a static mapping to your hosts file or query the origin server with a tool like curl or Postman which allows you to set specific <tt>Host</tt> headers.</p>
<h3><span>Automating the process with CloudFlair</span></h3>
<p>This process can be cumbersome when done manually; to help automate it, I wrote a tool called <a href="https://github.com/christophetd/CloudFlair">CloudFlair</a>. It uses the Censys API to search for SSL certificates and associated IPv4 hosts. Once it has retrieved a list of potential origin servers using the method previously described, it will call each one of them and compute the similarity of the response with the response sent by the original domain. It uses a structural similarity function designed on purpose for comparing web pages (described <a href="https://github.com/matiskay/html-similarity">here</a>), since standard string similarity functions such as the Levenshtein distance are too slow to work with strings of the size of a typical web page.</p>
<p>Here’s a sample output.</p>

<p>Once you get a list of likely origin servers, you might still have to make a few manual checks to confirm the result.</p>
<h2><span>Remediation</span></h2>
<p><strong>Update:</strong> After CloudFlare’s CTO <a href="https://twitter.com/jgrahamc/status/954007744838856705">pointed it out on Twitter</a>, the best mitigation in the future will probably be to use <a href="https://www.cloudflare.com/products/cloudflare-warp/">CloudFlare Warp</a>. This feature is currently still in beta, but it’s probably going to be a real game-changer regarding this issue. I did not look into in detail, but essentially it’s making the IP of your origin server routable only from the CloudFlare network.</p>
<p>If your website is vulnerable to the weakness discussed in this post, there is most likely no easy way to fix it. <strong>Once the IP of an origin server has leaked, it’s game over. </strong>The data used by Censys is versioned, and anyone can <a href="https://censys.io/data/443-https-rsa_export-full_ipv4/historical">download</a> a snapshot of this data at any point in time<strong>. </strong>What’s more, restricting the incoming traffic on a server is not enough to protect it against DDoS attacks. Dropping traffic at the software level with iptables does not prevent an attacker from sending a large number of packets to the server to consume all the available bandwidth and make it inaccessible to legitimate users.<strong><br /></strong></p>
<p>Below are two steps I would recommend taking.</p>
<ul>
<li>The first step should prevent the IP address of your origin server from appearing in future Censys scans, and ensure that application-level security features of CloudFlare cannot be bypassed (such as WAF or HTTP endpoint rate limiting).</li>
<li>The second step should (and I believe is the only way to) prevent an attacker from running a DDoS attack against you.</li>
</ul>
<h3><span>Step 1: Firewall incoming traffic or enable Authenticated Origin Pulls</span></h3>
<p>Configure your origin server only to accept incoming traffic from CloudFlare’s IP ranges. Refer to:</p>

<p><strong>Note</strong>: Before applying those steps, make sure you understand that <strong>it will prevent you from accessing your origin servers via SSH, RDP, FTP</strong>, or <a href="https://support.cloudflare.com/hc/en-us/articles/200169156-Which-ports-will-Cloudflare-work-with-">any non-HTTP based protocol</a>. Depending on your needs, this might be fine. However, if you still need to access your origin server using one of these protocols, you will need to leave the corresponding ports open.</p>
<p>Another way you can restrict incoming traffic to CloudFlare’s servers is by enabling <a href="https://support.cloudflare.com/hc/en-us/articles/204899617-Authenticated-Origin-Pulls">Authenticated Origin Pulls</a> on your account, and configure your web server accordingly. This feature will make CloudFlare authenticate with a TLS client certificate when talking to your origin server.</p>
<h3><span>Step 2: Change the IP address of your origin server</span></h3>
<p>As stated above, once the IP address of your origin server has leaked, it’s game over. The best solution would be to change it if it is possible, and if DDoS attacks are a credible threat to you. Depending on your hosting provider, this might be easy or painfully hard to achieve.</p>
<h2><span>Acknowledgments</span></h2>
<p>I want to address a big thank you to the people below, for their multiple suggestions and for proofreading this post!</p>

</div><p>Thank you for reading! Feel free to leave a comment below or to tweet <a href="https://twitter.com/christophetd">@christophetd</a> for discussions and remarks.</p><p>Liked this post? Show it by pushing the heart button below! You can also follow me on Twitter.</p>
        </div>
    </article>
    <article id="article-7" class="hn-article" data-index="7">
        <h1 class="title">
            <a href="https://m.oursky.com/client-cheques-that-i-rejected-7426f392d5e9">
                Client cheques that I rejected
            </a>
        </h1>
        <p class="meta">
            <a href="https://m.oursky.com/client-cheques-that-i-rejected-7426f392d5e9">m.oursky.com</a>
            -
            <a href="https://news.ycombinator.com/item?id=16177569" target="_blank">Comments</a>
        </p>
        <div>
            <div><p class="graf graf--p graf-after--figure">As a project consultant in my company, I hear a lot of app ideas everyday. Listening to passionate clients talking about the specific problems they’re working on or learning about innovative and simple solutions to new market niches is one of my favourite things about my job (our specialty coffee club comes a close second).<br /> <br />But as I reflect on the potential clients I’ve met, some of the ones I learned most from were the ones we didn’t take on. By sharing them here, I hope these considerations will help others with app ideas further refine their products to serve their users (and make money!).</p><h3 class="graf graf--h3 graf-after--p">Clone the latest best thing.</h3><div class="aspectRatioPlaceholder is-locked"><img class="graf-image" src="https://cdn-images-1.medium.com/max/1600/1*tsBmxFf_xaLduUpbsqkSKQ.jpeg" alt="1*tsBmxFf_xaLduUpbsqkSKQ.jpeg" /></div>Photo by <a href="https://unsplash.com/photos/Tq4YjCa2BSc" class="markup--anchor markup--figure-anchor">Alex Jones</a> via Unsplash<p class="graf graf--p graf-after--figure">Many first meetings are doomed from the start. One meeting started with: “Hey I want to build an Uber clone. How much does it cost?”<br /> <br />In my experience, when a person says s/he wants to build a clone of the latest best thing, there are usually 2 types of reasons — either the person just wants to look cool and make a quick buck, or this person actually knows the local market very well and has modifications that suit local behavioural patterns. For example, Whatsapp may be the most famous messenger app globally, but in East Asia alone, you have <a href="http://www.kakao.com/talk" class="markup--anchor markup--p-anchor">Kakao Talk</a> for Korea, LINE for Japan and Taiwan, and WeChat for China. Rocket Internet specializes in European localization of proven U.S. products and they managed to surpass many of their U.S. counterparts.<br /> <br />Yes, it is perfectly okay to clone the latest best thing, as long as you are clear about the value you are offering, so I asked “How are you going to differentiate yourself from Uber?”<br /> <br />“Well, it’s something big these days, right?”<br /> <br />Sadly, this client falls into the former case. It’s disheartening when I hear people who want to build a startup because they think it’s straightforward to replicate success.</p><p class="graf graf--p graf-after--p">To copy a successful product saves work for us as a development agency: our designers could take inspiration from the UX/UI design and the developers already have most of the feature specifications. We could hand over a beautiful clone within 3 months. But one of the things Oursky is committed to is follow-up and tracking. We want to build things that are truly useful to people.</p><p class="graf graf--p graf-after--p">I didn’t take his cheque because I’m not convinced that an Uber clone would add value for Hong Kong people, who can hop on affordable taxis everywhere, hail an Uber ride, or use our homegrown GoGoVan (which we did a UI project for). In business language for that potential client: creating a successful clone in a saturated market is a lot of hard work for small gains.</p><h3 class="graf graf--h3 graf-after--p">I’m going to lose a lot of users if I don’t launch my apps on all platforms right now.</h3><div class="aspectRatioPlaceholder is-locked"><img class="graf-image" src="https://cdn-images-1.medium.com/max/1600/1*e2YPq6fSghhFtid7K1EnhA.jpeg" alt="1*e2YPq6fSghhFtid7K1EnhA.jpeg" /></div>Photo by <a href="https://unsplash.com/photos/3iT3dnmblGE" class="markup--anchor markup--figure-anchor">Mikayla Mallek</a> via Unsplash<p class="graf graf--p graf-after--figure">Of course, if the product sounds interesting and viable, I’ll want to learn more about a potential client’s approach to developing products. Not all clients want to build MVPs the way Oursky does. I’ll eventually ask, “Which platform do you like to build on to start with?”<br /> <br />One client answer was: “All — Android, iOS and web. And I want the mobile apps in native to make sure the responsiveness of the app is good.”<br /> <br />The gentleman in front of me wanted to build an app similar to <a href="https://www.openrice.com/zh/hongkong" class="markup--anchor markup--p-anchor">OpenRice</a> (Hong Kong’s <a href="https://www.yelp.com/" class="markup--anchor markup--p-anchor">Yelp</a>), but with a focus on food inspiration and the foodie community. <em class="markup--em markup--p-em">I quite liked the idea — </em>as many people (like me!) are tired of fake reviews on restaurant directories. But do we need to get the app out onto all the platforms at once? <br /> <br />As a sales, of course I’d like to get a cheque — but only appropriate ones that go for strategic development stages. I responded with, “Our first goal is to help you iterate and prove your concept. It’s not cost-effective to build the app on all the platforms at once because it takes 3 times more effort to make a small change. We should start with just one and invest into others when the concept is proven to be successful.”<br /> <br />His response: “But I am going to lose a lot of users if I give up some of the platforms.”</p><blockquote class="graf graf--pullquote graf-after--p">Getting a hundred users who really like your app gives your business more validation than having thousands of never-return downloads.</blockquote><p class="graf graf--p graf-after--pullquote">My company has done cross-platform products, but if we were using an MVP model, we would be probably be throwing out a lot of code during the validation process. <em class="markup--em markup--p-em">Was the client prepared for this?</em></p><h3 class="graf graf--h3 graf-after--p">Concern about scalability way too early.</h3><div class="aspectRatioPlaceholder is-locked"><img class="graf-image" src="https://cdn-images-1.medium.com/max/1600/1*W5VDycqEPMr-DmnfU8vwFQ.jpeg" alt="1*W5VDycqEPMr-DmnfU8vwFQ.jpeg" /></div>Photo by <a href="https://unsplash.com/photos/_SFJhRPzJHs" class="markup--anchor markup--figure-anchor">NASA</a> via Unsplash<p class="graf graf--p graf--startsWithDoubleQuote graf-after--figure">“How many users can the back end support? My app is going to make a big hit in the first launch.”<br /> <br />Of course, many potential clients have thought about technical considerations. <em class="markup--em markup--p-em">This was one such client</em>. However, her concern shouldn’t be an issue for her target market, Hong Kong. <br /> <br />I replied with, “In our experience a reasonable backend can support 100,000 registered users, which should be good enough for your MVP, especially if you are targeting the Hong Kong market.”<br /> <br />To give context, the most popular app in Hong Kong has around 10MM downloads. I could have talked about concurrent users or requests per second, but I didn’t want to overwhelm her with too many concepts in one go. I gave her registered users to give her an idea of one factor that a backend takes care of.<br /> <br />Her response was “What if we have more users than that? We need a more powerful backend.”<br /> <br /><em class="markup--em markup--p-em">Facepalm.</em><br /> <br />My role as a consultant is often to help potential clients refine the problems they want to solve and take systematic steps to improve their product with a lower risk. Often, potential clients come to us with large, successful products as a reference. But if they’re just starting, they should validate their idea with an MVP.</p><h3 class="graf graf--h3 graf-after--p">You want a custom app…for your portfolio?</h3><div class="aspectRatioPlaceholder is-locked"><img class="graf-image" src="https://cdn-images-1.medium.com/max/1600/1*05BprS2nVkHRc0ubG0NxSw.jpeg" alt="1*05BprS2nVkHRc0ubG0NxSw.jpeg" /></div>Photo by <a href="https://unsplash.com/photos/7FOSJVtUtac" class="markup--anchor markup--figure-anchor">Jeremy Perkins</a> via Unsplash<p class="graf graf--p graf--startsWithDoubleQuote graf-after--figure">“I want to build an app that showcase my products.”</p><p class="graf graf--p graf-after--p">Okay, this sounds like a potential client is over-engineering a solution. But I want to hear them out first, so that time, I asked, “Why do you want to do it with an app?”</p><p class="graf graf--p graf--startsWithDoubleQuote graf-after--p">“Every business needs an app to reach out to new customers.”<br /> <br />Now that I understood this person’s problem, I went right into suggesting solutions. “If you want to reach out to new customers, building a website makes more sense. Few people would download an app just for <em class="markup--em markup--p-em">looking at</em> your products and a website is more easily discoverable in a search.”</p><p class="graf graf--p graf--startsWithDoubleQuote graf-after--p">“But research says we spend more time on mobile than the desktop these days.”</p><p class="graf graf--p graf-after--p">True, but the app market is tough. The app market has been consolidating into a few gigantic social media platforms like Facebook and WeChat. People are spending most of their time on these apps. If you want to reach customers, leveraging channels with a large potential audience is more effective. For this potential client, a Facebook page or Wordpress template is enough. If you have products to sell, consider using <a href="https://www.shopify.com/" class="markup--anchor markup--p-anchor">Shopify</a> or <a href="https://www.etsy.com/hk-en/" class="markup--anchor markup--p-anchor">Etsy</a>, and if you want a well-designed responsive site, try <a href="https://www.squarespace.com/" class="markup--anchor markup--p-anchor">Squarespace</a>. Their annual fee is less than 1 of our developer day-rates.</p><p>You may also consider building a chatbot for your business, it leverages chat apps like Telegram or Facebook messengers and it offers a conversational experience to your user. Have a taste of a chatbot with our <a href="https://m.me/oursky.hk" class="markup--anchor markup--p-anchor">Facebook Fan page</a>.</p><h3 class="graf graf--h3 graf-after--p">Come to us if you…</h3><p class="graf graf--p graf-after--h3">Of course, I am happy to talk to anyone who has a product. Here are the things to consider for your product first, and also for the teams that you’re considering hiring.</p><ul class="postList"><li class="graf graf--li graf-after--p">What’s the problem you are solving?</li><li class="graf graf--li graf-after--li">Based on the above, what are <em class="markup--em markup--li-em">all</em> the possible types of products that can solve your problem? It could be a WeChat app, Facebook page, Wordpress site, web app, or mobile app, to name a few.</li><li class="graf graf--li graf-after--li">What’s the most cost efficient way to solve your problem? What’s the smallest MVP you can imagine?</li><li class="graf graf--li graf-after--li">What’s the demographic of your target users?</li></ul><p class="graf graf--p graf-after--li graf--trailing">Feel free to <a href="https://oursky.com/contact/" class="markup--anchor markup--p-anchor">reach out</a> any time!</p></div>
        </div>
    </article>
    <article id="article-8" class="hn-article" data-index="8">
        <h1 class="title">
            <a href="http://www.bbc.co.uk/news/technology-42728336">
                'Text bomb' is latest Apple bug
            </a>
        </h1>
        <p class="meta">
            <a href="http://www.bbc.co.uk/news/technology-42728336">www.bbc.co.uk</a>
            -
            <a href="https://news.ycombinator.com/item?id=16177535" target="_blank">Comments</a>
        </p>
        <div>
            <div>
        
            <span class="image-and-copyright-container">
                
                
                
                
                
                 <span class="off-screen">Image copyright</span>
                 <span class="story-image-copyright">Getty Images</span>
                
            </span>
            
            
                <span class="off-screen">Image caption</span>
                <span class="media-caption__text">
                    Apple has not yet commented on the latest bug
                </span>
            
            
        <p>A new "text bomb" affecting Apple's iPhone and Mac computers has been discovered.</p><p>Abraham Masri, a software developer, tweeted about the flaw which typically causes an iPhone to crash and in some cases restart.</p><p>Simply sending a message containing a link which pointed to Mr Masri's code on programming site GitHub would be enough to activate the bug - even if the recipient did not click the link itself.</p><p>Mr Masri said he "always reports bugs" before releasing them. Apple has not yet commented on the issue.</p><p>On a Mac, the bug reportedly makes the Safari browser crash, and causes other slowdowns.</p><h2 class="story-body__crosshead">Don't panic</h2><p>But users should not be alarmed. </p><p>Security expert Graham Cluley <a href="https://www.grahamcluley.com/chaios-bug-crash-ios-macos-messages/" class="story-body__link-external">wrote on his blog that the bug</a> does not present anything to be particularly worried about - it's merely very annoying.</p>
            <span class="image-and-copyright-container">
                
                
                
                
                
                 <span class="off-screen">Image copyright</span>
                 <span class="story-image-copyright">Getty Images</span>
                
            </span>
            
            
                <span class="off-screen">Image caption</span>
                <span class="media-caption__text">
                    On a Mac computer, the bug reportedly makes the Safari browser crash, and causes other slowdowns
                </span>
            
            
        <p>"Something about the so-called ChaiOS bug's code gives your Apple device a brainstorm," he wrote.</p><p>"Ashamed about the mess it gets itself in, Messages decides the least embarrassing thing to do is to crash.</p><p>"Nasty. But, thankfully, more of a nuisance than something that will lead to data being stolen from your computer or a malicious hacker being able to access your files."</p><h2 class="story-body__crosshead">Taken down</h2><p>After the link did the rounds on social media, Mr Masri removed the code from GitHub, therefore disabling the "attack" unless someone was to replicate the code elsewhere.</p><p>"I'm not going to re-upload it," he said.</p><p>"I made my point. Apple needs to take such bugs more seriously."</p><p>Bugs in Apple's software have been a recurring problem of late.</p><p>In November it apologised to its customers for a glaring password flaw which meant its latest Mac operating system could be accessed without a password.</p><p>Less serious but highly frustrating was a bug that autocorrected the letter "I" into a strange symbol.</p>
    </div>
        </div>
    </article>
    <article id="article-9" class="hn-article" data-index="9">
        <h1 class="title">
            <a href="https://news.ycombinator.com/item?id=16177194">
                Permutive (YC S14) is hiring a front end product engineer (Elm) in London
            </a>
        </h1>
        <p class="meta">
            <a href="https://news.ycombinator.com/item?id=16177194">news.ycombinator.com</a>
            -
            <a href="https://news.ycombinator.com/item?id=16177194" target="_blank">Comments</a>
        </p>
        <div>
            <div>Permutive (YC S14) is the data platform for today's real-time world. We enable digital product, commercial and marketing managers to customize user experience in real-time, on every device across every channel. We're operating at scale, processing billions of events per day across hundreds of millions of users, and have recently raised a Series A.<p>We're looking for an engineer to design and develop our core dashboard product. You will be leading the development of our dashboard, used by companies with some of the largest digital audiences in the world to operate and manage our platform.</p><p>// Who we are looking for
We're looking for an engineer who relishes ownership and shipping a product. Our ideal candidate is able to mix frontend development, product management, and design.</p><p>We hope you'll have:
• Several years’ experience with frontend product work and web technologies
• Strong knowledge of the web stack, including HTML, CSS/Sass, JS, and HTTP APIs
• Strong visual and UX design sense
• Passion for modern web technologies and statically-typed FP, e.g. maybe you've played with Elm or PureScript in one of your pet projects
• Excellent verbal and written communication skills, with a strong attention to detail</p><p>// Technologies we use
• Backend: Scala, Java, Haskell
• Frontend: Elm, HTML, CSS
• Infra: Terraform, Docker, Kubernetes on Google Cloud Platform</p><p>// What you will do
• Define and execute on our front-end technology vision
• Build front-end user interfaces from the ground up—from designing to shipping
• Help figure out what our customers and platform need, and translate complex requirements into simple and beautiful user experiences
• Maintain and re-architect parts of our existing dashboard
• Create composable, reusable units of functionality for dashboard components like analytics, navigation, etc.
• Implement tracking and metrics to measure product use and effectiveness
• Use Git and our CI/CD pipeline to full effect
• We're a small team so you'd also be involved in decisions about the platform direction, as well as the flexibility to help out with the development of other areas of the platform.</p><p>// Benefits
• Stock options, so you get to own a piece of the pie
• Weekly lunches and quarterly socials — recent highlights include Mexican food, an escape room, and go karting
• Your own desk, shiny new MacBook, and dual monitors
• Private office in Aldgate (soon to be Farringdon)
• Office snacks: you'll never go hungry or thirsty</p><p>If you're interested, drop me an email at tim@permutive.com with your CV and anything else you think's relevant!</p></div>
        </div>
    </article>
    <article id="article-10" class="hn-article" data-index="10">
        <h1 class="title">
            <a href="https://www.amazon.com/b?node=17044620011">
                Amazon announces candidate cities for HQ2
            </a>
        </h1>
        <p class="meta">
            <a href="https://www.amazon.com/b?node=17044620011">www.amazon.com</a>
            -
            <a href="https://news.ycombinator.com/item?id=16177113" target="_blank">Comments</a>
        </p>
        <div>
            <div>
		<p><img src="https://images-na.ssl-images-amazon.com/images/G/01//Anything/test/images/usa/20170607AmazonCampusAerials_js_08._V504517137_.jpg" alt="Seattle HQ" /></p>
<p><img src="https://images-na.ssl-images-amazon.com/images/G/01//blank/1x1_b._UR1,10_.gif" alt="10px-spacer" /></p>
<h4><strong>What will be the benefits for the city finally selected to host your second headquarters?</strong></h4>
<p>We expect to invest over $5 billion and grow our second headquarters location to be a full equal to Amazon’s current campus in Seattle, creating as many as 50,000 high-paying jobs. In addition to Amazon’s direct hiring and investment, construction and operation of HQ2 is expected to create tens of thousands of additional jobs and tens of billions of dollars in additional investment in the surrounding community.</p>
<p>Amazon estimates its investments in Seattle from 2010 through 2016 resulted in an additional $38 billion to the city’s economy – every dollar invested by Amazon in Seattle generated an additional $1.40 for the city’s economy overall.</p>
<p><img src="https://images-na.ssl-images-amazon.com/images/G/01//blank/1x1_b._UR1,10_.gif" alt="10px-spacer" /></p>
<h4><strong>Why is Amazon choosing its second headquarters location via a public process?</strong></h4>
<p>We want to find a city that is excited to work with us and where our customers, employees, and the community can all benefit.</p>
</div>
        </div>
    </article>
    <article id="article-11" class="hn-article" data-index="11">
        <h1 class="title">
            <a href="https://techcrunch.com/2018/01/15/a-modest-proposal-for-ethereum-programming/">
                A modest primer for Ethereum programming
            </a>
        </h1>
        <p class="meta">
            <a href="https://techcrunch.com/2018/01/15/a-modest-proposal-for-ethereum-programming/">techcrunch.com</a>
            -
            <a href="https://news.ycombinator.com/item?id=16176753" target="_blank">Comments</a>
        </p>
        <div>
            <div>


<img src="https://tctechcrunch2011.files.wordpress.com/2017/09/vitalik-buterin-147a2587.jpg?w=738" alt="vitalik-buterin-147a2587.jpg?w=738" />
<div class="byline contributor-byline">
	

			<p class="bio">Mostly I write stuff. See <a href="http://rezendi.com/">rezendi.com</a> for details.</p>
	
			<div class="more-posts">
			More posts by this contributor:			
		</div>
	
</div>


<p>I’m a long-term cryptocurrency believer, pretty saddened to see the space degenerate into something about as interesting and brimming with emergent properties as an unregulated penny-stock market.</p>
<p>But there are still some genuinely interesting, technically innovative blockchain projects out there, if you look for them: Blockstack, Foam, Mattereum, etc. And at my day job at <a href="https://happyfuncorp.com/">HappyFunCorp</a> we’ve been working on a few ourselves, both internally and for a couple of clients (who are still in stealth mode.)</p>
<p>Meanwhile the world is full of web programmers, but there’s a real paucity of cryptocurrency developers, and the chasm between the two fields is hard to cross. So I thought I’d take what I’d learned from architecting and building out our own Ethereum-based projects, and turn it into an open-sourced tutorial for web devs, in the hopes of encouraging a little more actual development and evolution as opposed to blind speculation.</p>
<p>It’s great that so much money is coming into the space but it won’t help unless people actually use it to plant some seeds of innovation, and we hope that this will in some small way help make that happen.</p>
<p><a>Webthereum</a> by <a>TechCrunch</a> on Scribd</p>
		
		
				
		
		
		



								
							</div>
        </div>
    </article>
    <article id="article-12" class="hn-article" data-index="12">
        <h1 class="title">
            <a href="https://www.fuze.co.uk/nintendo-switch.html">
                Fuze for Nintendo Switch: An easy-to-learn text-based programming language
            </a>
        </h1>
        <p class="meta">
            <a href="https://www.fuze.co.uk/nintendo-switch.html">www.fuze.co.uk</a>
            -
            <a href="https://news.ycombinator.com/item?id=16176742" target="_blank">Comments</a>
        </p>
        <div>
            <div><div class="wsite-elements wsite-not-footer">
	<div><div class="wsite-image wsite-image-border-none">
<a>
<img src="https://www.fuze.co.uk/uploads/8/0/7/1/80716398/fuze4nintendoswitchpressart_1_orig.png" alt="Picture" />
</a>

</div></div>











<p><span><strong>FUZE for Nintendo Switch</strong></span></p>

<p><strong><span><span>Easy to learn text based programming language</span><br /><span>​No coding experience required</span><br /><span>​Create your own apps and fast 2D - 3D games</span><br /><span>​Access Joycon sensors and controls directly in your programs<br /></span><span>​Use the Dock to show your games on your TV to share with friends and family</span><br /><span>​Programmable synthesizer &amp; Speech engine<br /></span><span>​Use the included game graphics &amp; audio or create your own</span><br /><span>​​Extra  content packs will be available to download<br /></span><span>Use a USB keyboard, the FUZE touch keyboard or the Joycons to enter your code</span><br /><span>​Comes with game graphics and audio and you can create your own<br /></span><span>​Learn to code</span></span></strong></p>

<div><div class="wsite-image wsite-image-border-none">
<a href="/uploads/8/0/7/1/80716398/switchfuzeonscreenkeyboard_orig.png">
<img src="https://www.fuze.co.uk/uploads/8/0/7/1/80716398/published/switchfuzeonscreenkeyboard.png?1499170383" alt="Picture" />
</a>
<p>Images are are for illustration only. They are not accurate representations of the final product. </p>
</div></div>

<div><div class="wsite-image wsite-image-border-none">
<a>
<img src="https://www.fuze.co.uk/uploads/8/0/7/1/80716398/editor/keyboardimage.png?1499170718" alt="Picture" />
</a>

</div></div>

<div><div class="wsite-multicol"><div class="wsite-multicol-table-wrap">
	<table class="wsite-multicol-table">
		<tbody class="wsite-multicol-tbody">
			<tr class="wsite-multicol-tr">
				<td class="wsite-multicol-col">
					
						




					
				</td>				<td class="wsite-multicol-col">
					
						

<p><br /><span><span><strong>Hello from teamFUZE</strong></span><br />​<br />Please feel free to leave comments or ask questions below. Please note this is an education platform and as such we will keep it moderated. Anything we consider unsuitable or not relevant to FUZE for Nintendo Switch will not be posted.  This is a family show folks!</span></p>


					
				</td>				<td class="wsite-multicol-col">
					
						




					
				</td>			</tr>
		</tbody>
	</table>
</div></div></div>

<div><div class="wsite-multicol"><div class="wsite-multicol-table-wrap">
	<table class="wsite-multicol-table">
		<tbody class="wsite-multicol-tbody">
			<tr class="wsite-multicol-tr">
				<td class="wsite-multicol-col">
					
						




					
				</td>				<td class="wsite-multicol-col">
					
						

<div><div>
</div></div>


					
				</td>				<td class="wsite-multicol-col">
					
						




					
				</td>			</tr>
		</tbody>
	</table>
</div></div></div>
</div>
</div>
        </div>
    </article>
    <article id="article-13" class="hn-article" data-index="13">
        <h1 class="title">
            <a href="https://github.com/jedisct1/piknik">
                Piknik – Copy and paste anything over the network
            </a>
        </h1>
        <p class="meta">
            <a href="https://github.com/jedisct1/piknik">github.com</a>
            -
            <a href="https://news.ycombinator.com/item?id=16176666" target="_blank">Comments</a>
        </p>
        <div>
            <p><a href="https://github.com/jedisct1/piknik/releases/latest"><img src="https://camo.githubusercontent.com/85f03b47e40120ba2cd8a22dab50949e1bd63e18/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f72656c656173652f6a656469736374312f70696b6e696b2e737667" alt="Latest release" /></a> <a href="https://travis-ci.org/jedisct1/piknik?branch=master"><img src="https://camo.githubusercontent.com/7d35f1251533dd9cd4a8e3201e8f38e656963f42/68747470733a2f2f7472617669732d63692e6f72672f6a656469736374312f70696b6e696b2e7376673f6272616e63683d6d6173746572" alt="Build status" /></a></p> <h1><a href="#piknik" class="anchor"></a>Piknik</h1> <p>Copy/paste anything over the network!</p> <p>[<a href="https://asciinema.org/a/80708">watch a demo on Asciinema</a>] - [<a href="https://github.com/jedisct1/piknik/releases/latest">download the source code / binaries</a>]</p> <p><a href="https://camo.githubusercontent.com/b487af08494ad388c4f0d99df4418fce68d0a277/68747470733a2f2f7261772e6769746875622e636f6d2f6a656469736374312f70696b6e696b2f6d61737465722f70696b6e696b2e706e67"><img src="https://camo.githubusercontent.com/b487af08494ad388c4f0d99df4418fce68d0a277/68747470733a2f2f7261772e6769746875622e636f6d2f6a656469736374312f70696b6e696b2f6d61737465722f70696b6e696b2e706e67" alt="Piknik" /></a></p> <p>Ever needed a copy/paste clipboard that works over the network?</p> <p>Piknik seamlessly and securely transfers URLs, code snippets, documents, virtually anything between arbitrary hosts.</p> <p>No SSH needed, and hosts can sit behind NAT gateways, on different networks.</p> <p>Fill in the clipboard ("copy") with whatever comes in to the standard input:</p> <div class="highlight highlight-source-shell"><pre>$ pkc clipboard content</pre></div> <p>Magically retrieve that content from any other host having Piknik installed with the same configuration:</p> <div class="highlight highlight-source-shell"><pre>$ pkp clipboard content</pre></div> <p>Boom.</p> <p>Obviously, it can be used to transfer files as well:</p> <div class="highlight highlight-source-shell"><pre>$ pkc <span class="pl-k">&lt;</span> kitten.gif $ pkp <span class="pl-k">&gt;</span> kittencopy.gif</pre></div> <div class="highlight highlight-source-shell"><pre>$ tar cvf - <span class="pl-k">*</span>.txt <span class="pl-k">|</span> pkc $ pkp <span class="pl-k">|</span> tar xvf -</pre></div> <p>In order to work around firewalls/NAT gatways, the clipboard content transits over TCP via a staging server.</p> <p>Nothing transits without end-to-end encryption; the server cannot learn much about what the clipboard actually contains.</p> <p>Data can be shared between different operating systems, including MacOS, Linux and Windows.</p> <h2><a href="#installation" class="anchor"></a>Installation</h2> <h3><a href="#option-1-use-precompiled-binaries" class="anchor"></a>Option 1: use precompiled binaries</h3> <p>Precompiled binaries for MacOS, Linux (i386, x86_64, ARM), Win32, Win64, DragonflyBSD, NetBSD and FreeBSD can be downloaded here: <a href="https://github.com/jedisct1/piknik/releases/latest">https://github.com/jedisct1/piknik/releases/latest</a></p> <h3><a href="#option-2-on-macos-use-homebrew" class="anchor"></a>Option 2 (on MacOS): use Homebrew</h3> <div class="highlight highlight-source-shell"><pre>$ brew install piknik</pre></div> <h3><a href="#option-3-compile-the-source-code" class="anchor"></a>Option 3: compile the source code</h3> <p>This project is written in Go. So, a Go compiler is required, as well as the following incantation:</p> <div class="highlight highlight-source-shell"><pre>$ <span class="pl-k">export</span> GOPATH=<span class="pl-smi">${GOPATH<span class="pl-k">:-</span>~<span class="pl-k">/</span>go}</span> <span class="pl-k">;</span> mkdir -p <span class="pl-smi">$GOPATH</span> $ go get github.com/jedisct1/piknik</pre></div> <p>The <code>piknik</code> executable file should then be available in <code>$GOPATH/bin</code>.</p> <h2><a href="#setup" class="anchor"></a>Setup</h2> <p>Piknik requires a bunch of keys. Generate them all with</p> <div class="highlight highlight-source-shell"><pre>$ piknik -genkeys</pre></div> <p>This generates random keys (highly recommended).</p> <p>A temporary alternative is to derive the keys from a password. The same password will always generate the same set of keys, on all platforms. In order to do so, add the <code>-password</code> switch:</p> <div class="highlight highlight-source-shell"><pre>$ piknik -genkeys -password</pre></div> <p>The output of the <code>-genkeys</code> command is all you need to build a configuration file.</p> <p>Only copy the section for servers on the staging server. Only copy the section for clients on the clients.</p> <p>Is a host gonna act both as a staging server and as a client? Ponder on it before copying the "hybrid" section, but it's there, just in case.</p> <p>The default location for the configuration file is <code>~/.piknik.toml</code>. With the exception of Windows, where dot-files are not so common. On that platform, the file is simply called <code>piknik.toml</code>.</p> <p>Sample configuration file for a staging server:</p> <div class="highlight highlight-source-toml"><pre><span class="pl-smi">Listen</span> = <span class="pl-s"><span class="pl-pds">"</span>0.0.0.0:8075<span class="pl-pds">"</span></span>         <span class="pl-c"><span class="pl-c">#</span> Edit appropriately</span> <span class="pl-smi">Psk</span>    = <span class="pl-s"><span class="pl-pds">"</span>bf82bab384697243fbf616d3428477a563e33268f0f2307dd14e7245dd8c995d<span class="pl-pds">"</span></span> <span class="pl-smi">SignPk</span> = <span class="pl-s"><span class="pl-pds">"</span>0c41ca9b0a1b5fe4daae789534e72329a93a352a6ad73d6f1d368d8eff37271c<span class="pl-pds">"</span></span></pre></div> <p>Sample configuration file for clients:</p> <div class="highlight highlight-source-toml"><pre><span class="pl-smi">Connect</span>   = <span class="pl-s"><span class="pl-pds">"</span>127.0.0.1:8075<span class="pl-pds">"</span></span>    <span class="pl-c"><span class="pl-c">#</span> Edit appropriately</span> <span class="pl-smi">Psk</span>       = <span class="pl-s"><span class="pl-pds">"</span>bf82bab384697243fbf616d3428477a563e33268f0f2307dd14e7245dd8c995d<span class="pl-pds">"</span></span> <span class="pl-smi">SignPk</span>    = <span class="pl-s"><span class="pl-pds">"</span>0c41ca9b0a1b5fe4daae789534e72329a93a352a6ad73d6f1d368d8eff37271c<span class="pl-pds">"</span></span> <span class="pl-smi">SignSk</span>    = <span class="pl-s"><span class="pl-pds">"</span>cecf1d92052f7ba87da36ac3e4a745b64ade8f9e908e52b4f7cd41235dfe7481<span class="pl-pds">"</span></span> <span class="pl-smi">EncryptSk</span> = <span class="pl-s"><span class="pl-pds">"</span>2f530eb85e59c1977fce726df9f87345206f2a3d40bf91f9e0e9eeec2c59a3e4<span class="pl-pds">"</span></span></pre></div> <p>Do not use these, uh? Get your very own keys with the <code>piknik -genkeys</code> command. Edit the <code>Connect</code> and <code>Listen</code> properties to reflect the staging server IP and port. And <code>chmod 600 ~/.piknik.toml</code> might not be a bad idea.</p> <p>Don't like the default config file location? Use the <code>-config</code> switch.</p> <h2><a href="#usage-staging-server" class="anchor"></a>Usage (staging server)</h2> <p>Run the following command on the staging server (or use <code>runit</code>, <code>openrc</code>, <code>systemd</code>, whatever to run it as a background service):</p> <div class="highlight highlight-source-shell"><pre>$ piknik -server</pre></div> <p>The staging server has to be publicly accessible. At the very least, it must be reachable by the clients over TCP with the port you specify in the configuration.</p> <p>Commands without a valid API key (present in the client configuration file) will be rejected by the server.</p> <h2><a href="#usage-clients" class="anchor"></a>Usage (clients)</h2> <div class="highlight highlight-source-shell"><pre>$ piknik -copy</pre></div> <p>Copy the standard input to the clipboard.</p> <div class="highlight highlight-source-shell"><pre>$ piknik -paste</pre></div> <p>Retrieve the content of the clipboard and spit it to the standard output. <code>-paste</code> is actually a no-op. This is the default action if <code>-copy</code> was not specified.</p> <div class="highlight highlight-source-shell"><pre>$ piknik -move</pre></div> <p>Retrieve the content of the clipboard, spit it to the standard output and clear the clipboard. Not necessarily in this order. Only one lucky client will have the privilege to see the content.</p> <p>That's it.</p> <p>Feed it anything. Text, binary data, whatever. As long as it fits in memory.</p> <h2><a href="#suggested-shell-aliases" class="anchor"></a>Suggested shell aliases</h2> <p>Wait. Where are the <code>pkc</code> and <code>pkp</code> commands mentioned earlier?</p> <p>Sample shell aliases:</p> <div class="highlight highlight-source-shell"><pre><span class="pl-c"><span class="pl-c">#</span> pko &lt;content&gt; : copy &lt;content&gt; to the clipboard</span> <span class="pl-en">pko</span>() {     <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$*</span><span class="pl-pds">"</span></span> <span class="pl-k">|</span> piknik -copy }  <span class="pl-c"><span class="pl-c">#</span> pkf &lt;file&gt; : copy the content of &lt;file&gt; to the clipboard</span> <span class="pl-en">pkf</span>() {     piknik -copy <span class="pl-k">&lt;</span> <span class="pl-smi">$1</span> }  <span class="pl-c"><span class="pl-c">#</span> pkc : read the content to copy to the clipboard from STDIN</span> <span class="pl-c1">alias</span> pkc=<span class="pl-s"><span class="pl-pds">'</span>piknik -copy<span class="pl-pds">'</span></span>  <span class="pl-c"><span class="pl-c">#</span> pkp : paste the clipboard content</span> <span class="pl-c1">alias</span> pkp=<span class="pl-s"><span class="pl-pds">'</span>piknik -paste<span class="pl-pds">'</span></span>  <span class="pl-c"><span class="pl-c">#</span> pkm : move the clipboard content</span> <span class="pl-c1">alias</span> pkm=<span class="pl-s"><span class="pl-pds">'</span>piknik -move<span class="pl-pds">'</span></span>  <span class="pl-c"><span class="pl-c">#</span> pkz : delete the clipboard content</span> <span class="pl-c1">alias</span> pkz=<span class="pl-s"><span class="pl-pds">'</span>piknik -copy &lt; /dev/null<span class="pl-pds">'</span></span>  <span class="pl-c"><span class="pl-c">#</span> pkfr [&lt;dir&gt;] : send a whole directory to the clipboard, as a tar archive</span> <span class="pl-en">pkfr</span>() {     tar czpvf - <span class="pl-smi">${1<span class="pl-k">:-</span>.}</span> <span class="pl-k">|</span> piknik -copy }  <span class="pl-c"><span class="pl-c">#</span> pkpr : extract clipboard content sent using the pkfr command</span> <span class="pl-c1">alias</span> pkpr=<span class="pl-s"><span class="pl-pds">'</span>piknik -paste | tar xzhpvf -<span class="pl-pds">'</span></span>  <span class="pl-c"><span class="pl-c">#</span> pkpr : extract clipboard content sent using the pkfr command</span> <span class="pl-c1">alias</span> pkpr=<span class="pl-s"><span class="pl-pds">'</span>piknik -paste | tar xzhpvf -<span class="pl-pds">'</span></span></pre></div> <h2><a href="#piknik-integration-in-third-party-packages" class="anchor"></a>Piknik integration in third-party packages</h2> <ul> <li>The <a href="https://atom.io/packages/piknik">Piknik package for Atom</a> allows copying/pasting text between hosts running the Atom text editor.</li> <li>The <a href="https://marketplace.visualstudio.com/items?itemName=jedisct1.piknik">Piknik package for Visual Studio Code</a> allows copying/pasting text between hosts running the Visual Studio Code text editor.</li> </ul> <h2><a href="#use-cases" class="anchor"></a>Use cases</h2> <p>Use it to:</p> <ul> <li>Securely send passwords, API keys, URLs from one host to another</li> <li>Share a clipboard with your teammates (which can be a lot of fun)</li> <li>Copy data from/to isolated VMs, without the VMWare tools or shared volumes (great for unsupported operating systems and malware sandboxes)</li> <li>Copy files from/to a Windows machine, without Samba or SSH</li> <li>Transfer data between hosts sitting behind firewalls/NAT gateways</li> <li>Easily copy configuration files to multiple hosts</li> <li>Start a slow download at the office, retrieve it later at home</li> <li>Quickly backup a file to the cloud before messing with it</li> <li>...and more!</li> </ul> <h2><a href="#protocol" class="anchor"></a>Protocol</h2> <p>Common definitions:</p> <pre><code>k: API key ek: 256-bit symmetric encryption key ekid: encryption key id encoded as a 64-bit little endian integer m: plaintext ct: XChaCha20 ek,n (m) Hk,s: BLAKE2b(domain="SK", key=k, salt=s, size=32) Len(x): x encoded as a 64-bit little endian unsigned integer n: random 192-bit nonce r: random 256-bit client nonce r': random 256-bit server nonce ts: Unix timestamp as a 64-bit little endian integer Sig: Ed25519 v: 5 </code></pre> <p>Copy:</p> <pre><code>-&gt; v || r || h0 h0 := Hk,0(v || r)  &lt;- v || r' || h1 h1 := Hk,1(v || r' || h0)  -&gt; 'S' || h2 || Len(n || ct) || ekid || ts || s || n || ct s := Sig(n || ct) h2 := Hk,2(h1 || 'S' || ekid || ts || s)  &lt;- Hk,3(h2) </code></pre> <p>Move/Paste:</p> <pre><code>Move:  opcode := 'M' Paste: opcode := 'G'  -&gt; v || r || h0 h0 := Hk,0(v || r)  &lt;- v || r' || h1 h1 := Hk,1(v || r' || H0)  -&gt; opcode || h2 h2 := Hk,2(h1 || opcode)  &lt;- Hk,3(h2 || ekid || ts || s) || Len(n || ct) || ekid || ts || s || n || ct s := Sig(n || ct) </code></pre> <h2><a href="#license" class="anchor"></a>License</h2> <p><a href="https://en.wikipedia.org/wiki/ISC_license">ISC</a>.</p> <h2><a href="#credits" class="anchor"></a>Credits</h2> <p>Piknik diagram by <a href="https://easypi.herokuapp.com/copy-paste-anything-over-network/">EasyPi</a>.</p> 
        </div>
    </article>
    <article id="article-14" class="hn-article" data-index="14">
        <h1 class="title">
            <a href="https://blog.wallaroolabs.com/2018/01/go-go-go-stream-processing-for-go/">
                Stream Processing for Go
            </a>
        </h1>
        <p class="meta">
            <a href="https://blog.wallaroolabs.com/2018/01/go-go-go-stream-processing-for-go/">blog.wallaroolabs.com</a>
            -
            <a href="https://news.ycombinator.com/item?id=16176650" target="_blank">Comments</a>
        </p>
        <div>
            <div>
        

<p>We’ve been working on our processing engine, <a href="https://github.com/wallaroolabs/wallaroo/tree/release">Wallaroo</a> for just under two years now. Our goal has been to make it as easy to build fast, scale-independent applications for processing data. When we open sourced Wallaroo last year we provided an API that let developers create applications using <a href="https://blog.wallaroolabs.com/2017/10/go-python-go-stream-processing-for-python/">Python</a>. Over the last few months we’ve been working to make Wallaroo available to a wider range of programmers by adding a Go API, and that’s what I’d like to talk about today.</p>

<p>Whether you’re using Python or Go, Wallaroo is designed to let you focus on your business algorithms, not your infrastructure.</p>

<h2>The Go API</h2>

<h3>A Few Words About Go and Wallaroo</h3>

<p>Wallaroo is written in a language called <a href="https://blog.wallaroolabs.com/2017/10/why-we-used-pony-to-write-wallaroo/">Pony</a>. Wallaroo interacts with Go code using <a href="https://tutorial.ponylang.org/c-ffi/">Pony’s foreign function interface</a>. A Wallaroo application that uses the Go API is compiled into a library and then the application itself is built by linking using this library. Wallaroo calls into specific functions that are exported from the application code. In this post we will focus on the Go code required to create a Wallaroo application, but you can find more information about the structure of an application <a href="https://docs.wallaroolabs.com/book/go/api/start-a-project.html">in our documentation</a>.</p>

<h3>A Motivating Example</h3>

<p>The canonical streaming data processing application is Word Count, in which a stream of input text is analyzed and the total number of times each word has been seen is reported. This description is broad enough to allow developers to make different design tradeoffs in their implementations. You can find <a href="https://github.com/WallarooLabs/wallaroo/blob/release/examples/go/word_count/">the example</a> I’ll be discussing in it’s entirety in our <a href="https://github.com/WallarooLabs/wallaroo/tree/release">GitHub repository</a>.</p>

<p>For this example we will make the following assumptions:</p>

<ul>
<li>Incoming messages will come from a TCP connection and be sent to
another TCP connection.</li>
<li>Incoming messages will be framed, starting with a 32-bit length
header.</li>
<li>Words are sent to the system in messages that can contain zero or
more words.</li>
<li>Incoming messages consist of a string.</li>
<li>Outgoing messages consist of a word and the number of times that
word has been seen in the event stream.</li>
</ul>

<p><img src="https://d33wubrfki0l68.cloudfront.net/4a6439c1e232f12cf563211a79d3b24b389cdee1/5cede/images/post/go-api/word-count-diagram.png" alt="Word Count Diagram" /></p>

<p>In our example, we will also partition the state (the number of times each word has been seen) into 26 state entities, where each state entity handles words that start with different letters. For example “acorn” and “among” would go to the “a” state entity, while “bacon” would go to the “b” state entity.</p>

<p>This application will process messages as they arrive. This contrasts with some other streaming data processing systems that are designed around processing messages in micro-batches. This results in lower latencies because message processing is not delayed.</p>

<h3>Wallaroo’s Core Abstractions</h3>

<p>In order to understand the Go API, it is important to understand Wallaroo’s core abstractions:</p>

<ul>
<li>State – Accumulated result of data stored over the course of time.</li>
<li>Computation – Code that transforms an input into an
output.</li>
<li>State Computation – Code that takes an input and a state
object, operates on that input and state
(possibly making state updates), and optionally produces an output.</li>
<li>Source – Input point for data from external systems into an application.</li>
<li>Sink – Output point from an application to external systems.</li>
<li>Decoder – Code that transforms a stream of bytes from an external
system into a series of application input types.</li>
<li>Encoder – Code that transforms an application output type into
bytes for sending to an external system.</li>
<li>Pipeline – A sequence of computations and/or state computations
originating from a source and optionally terminating in a sink.</li>
<li>Application – A collection of pipelines.</li>
</ul>

<p>These abstractions will be described in more detail later.</p>

<h3>Application Setup</h3>

<p>Wallaroo calls the <code>ApplicationSetup</code> function to create a data structure that represents the application.</p>

<pre><code class="language-go">//export ApplicationSetup
func ApplicationSetup() *C.char {
	fs := flag.NewFlagSet("wallaroo", flag.ExitOnError)
	inHostsPortsArg := fs.String("in", "", "input host:port list")
	outHostsPortsArg := fs.String("out", "", "output host:port list")

	fs.Parse(wa.Args[1:])

	inHostsPorts := hostsPortsToList(*inHostsPortsArg)

	inHost := inHostsPorts[0][0]
	inPort := inHostsPorts[0][1]

	outHostsPorts := hostsPortsToList(*outHostsPortsArg)
	outHost := outHostsPorts[0][0]
	outPort := outHostsPorts[0][1]

	wa.Serialize = Serialize
	wa.Deserialize = Deserialize

	application := app.MakeApplication("Word Count Application")
	application.NewPipeline("Split and Count", app.MakeTCPSourceConfig(inHost, inPort, &amp;Decoder{})).
		ToMulti(&amp;SplitBuilder{}).
		ToStatePartition(&amp;CountWord{}, &amp;WordTotalsBuilder{}, "word totals", &amp;WordPartitionFunction{}, LetterPartition()).
		ToSink(app.MakeTCPSinkConfig(outHost, outPort, &amp;Encoder{}))

	json := application.ToJson()

	return C.CString(json)
}

func hostsPortsToList(hostsPorts string) [][]string {
	hostsPortsList := make([][]string, 0)
	for _, hp := range strings.Split(hostsPorts, ",") {
		hostsPortsList = append(hostsPortsList, strings.Split(hp, ":"))
	}
	return hostsPortsList
}
</code></pre>

<p>This code creates an application with the topology that was described earlier. It represents one pipeline that consists of a stateless computation called <code>Split</code> that splits a string of words into individual words and a state computation called <code>CountWord</code> that updates the state of the application and creates outgoing messages that represent the word count. The classes used here will be described more in the following sections. At the end, it returns a C string that represents the application, which Wallaroo then uses to build the actual application.</p>

<p>Note that the function <code>hostPortsToList</code> is a convenience function that takes the <code>host:port</code> pairs from the command line and turns them into slices.</p>

<h4>State and State Partitions</h4>

<p>In this example, the state is the number of times each word has been seen. The easiest way to do this would be with a dictionary where the key is a word, and the value associated with that key is the number of times that word has been seen in the event stream.</p>

<p>Wallaroo lets you divide state into pieces called state partitions. State partitions are pieces of state that are uniquely identified by a key of some sort. A state partition can be divided into any number of state entities. The only restriction is that these state entities must be independent of each other in terms of how they will be accessed, because only one state entity can be accessed at a time.</p>

<p>When a message is sent, Wallaroo applies a partition function to the message to determine which state entity to send it to. Different state entities may live on different workers, and a state entity may move from one worker to another when workers are added or removed from the cluster. This makes it easy to scale the application up and down as the number of workers in the cluster increases and decreases.</p>

<p>This example represents the state as a dictionary that is wrapped in an object that knows how to update it and has a method that returns an outgoing message object representing a given word’s count.</p>

<pre><code class="language-go">func MakeWordTotals() *WordTotals {
	return &amp;WordTotals{ make(map[string]uint64) }
}

type WordTotals struct {
	WordTotals map[string]uint64
}

func (wordTotals *WordTotals) Update(word string) {
	total, found := wordTotals.WordTotals[word]
	if !found {
		total = 0
	}
	wordTotals.WordTotals[word] = total + 1
}

func (wordTotals *WordTotals) GetCount(word string) *WordCount {
	return &amp;WordCount{word, wordTotals.WordTotals[word]}
}
</code></pre>

<p>There also needs to be a class that can build these state entity objects. In this example, the class is <code>WordTotalsBuilder</code>.</p>

<pre><code class="language-go">type WordTotalsBuilder struct {}

func (wtb *WordTotalsBuilder) Name() string {
	return "word totals builder"
}

func (wtb *WordTotalsBuilder) Build() interface{} {
	return MakeWordTotals()
}
</code></pre>

<p><code>WordPartitionFunction</code> is a partition function that takes a string and returns the a <code>uint64</code> with the ASCII value of the first character if the first character is a lowercase letter, or a <code>"!"</code> if it is not.</p>

<pre><code class="language-go">type WordPartitionFunction struct {}

func (wpf *WordPartitionFunction) Partition (data interface{}) uint64 {
	word := data.(*string)
	firstLetter := (*word)[0]
	if (firstLetter &gt;= 'a') &amp;&amp; (firstLetter &lt;= 'z') {
		return uint64(firstLetter)
	}
	return uint64('!')
}
</code></pre>

<p>For performance reasons, all partition keys are <code>uint64</code>s. It is up to the application developer to select an appropriate system for representing their partitions as <code>uint64</code>s.</p>

<h4>Incoming Messages and the Decoder</h4>

<p>The <code>Decoder</code> contains the logic for interpreting incoming bytes from a TCP stream into an object that represents the message within the application. In this example, incoming messages are represented as strings:</p>

<pre><code class="language-go">type Decoder struct {}

func (decoder *Decoder) HeaderLength() uint64 {
	return 4
}

func (decoder *Decoder) PayloadLength(b []byte) uint64 {
	return uint64(binary.BigEndian.Uint32(b[0:4]))
}

func (decoder *Decoder) Decode(b []byte) interface{} {
	s := string(b[:])
	return &amp;s
}
</code></pre>

<p>This decoder is specific to TCP sources. Wallaroo also has support for Kafka sources, and other source types will be added in the future.</p>

<h4>Stateless Computation</h4>

<p><code>Split</code> is a stateless computation. It takes a string and splits it into a list of strings where each string in the list represents a word.</p>

<pre><code>"why hello world" -&gt; Split -&gt; ["why", "hello", "world"]
</code></pre>

<p>Here’s what the <code>Split</code> computation looks like:</p>

<pre><code class="language-go">type Split struct {}

func (s *Split) Name() string {
	return "split"
}

func (s *Split) Compute(data interface{}) []interface{} {
	punctuation := " !\"#$%&amp;'()*+,-./:;&lt;=&gt;?@[\\]^_`{|}~"
	lines := data.(*string)

	words := make([]interface{}, 0)

	for _, line := range strings.Split(*lines, "\n") {
		clean_line := strings.Trim(strings.ToLower(line), punctuation)
		for _, word := range strings.Split(clean_line, " ") {
			clean_word := strings.Trim(word, punctuation)
			words = append(words, &amp;clean_word)
		}
	}

	return words
}
</code></pre>

<p>The <code>Split</code> computation returns a list of individual words that the Wallaroo framework sends along as messages to the next step in the pipeline. Wallaroo takes care of making sure that each message gets delivered to the correct state entity. Your application does not which machine holds that state entity.</p>

<p>There also needs to be a builder that can build instances of the <code>Split</code> computation. Our <code>SplitBuilder</code> class looks like this:</p>

<pre><code class="language-go">type SplitBuilder struct {}

func (sb *SplitBuilder) Build() interface{} {
	return &amp;Split{}
}
</code></pre>

<h4>State Computation</h4>

<p><code>CountWord</code> is a state computation; it uses an incoming message and a state to update the word count for the new word and returns a message for Wallaroo to send on its behalf.</p>

<pre><code class="language-go">type CountWord struct {}

func (cw *CountWord) Name() string {
	return "count word"
}

func (cw *CountWord) Compute(data interface{}, state interface{}) (interface{}, bool) {
	word := data.(*string)
	wordTotals := state.(*WordTotals)
	wordTotals.Update(*word)
	return wordTotals.GetCount(*word), true
}
</code></pre>

<h4>Outgoing Messages and the Encoder</h4>

<p>In our example, the outgoing message is represented within the application as an object that stores the word and the count of the number of times that word has been seen in the event stream.</p>

<pre><code class="language-go">type WordCount struct {
	Word string
	Count uint64
}
</code></pre>

<p>The <code>Encoder</code> contains the logic for transforming this object into a list of bytes that will then be sent on the outgoing TCP connection. In the example, outgoing messages are strings of <code>WORD =&gt; COUNT\n</code> where <code>WORD</code> is the word being counted and <code>COUNT</code> is the count.</p>

<pre><code class="language-go">type Encoder struct {}

func (encoder *Encoder) Encode(data interface{}) []byte {
	word_count := data.(*WordCount)
	msg := fmt.Sprintf("%s =&gt; %d\n", word_count.Word, word_count.Count)
	fmt.Println(msg)
	return []byte(msg)
}
</code></pre>

<p>This example uses a TCP sink, but Wallaroo also supports Kafka sinks. Other types of sinks will be added in the future.</p>

<h4>Serialization and Deserialization</h4>

<p>Wallaroo needs to be able to serialize and deserialize objects in order to store them to disk for resiliency and recovery, and also to send them to other worker nodes when the application is being used in a multi-worker cluster. The developer must create code to do this. We’ve omitted that code in this blog post, but you can learn more about it in the <a href="https://docs.wallaroolabs.com/book/go/api/interworker-serialization-and-resilience.html">“Interworker Serialization and Resilience”</a> section of our documentation.</p>

<h2>A Scalable Event Processing Application</h2>

<p>This application can run on one worker and can scale horizontally by adding more and more workers. Wallaroo’s flexibility makes it easy to adapt to whatever partitioning strategy your application requires. Take a look at our documentation for <a href="https://docs.wallaroolabs.com/book/running-wallaroo/running-wallaroo.html">information about how to run a Wallaroo cluster</a>.</p>

<h2>Check It Out</h2>

<p>If you’re interested in running this application yourself, take a look at the <a href="https://docs.wallaroolabs.com">Wallaroo documentation</a> and the <a href="https://github.com/WallarooLabs/wallaroo/tree/release/examples/go/word_count">word count example application</a> that we’ve built. You’ll find instructions on setting up Wallaroo and running applications. And take a look at our <a href="https://www.wallaroolabs.com/community">community page</a> to sign up for our mailing list or join our IRC channel to ask any question you may have.</p>

<p>You can also watch this video to see Wallaroo in action. Our VP of Engineering walks you through the concepts that were covered in this blog post using our Python API and then shows the word count application scaling by adding new workers to the cluster.</p>



<p>Our Go API is new, and we are looking at ways to improve it. We have a lot of ideas of our own, but if you have any ideas, we would love to hear from you. Please don’t hesitate to get in touch with us through <a href="https://groups.io/g/wallaroo">our mailing list</a> or <a href="https://webchat.freenode.net/?channels=#wallaroo">our IRC channel</a>. We also have a short (30 seconds) <a href="https://wallaroolabs.typeform.com/to/PkC7iT?source=blog">survey</a> that will help us learn more about the people who are interested in using the Go API, so if that’s you then I’d encourage you to go fill it out.</p>

<p>We built Wallaroo to help people create applications without getting bogged down in the hard parts of distributed systems. We hope you’ll take a look at our <a href="https://github.com/wallaroolabs/wallaroo">GitHub repository</a> and get to know Wallaroo to see if it can help you with the problems you’re trying to solve. And we hope to hear back from you about the great things you’ve done with it.</p>

    </div>
        </div>
    </article>
    <article id="article-15" class="hn-article" data-index="15">
        <h1 class="title">
            <a href="https://www.bloomberg.com/news/features/2018-01-18/the-fall-of-travis-kalanick-was-a-lot-weirder-and-darker-than-you-thought">
                The Fall of Travis Kalanick
            </a>
        </h1>
        <p class="meta">
            <a href="https://www.bloomberg.com/news/features/2018-01-18/the-fall-of-travis-kalanick-was-a-lot-weirder-and-darker-than-you-thought">www.bloomberg.com</a>
            -
            <a href="https://news.ycombinator.com/item?id=16176216" target="_blank">Comments</a>
        </p>
        <div>
            <div>
            <p class="section-break">A year ago, before the investor lawsuits and the federal investigations, before the mass resignations, and before the connotation of the word “Uber” shifted from “world’s most valuable startup” to “world’s most dysfunctional,” Uber’s executives sat around a hotel conference room table in San Francisco, trying to convince their chief executive officer, Travis Kalanick, that the company had a major problem: him.</p><p>The executives were armed that day with something unusual for <a href="/quote/0084207D:US">Uber Technologies Inc.</a>: the results of a survey. Kalanick operated by gut feeling and with a stubborn sense of how people should feel, not how they did. Jeff Jones, Uber’s new president and former chief marketing officer for Target Corp., wanted more substantial insights. Conclusions drawn from the survey were printed and hanging on the walls. About half the respondents had a positive impression of Uber and its convenient ride-hailing app. But if respondents knew anything about Kalanick, an inveterate flouter of both workplace conventions and local transportation laws, they had a decidedly negative view.</p>
    <p>As usual with Kalanick, the discussion grew contentious. Jones and his deputies argued that Uber’s riders and drivers viewed the company as made up of a bunch of greedy, self-centered jerks. And as usual, Kalanick retorted that the company had a public-relations problem, not a cultural one.</p><p>Then a top executive excused herself to answer a phone call. A minute later, she reappeared and asked Kalanick to step into the hallway. Another executive joined them. They hunched over a laptop to watch a <a href="https://www.bloomberg.com/news/articles/2017-02-28/in-video-uber-ceo-argues-with-driver-over-falling-fares">video that had just been posted online</a> by Bloomberg News: grainy, black-and-white dashcam footage of Kalanick in the back seat of an UberBlack on Super Bowl weekend, heatedly arguing over fares with a driver named Fawzi Kamel.</p><p>“Some people don’t like to take responsibility for their own shit!” Kalanick can be heard yelling at Kamel. “They blame everything in their life on somebody else!”</p><p>As the clip ended, the three stood in stunned silence. Kalanick seemed to understand that his behavior required some form of contrition. According to a person who was there, he literally got down on his hands and knees and began squirming on the floor. “This is bad,” he muttered. “I’m terrible.”</p><p>Then, contrition period over, he got up, called a board member, demanded a new PR strategy, and embarked on a yearlong starring role as the villain who gets his comeuppance in the most gripping startup drama since the dot-com bubble. It’s a story that, until now, has never been fully told.</p><div class="image"><div class="lazy-img"><img src="https://assets.bwbx.io/images/users/iqjWHBFdfxIU/iSLCLkfcXoSI/v2/-999x-999.gif" class="lazy-img__image" alt="-999x-999.gif" /></div></div><div class="news-figure-caption-text caption">Featured in <em>Bloomberg Businessweek</em>, Jan. 22, 2018. <a href="https://subscribe.businessweek.com/servlet/OrdersGateway?cds_mag_code=BWK&amp;cds_page_id=221240&amp;source=coverstoryrail">Subscribe now</a>.</div><p>Illustration: Patrick Leger for Bloomberg Businessweek</p><p class="section-break">The melodrama began, in a sense, with Donald Trump. On Jan. 27 the newly inaugurated president issued his executive order imposing border restrictions on people from seven Muslim countries. Outrage erupted. People took to the streets; tech workers in Silicon Valley walked out of their offices in symbolic protest. And in New York, a small union called the New York Taxi Workers Alliance declared that there would be no taxi pickups from 6 p.m. to 7 p.m. on Saturday night at John F. Kennedy International Airport.</p><p>For Uber, that would create extra demand at the airport, which meant it could charge more—but this would probably cause a backlash. That had happened before when the company let its “surge pricing” algorithms do their thing. So the New York managers decided to be good citizens and suspend surge pricing for the night.</p><p>The backlash hit anyway. After years of <a href="https://www.bloomberg.com/news/features/2017-10-11/uber-pushed-the-limits-of-the-law-now-comes-the-reckoning">negative revelations</a>—spying on passengers, dubious <a href="https://www.bloomberg.com/news/articles/2016-12-14/uber-rolls-out-self-driving-cars-in-san-francisco-without-dmv-approval">driverless-car experiments</a> in San Francisco, the CEO’s bragging about sexual conquests, to name just a few—the public was already inclined to believe the worst of Uber. If the company wasn’t price gouging this time, maybe it was trying to break up the JFK strike. A new hashtag was trending on Twitter: <a href="https://twitter.com/hashtag/deleteuber">#deleteuber</a>. Users deleted their accounts by the thousands. <a href="/quote/0812823D:US">Lyft Inc.</a>, the rival service that branded itself the anti-Uber, capitalized on the moment and <a href="http://beta.latimes.com/politics/washington/la-na-trailguide-updates-lyft-pledges-to-donate-1-million-to-1485713226-htmlstory.html">donated</a> $1 million to the American Civil Liberties Union.</p><p>Further stoking the flames was Kalanick’s decision to join Trump’s business advisory council. Kalanick argued that his participation in the council wasn’t an endorsement of the president; he just wanted a seat at the table, along with Elon Musk, International Business Machines Corp.’s Ginni Rometty, and Walt Disney Co.’s Bob Iger. But intentions didn’t seem to matter. Criticism from riders and drivers intensified, and Kalanick spent days talking to his executives about what to do. They considered whether he should go to the first meeting and find some pretense to object and leave; he even floated the idea of wearing a protest T-shirt to the council meeting, according to people familiar with the discussions.</p><p>Ultimately, Kalanick decided the whole thing wasn’t worth the trouble and his minders set up a call so he could politely say no to Trump. A chronic pacer, Kalanick walked away from his desk at the appointed time. The first call from the White House came—and went to Kalanick’s voicemail. Then came the second call. Trump was on the line, and Kalanick walked into a glass-walled conference room to deliver the news. The conversation apparently went as one would expect. Kalanick emerged to tell his colleagues that the president was “super un-pumped.”</p><p class="passage"><span class="news-designed-for-consumer-media">“You could go into Uber on any given day and half the T-shirts were Uber T-shirts. They disappeared overnight”</span></p><p>In mid-February, an engineer named Susan Fowler penned a blog post, “<a href="https://www.susanjfowler.com/blog/2017/2/19/reflecting-on-one-very-strange-year-at-uber">Reflecting on One Very, Very Strange Year at Uber</a>,” about the sexual harassment she had witnessed in her time at the company. The explosive response to that post prompted Kalanick to hire Eric Holder Jr., the former U.S. attorney general and a partner at the firm Covington &amp; Burling LLP, to lead an investigation into Fowler’s claims. “We will leave no stones unturned,” Holder <a href="https://www.bloomberg.com/news/articles/2017-02-24/uber-investigator-eric-holder-asserts-his-independence">told</a> Bloomberg News at the start of his inquiry. “This company has one opportunity to get this right.”</p><p>But the hits kept coming. The infamous <a href="https://www.youtube.com/watch?v=gTEDYCkNqns">dashcam footage</a> surfaced; a few weeks later, the <em>New York Times</em> reported on a secret Uber technology called <a href="https://www.nytimes.com/2017/03/03/technology/uber-greyball-program-evade-authorities.html?_r=0">Greyball</a>, which the company developed to identify and deny service to riders who had violated the company’s contractual terms. In some cities and countries, Uber managers used Greyball to avoid picking up taxi inspectors and other law enforcement officials who might want to ticket drivers or shut the service down.</p><p>A common factor in all these crises was Kalanick’s unrelenting combativeness. In meetings, he would alternately impress and alienate employees, investors, and his board. Over time, he turned a lot of friends into enemies with stories to tell. Jones, the president who had commissioned the public survey, <a href="https://www.bloomberg.com/news/articles/2017-03-19/uber-president-jones-said-to-quit-amid-turmoil-recode-reports">resigned in March</a> after only six months on the job, citing differences over “beliefs and approach to leadership.” In exit interviews with Uber board members, he was more specific, excoriating Kalanick’s shotgun management style and unwillingness to listen. Jones seemed so eager to leave the company that he declined to negotiate an exit package, potentially leaving millions of dollars behind.</p><p><a href="/quote/GOOG:US">Google</a>, too, should have been an ally. The company invested in Uber in 2013 and, four years later, owned a stake worth billions. But the two companies began to look more like competitors as both raced to build self-driving cars. What might have remained a friendly rivalry soured irrevocably when Uber bought the self-driving trucking startup Otto for more than $600 million in stock. Most of Otto’s core employees were former Googlers, led by their own brash co-founder, Anthony Levandowski. Google co-founder Larry Page had already grown to loathe Kalanick. Now he was fuming.</p>
    <p>Google <a href="https://www.bloomberg.com/news/articles/2017-02-23/alphabet-s-waymo-sues-uber-for-stealing-self-driving-patents">filed a lawsuit</a> in late February, accusing Uber of stealing its secrets. Its allegations were devastating, the most damning one being that Levandowski had downloaded 14,000 Google files before he quit to start Otto.</p><p>The legal fight, expected to go to trial shortly, may have been avoided if Kalanick had listened to his senior executives. Salle Yoo, Uber’s general counsel and typically not someone inclined to challenge her boss, expressed serious reservations about the deal, according to two people familiar with the discussions. Kalanick’s top deputy, business chief Emil Michael, stayed away from the transaction—he didn’t think it made much financial sense and risked a backlash from Google.</p><p>Meanwhile, private investigators hired to conduct due diligence on Otto before the acquisition closed learned that Levandowski had possessed five disks of data from Google’s driverless effort and other information that included “source code, design files, laser files, engineering documents and software related to Google self-driving cars,” according to the investigators. (Levandowski told investigators he’d destroyed the disks, a claim they said they couldn’t verify. Uber says its self-driving car technology doesn’t borrow from Google’s and that it never possessed Google’s files.)</p><p>Kalanick, who says he never read the investigators’ report, went forward with the deal anyway. And he agreed to protect Levandowski from legal attacks by Google. Kalanick was placing an enormous bet on someone who liked to play things fast and loose, even by the standards of Silicon Valley’s eccentric engineers.</p><p>Then, after Google filed its lawsuit, Levandowski told the court he was likely to invoke the Fifth Amendment’s protection against self-incrimination. He would no longer help defend Uber, further imperiling the company’s case. Uber’s top lawyer, Yoo, who was traveling, videoconferenced into a meeting with Kalanick and demanded Uber either put Levandowski on leave or dismiss him. Yoo’s deputy, Angela Padilla, who oversaw the case, agreed. Kalanick insisted that the company stick by Levandowski—that Kalanick’s “brother from another mother,” as he once described Levandowski, would eventually be vindicated.</p><p class="passage"><span class="news-designed-for-consumer-media">“It was like a bomb went off inside the company”</span></p><p class="section-break">By spring the public outcry against Kalanick was coming in loud and clear on the company’s surveys. On a question asking respondents what they thought of specific business leaders, he ranked dead last among tech CEOs and only slightly above the CEOs of Goldman Sachs Group Inc. and Wells Fargo &amp; Co. Employee morale was falling along with the CEO’s reputation. “Until 2017, you could go into Uber on any given day and half the T-shirts were Uber T-shirts,” says one executive. “They disappeared overnight. People didn’t want to wear Uber stuff.”</p><p>Kalanick was unable or unwilling to right himself. If anything, his judgment deteriorated. He decided that he should apologize privately to Kamel, the driver he berated on video. The plan was simple: meet with Kamel at some neutral and nonthreatening location, engage in five minutes of pleasantries, say sorry, and leave.</p><p>The meeting went on for more than an hour, with Kalanick re-debating Kamel over Uber’s pricing policies. Somehow, by the end, Kalanick suggested that he give the driver Uber stock, according to people familiar with the discussion.</p><p>Wayne Ting, who ran Uber’s San Francisco business, was in the room with Kalanick and Kamel. In an email later circulated among employees and directors, Ting said he was <a href="https://www.recode.net/2018/1/16/16822862/uber-travis-kalanick-driver-video-fawzi-kamel-cars">deeply disturbed</a> by what he saw. He told people he called his own father to seek moral counsel. He worried that paying the driver off with Uber’s own shares was financially irresponsible—would Uber compensate all of its drivers who felt mistreated? To Ting, the incident reeked of a lack of self-control. In the email, he wrote that Kalanick “no longer had the moral standing” to lead Uber. After Uber’s lawyers insisted the company wouldn’t pay Kamel to clean up Kalanick’s personal scandal, Kalanick agreed to pay Kamel $200,000 out of his own pocket, according to a person familiar with the matter. “The meeting ended on a positive note, and Travis appreciated Mr. Kamel’s openness and forgiveness,” a spokesperson for Kalanick said in a statement.</p><p>In late March, the tech publication the <a href="https://www.theinformation.com/uber-groups-visit-to-seoul-escort-bar-sparked-hr-complaint"><em>Information</em></a> published an account of a visit by Kalanick and other Uber executives to a karaoke bar in Seoul in 2014. Kalanick’s then-girlfriend Gabi Holzwarth, who went along on the work trip, told the <em>Information</em> that the bar was staffed by “escorts,” each woman labeled with a number so customers could pick them out more easily. (Holzwarth said she and Kalanick left the bar together after about an hour.)</p><div class="image"><div class="lazy-img"><img src="https://assets.bwbx.io/images/users/iqjWHBFdfxIU/ixMn9gI.UL5A/v17/60x-1.jpg" class="lazy-img__image" alt="60x-1.jpg" /></div></div><p>Uber execs allegedly hung out at a Seoul “karaoke” bar.</p><p>Illustration: Patrick Leger for Bloomberg Businessweek</p><p>In June, Bloomberg News and the tech blog Recode reported that Eric Alexander, Uber’s president for Asia-Pacific, had obtained and carried around the <a href="https://www.bloomberg.com/news/articles/2017-06-07/uber-workplace-probe-extends-to-handling-of-india-rape-case">confidential medical record</a> from a horrific December 2014 rape of a 26-year-old passenger by an Uber driver in Delhi. Alexander, Kalanick, and other executives had discussed among themselves a preposterous theory—that the rape may have been a setup by Ola, Uber’s primary rival in India. Through a spokesperson, Alexander declined to comment.</p><p>The Asia news—especially the India revelations—resonated as loudly inside Uber as outside. “It was like a bomb went off inside the company,” said one senior exec. After the story was published, many employees stayed home. There was a feeling that the company had gone too far.</p><p>A short time later, six members of Uber’s ELT, or Executive Leadership Team, sent a confidential letter to the board. The letter, according to a person familiar with the matter, asked for an independent board chairman to be appointed and for accountability at the highest levels of the company. They implored the board to fire Emil Michael, Alexander’s boss at the time as well as Kalanick’s closest deputy, and demanded the board force Kalanick to take at least a three-month leave of absence.</p><p class="section-break">Over the years, Kalanick had a simple method for dealing with Bill Gurley, one of his earliest backers and board members. Kalanick told colleagues that all he had to do was ignore Gurley’s phone calls and Gurley would call less often.</p><p>The silent treatment never seemed to bother Gurley much. A tall, affable Texan and a partner at venture capital firm <a href="/quote/17940Z:US">Benchmark</a>, he often appeared at conferences and on television evangelizing Uber and praising the entrepreneurial abilities of its CEO. In 2016, along with the rest of Uber’s board, he turned over more control to Kalanick as part of a $3.5 billion investment from Saudi Arabia’s sovereign wealth fund.</p><p>As 2017 wore on, Kalanick became even less communicative than normal. He was regularly missing or canceling leadership team meetings and wasn’t delivering on his declaration, made in a public letter, to hire “a Chief Operating Officer: a peer who can partner with me to write the next chapter in our journey.” In March, after years of trying, Gurley finally got himself appointed to the board’s audit committee and learned of the steep losses in Uber’s subprime vehicle-leasing division, which helped its drivers finance cars.</p><p>Gurley’s cheerleading turned into anxiety and then horror. Benchmark’s stake in Uber was worth billions; could that fall by half? Could it fall to zero? Would they all end up in court? People at Benchmark worried that the Uber situation was affecting Gurley’s health.</p>
    <p>Gurley and his partners declined to talk about the controversies at Uber and about what they did next. But in conversations with colleagues, relayed to <em>Bloomberg Businessweek</em>, Gurley expressed frustration over Kalanick’s handling of the Google lawsuit and his inexplicable reluctance to fire Levandowski, even though his senior advisers were urging him to do just that. In May, as part of Gurley’s gradual campaign for more influence at Uber, he and David Bonderman, co-founder of private equity firm TPG, drafted a resolution that would empower the board to fire Levandowski. Kalanick finally relented, and Levandowski was dismissed at the end of May.</p><p>By the time the six executives sent their letter to the board urging that Kalanick take a leave of absence, Gurley was ready to consider it. The directors met on Sunday, June 11, at the Los Angeles offices of Holder’s law firm, Covington &amp; Burling. They reviewed Holder’s report, which detailed not only a sequence of sexual harassment incidents at the company but also a culture of legal noncompliance that systematically equated rule-following with bureaucracy and failure. The board voted to adopt Holder’s 47 recommendations, including rewriting Uber’s absurdly bro-ish cultural values (“toe stepping,” “always be hustlin’ ”), restricting the consumption of alcohol at company events, and instituting an anonymous complaint process for employees.</p><p>There was no discussion about asking Kalanick to resign, but the board agreed to a temporary sabbatical for the CEO, on his own terms. Kalanick was grieving from a recent family tragedy—his mother, Bonnie, was killed and his father, Donald, seriously injured in a boating accident in Fresno, Calif. After the accident, Kalanick had been saying he would acquiesce to taking time off, as a way to both mourn and try to end the media storm.</p><p>Two days later, Arianna Huffington, the media entrepreneur and Kalanick’s staunchest ally on the board, led an all-hands meeting at Uber’s Market Street headquarters in San Francisco, announcing the board’s recommendations and Kalanick’s leave of absence. A 16-member committee of senior execs would run the company and institute a round of image-repairing changes, such as adding a long-debated tipping feature to the Uber app and updating the entire driver support operation.</p><p>Kalanick wasn’t at the all-hands meeting, nor did he come to the office over the following week. But employees and board members never stopped feeling his presence. According to numerous insiders, Kalanick was dialing into conference calls, reviewing internal data, and recruiting candidates to fill the open spots on the executive team. Gurley also heard from several major investors, saying that Uber’s finance team was quietly spreading the word that Kalanick was still in control.</p><p>Even in top-level conversations where Kalanick appeared to be absent, other executives and board members suspected that Huffington was serving as his proxy. The founder of the <em>Huffington Post</em> was a constant presence at Uber’s offices, making suggestions that seemed to promote her new wellness company, <a href="/quote/1559650D:US">Thrive Global Holdings LLC</a>. For example, she wanted to put “nap pods” at driver hubs and give drivers meditation wristbands. Huffington’s company received $50,000 in consulting fees from Uber. The perceived self-dealing didn’t go over well internally, and she had the money returned, according to a person familiar with the matter. A spokesperson for Huffington says that Thrive provided services at cost, and that Huffington refunded the fees when events required her to take on a more active role at Uber.</p><p class="section-break">Founders enjoy an exalted status in Silicon Valley. Apple Inc. once fired Steve Jobs; then he came back and led it to historic greatness. The dismissal of a successful founder has been considered a cardinal sin ever since. Benchmark is very Silicon Valley: You’re either 100 percent behind a CEO or against them. There is no in-between.</p><p>In a meeting at the firm’s offices in Woodside, Calif., a few days after Kalanick went on leave, Gurley and his partners came to a decision: Kalanick had to go, for good. They quietly reached out to other investors—First Round Capital, Menlo Ventures, Fidelity Investments, and Lowercase Capital—which all called meetings of their respective partnerships. Five signed a letter imploring Kalanick to resign.</p><p>On June 20, Benchmark dispatched two partners, Matt Cohler and Peter Fenton, to confront Kalanick in Chicago, where he was interviewing Walter Robb, the former co-CEO of Whole Foods Market Inc., for the open COO spot. The venture capitalists surprised Kalanick at the Ritz-Carlton hotel and presented him with a letter, titled “Moving Uber Forward.” It accused him of a number of leadership missteps that put the company in legal peril. It asked for his resignation as CEO and to relinquish the board seats he controlled.</p><p class="phrase"><span class="news-designed-for-consumer-media">Uber being Uber, nothing went as scripted</span></p><p>Benchmark viewed its letter as an opening gambit. The firm and the other investors represented only about 40 percent of Uber’s voting shares—not enough to force a resignation. But it had other kinds of leverage. Cohler and Fenton told Kalanick he had a few hours before they went public with their allegations. They also said that if he resigned, they would tell the world he had quit on his own terms.</p><p>Kalanick spent the next few hours in a panic, consulting with Robb and calling allies, lawyers, and investors. In the late afternoon, Huffington called Kalanick and prodded him to step aside. The two agreed that the letter was the first move in a lawsuit for fraud and the likely start of a bitter fight for control that would further damage the company he helped build.</p><p>Kalanick later told friends that, after “five months of pummeling,” he lacked the energy for another fight. So, to the surprise of the two Benchmark partners and Gurley, who saw little chance that he would acquiesce, Kalanick signed the documents at the Ritz in Chicago.</p><p>Uber being Uber, nothing went as scripted. The <em>New York Times</em> ran a <a href="https://www.nytimes.com/2017/06/21/technology/uber-ceo-travis-kalanick.html">detailed story about the resignation</a>, infuriating Kalanick. What he believed was going to be a graceful departure now looked like the Benchmark-administered ouster it actually was.</p><p>Kalanick reneged on his agreement to let go of his board seat and the two others he controlled. He also began calling early Uber employees, asking whether he’d have their support should he call for a shareholder vote. On Aug. 10, Benchmark’s Cohler started contacting his board members from a safari in Africa to alert them: Benchmark was suing Kalanick in Delaware court, accusing him of fraud and of breaching his fiduciary duty. A few days later a group of investors loyal to Kalanick filed an amicus brief in support of him and against Benchmark. (Kalanick has denied Benchmark’s claims. Benchmark has agreed to drop the lawsuit once a deal with SoftBank Group Corp. goes through. Kalanick plans to sell one-third of his stake in the deal.)</p><div class="image"><div class="lazy-img"><img src="https://assets.bwbx.io/images/users/iqjWHBFdfxIU/iXMCRZlERpYQ/v1/60x-1.jpg" class="lazy-img__image" alt="60x-1.jpg" /></div></div><p>The ex-CEO is really into a smartphone puzzle game.</p><p>Illustration: Patrick Leger for Bloomberg Businessweek</p><p>Although he no longer came into the office, Kalanick managed to keep himself in the middle of the company’s affairs. He lobbied for his own pick as successor, former General Electric Co. chief Jeffrey Immelt. The Uber directors would have none of that—they suspected that Kalanick had secured an agreement from Immelt to serve for only two years, paving the way for his Jobs-like return. Kalanick also flew to Seattle to interview a wild-card candidate referred by investor TPG: Expedia Inc. CEO Dara Khosrowshahi, who later marveled to friends that it certainly felt like Kalanick was still in charge.</p><p>Indeed, Kalanick had some tepid support inside the company. But his vote counting rankled even his defenders. He was also calling executives daily, asking for detailed information about the business. Even worse, he ordered the security team to dig through an employee’s email to see if that person was leaking a potentially damaging story. It all proved too much for the 16-person executive team, which signed a letter to Uber’s board—but clearly directed at Kalanick—asking them to refrain from reaching out to employees or meddling in the company’s daily affairs. Kalanick’s own handpicked executives turned against him.</p><p class="section-break">Somehow, amid the dysfunction, Uber hired Khosrowshahi, who impressed the board with a thoughtful PowerPoint presentation that included a slide that read, “There can be only one CEO at a time.” Khosrowshahi was all that Kalanick wasn’t or couldn’t be: humble, a good listener, and a diplomat. In a pointed reversal of Kalanick’s mantra, he would say: “We don’t have a PR problem; we have an ‘us’ problem—we have behaved poorly.” And when the city of London revoked Uber’s operating license in September, Khosrowshahi visited, met with taxi regulators, and published an open letter. “On behalf of everyone at Uber globally, I apologize,” he wrote. “We will appeal this decision on behalf of millions of Londoners, but we do so with the knowledge that we must also change.”</p><p>It would be Khosrowshahi’s responsibility to find capital infusions (such as the recent investment by a consortium led by SoftBank), cut the company’s burn rate (2017 losses: $4 billion), settle some of its legal problems (lawyer fees over two years: an estimated $500 million), and march toward a 2019 initial public offering.</p><p>Kalanick has privately told people he thought the apology tour was a mistake. But his opinion no longer matters—Uber’s new COO, Barney Harford, says he was hired without ever meeting him. The SoftBank deal will make Kalanick a billionaire. Friends say he’s trying to keep busy. He’s setting up a family office and spending time with his father in Los Angeles. And he’s getting very good at <em>2048</em>, the single-player smartphone puzzle game.</p><p><strong>For more on Uber, check out the <em>Decrypted</em>  podcast:</strong></p><p><a class="bbg-embed" href="https://cms.megaphone.fm/channel/BLM3923153289?selected=BLM4274993596">https://cms.megaphone.fm/channel/BLM3923153289?selected=BLM4274993596</a></p>
    <p> </p>
        </div>
        </div>
    </article>
    <article id="article-16" class="hn-article" data-index="16">
        <h1 class="title">
            <a href="https://www.bloomberg.com/amp/news/articles/2018-01-18/emirates-airline-orders-36-airbus-a380s-worth-16-billion-jckc224w">
                Emirates Orders 20 A380s Worth $9B
            </a>
        </h1>
        <p class="meta">
            <a href="https://www.bloomberg.com/amp/news/articles/2018-01-18/emirates-airline-orders-36-airbus-a380s-worth-16-billion-jckc224w">www.bloomberg.com</a>
            -
            <a href="https://news.ycombinator.com/item?id=16176117" target="_blank">Comments</a>
        </p>
        <div>
            <div>
            <p><a href="/quote/AIR:FP" title="Company Overview">Airbus SE</a> won a program-saving order for its A380 superjumbo that could be worth $16 billion at list prices and add at least a decade to the model’s lifespan.</p><p>Persian Gulf carrier <a href="/quote/1000Z:UH" title="Company Overview">Emirates</a>, already the biggest A380 customer, signed an outline agreement for 20 of the double-deckers with an option to buy 16 more, the Dubai-based company said Thursday, handing Airbus its first orders for the flagship model in more than two years.</p><p>Photographer: Scott Eisen/Bloomberg</p><p>The purchase will extend A380 production until 2029 if Emirates takes all of the planes, according to Airbus, which as recently as Monday had acknowledged that the program could be terminated without a new sale soon. The carrier had scuttled a deal for the same number of aircraft in November amid doubts about the manufacturer’s commitment to improving the plane.</p>
        <p>“This new order underscores Airbus’s commitment to produce the A380 at least for another 10 years,” John Leahy, the planemaker’s outgoing sales chief, said in a statement. “I’m personally convinced more orders will follow Emirates’s example.”</p><p>The new aircraft will be delivered from 2020, with engine options still under evaluation. Rolls-Royce Holdings Plc is supplying turbines as part of Emirates’s most recent order for 50 A380s, while the Engine Alliance of <a href="/quote/GE:US" title="Company Overview">General Electric Co.</a> and Pratt &amp; Whitney powered the previous 90.</p><p>If Emirates signs off on the full deal it will have committed to a total of 178 A380s, or more than half of all orders for the plane worldwide. The carrier currently has 101 superjumbos in its fleet, and many older aircraft will have been phased out before the new batch arrives.</p><p><a href="https://www.bloomberg.com/news/articles/2017-11-17/drama-in-the-desert-how-airbus-s-a380-deal-in-dubai-evaporated" title="Click for full story">For a recap of the high-tension earlier talks with Emirates, click here</a></p><p>Emirates Chairman Sheikh Ahmed bin Saeed Al Maktoum, who signed the deal with Leahy in Dubai, said the carrier will work with Airbus “to further enhance the aircraft and onboard product.”</p>
        <p>As of the end of last year, Airbus had a total of 95 unfilled A380 orders, though only 48 of those, the vast bulk from Emirates, can be regarded as credible, according to Jefferies International Ltd. analyst Sandy Morris.</p><p>Airbus shares rose as much as 2.7 percent and traded 1.9 percent higher as of 12:11 p.m. in Paris.</p>
        
    
        </div>
        </div>
    </article>
    <article id="article-17" class="hn-article" data-index="17">
        <h1 class="title">
            <a href="https://puri.sm/posts/librem5-progress-report-1/">
                Librem 5 Phone Progress Report
            </a>
        </h1>
        <p class="meta">
            <a href="https://puri.sm/posts/librem5-progress-report-1/">puri.sm</a>
            -
            <a href="https://news.ycombinator.com/item?id=16175950" target="_blank">Comments</a>
        </p>
        <div>
            <div>
				
                         <p>First, let me apologize for the silence. It was not because we went into hibernation for the winter, but because we were so busy in the initial preparation and planning of a totally new product while simultaneously orienting an entirely new development team. Since we are more settled into place now, we want to change this pattern of silence and provide regular updates. Purism will be giving weekly news update posts regarding the <a href="https://puri.sm/shop/librem-5/">Librem 5 phone</a> project, alternating progress reports on two fronts:</p>
<ul>
<li>from the technology development point of view (the hardware, kernel, OS, etc.);</li>
<li>from the design department (UI+UX), and our collaboration with GNOME and KDE.</li>
</ul>
<p>To kickoff this new update process, today’s post will discuss the organizational and technological progress of the <a href="https://puri.sm/shop/librem-5/">Librem 5</a> project since November 2017.</p>

<p>Just after our successful pre-order crowdfunding campaign (by the way, thank you to all of the backers!) we started to reach out to people who had applied for jobs related to the Librem 5 project. We had well <strong>over 100 applicants</strong> who showed great passion for the project and had excellent resumes.</p>
<p>Our applicants came from all over the world  with some of the most diverse backgrounds I have ever seen. Todd Weaver (CEO) and myself did more than 80 interviews with applicants over a two weeks period. In the end, <strong>we had to narrow down to 15 people</strong> that we would make offers to; it was with great regret that we had to turn down so many stellar applicants, but we had to make decisions in a timely fashion and unfortunately the budget isn’t unlimited. During the weeks that followed, we negotiated terms with our proposed team members and started to roll new people into the team (with all that involves in an organizational setting). All of the new team members are now on board as of January 2018. They are not yet shown on our team page, but we will add them soon and make an announcement to present all the individuals who have recently joined our team.</p>
<p>As amazing as our community is, we also received applications from individuals who are so enthusiastic about our project that they want to help us as volunteers! We will reach out to them shortly, now that the core team is in place and settled.</p>
<p>There are so many people to thank for the successful jump start of our phone development project! It was amazing for us to see how much energy and interest we were able to spark with our project. We want to give a big thank you to everyone for reaching out to us and we really appreciate every idea and applicant.</p>

<img class="wp-image-47306" src="https://puri.sm/wp-content/uploads/2018/01/I.MX6QP-BLOCK-DIAGRAM-300x210.jpg" alt="" width="452" height="316" />Block Diagram i.MX6
<p>During our early phase we used a <a href="https://www.nxp.com/products/processors-and-microcontrollers/applications-processors/i.mx-applications-processors/i.mx-6-processors:IMX6X_SERIES">NXP i.MX6</a> SOC (System On Chip) to begin software evaluation, and the results were pretty promising. This was why we listed the i.MX6 in the campaign description. The most important feature of the i.MX6 was that it is one of only a handful of SOCs supported by a highly functional free software GPU driver set, the <a href="https://github.com/etnaviv">Etnaviv</a> driver. The Etnaviv driver has been included in the Linux mainline kernel for quite some time and the matching MESA support has evolved nicely. Briefly after our announcement we were contacted by one of the key driving forces behind the Etnaviv development effort which provides us with valuable insight in to this complex topic.</p>
<p> </p>
<img class="wp-image-47307" src="https://puri.sm/wp-content/uploads/2018/01/NXP-iMX_8M_BlockDiagram-FINAL-300x254.jpg" alt="" width="434" height="367" />Block Diagram i.MX8
<p>Further work with the i.MX6 showed us that it still uses quite a lot of power so when put under load it would drain a battery quickly, as well as warm up the device.</p>
<p>NXP had been talking about a new family of SOCs, the <a href="https://www.nxp.com/products/processors-and-microcontrollers/applications-processors/i.mx-applications-processors/i.mx-8-processors:IMX8-SERIES">i.MX8</a>, which would feature a new silicon processor and updated architecture. The release of the i.MX8 had been continuously postponed. Nevertheless, once we realized that the i.MX6 might be too power hungry, the i.MX8 became appealing to us. Hardware prototype operations are always tricky because you have to plan for emerging technologies that you meld with existing parts or materials. Components from original manufacturers sometimes never get released, are discontinued or the availability from the factory grinds to a halt for reasons beyond our control. This is the function of engaging in prototype development so that we can suffer the slings and arrows for you to provide the customer the best possible end product. We have been in active communication with all of our suppliers preparing a development plan that is beneficial for all of us.</p>
<p>At CES in Las Vegas, NXP announced the product release dates for their new SOC, the i.MX8M, along with a set of documentation. This is currently the most likely candidate we will use in the Librem 5. We are very excited about this timely announcement! At Embedded World in Nürnberg, Germany, NXP will announce details and a roadmap. We will be attending and discuss with NXP directly about the i.MX8M for the Librem 5.</p>
<p>We have also decided to use AARCH64, a.k.a. “ARM64”, for the phone software builds as soon as we have i.MX8 hardware. A build server for building ARM64 is now in place and the PureOS development team is beginning to work with the Librem 5 development team on the build process. Adding a second architecture for the <a href="https://www.fsf.org/news/fsf-adds-pureos-to-list-of-endorsed-gnu-linux-distributions-1">FSF endorsed</a> PureOS—that will run on Librem laptops as well as the Librem 5 phone—is a major undertaking that will benefit all future Librem 5 phone development.</p>

<p>Since the i.MX8 is still not yet easily available, and in order not to unnecessarily slow development progress, we need similar hardware to start developing software. We switched to an i.MX6 Quad Plus board which should provide similar speed for the GPU to what we will find in the i.MX8M. From our contact from the Etnaviv developers we know that they are heavily working on the i.MX8M support so we can expect that Etnaviv will be working on it within the year.</p>
<p>One of the big tasks of our software and design teams, working with our partners (GNOME, KDE, Matrix, Nextcloud, and Monero), will be to create a proper User Interface (UI) and User Experience (UX) for a phone screen. The challenges are that the screen will be between 5″ to 5.5″ diagonally with a resolution of up to full HD (1920×1080), and a functional touchscreen! The amazing teams developing <a href="https://www.gnome.org/">GNOME</a> and <a href="https://www.kde.org/plasma-desktop">KDE/Plasma</a> have already done a great job laying the groundwork technologies and setting up this kind of interface to build, develop, and test with. With such great partners and development teams we are confident that we can successfully integrate the freedom, privacy, and security of <a href="https://pureos.net/">PureOS</a> with phone hardware to provide a beautiful user experience.</p>
<p><img class="alignright size-full wp-image-47309" src="https://puri.sm/wp-content/uploads/2018/01/wayland.png" alt="" width="117" height="150" /></p>
<p>To help with development, we are already in the process of sourcing components to attach 5.5″ full HD displays to our development boards. Our development boards are already booting a mainline kernel into a <a href="https://wayland.freedesktop.org/">Wayland UI</a> nicely. We are evaluating similar displays from several manufacturers. We found a supplier for a matching adapter logic board (HDMI to MIPI). Our hardware engineer has already designed an additional adapter for interfacing the display’s touchscreen so that we will realistically have a 5.5″ full HD screen with touch capability on our development boards.</p>

<p>The overall plan is to have a custom device manufacturing process setup somewhere where we can manufacture our own devices. Since November of last year we have been intensively researching and evaluating potential manufacturing partners. So far we have been in contact with over 80 potential fabricators and are in the process of negotiating capabilities and terms. No decision has been made yet. We have some promising prospects from all over the world, including Asia, Europe and the USA, and we plan on visiting some of these sites in person possibly by the end of February or March.</p>

<p>Now that the development team is in place we will be reaching out to our partners. Our UI/UX design team along with phone dev team are working with the GNOME UI/UX team to develop a path forward for mobile interfaces. We will also reach out to others who have partnered with us during the campaign, such as the KDE/Plasma team, Matrix, Nextcloud, Monero and many more.</p>

<p>I hope that the fog has been lifted, and we have answered questions you might have or assuaged fears of our silence. We hope that you enjoyed this first dive into our development process. We here at Purism are all very excited about the Librem 5 phone project, as we are passionate about all of our products, with the phone holding a special place in our hearts and those of the Free Software community. That’s what makes us different from companies rolling out “yet another Android phone”, swapping color palettes or removing headphone jacks under the guise of “innovation”…</p>
<p>See you next week for more news on the Librem 5 project!</p>
		
	</div>
        </div>
    </article>
    <article id="article-18" class="hn-article" data-index="18">
        <h1 class="title">
            <a href="https://www.youtube.com/watch?v=NGFhc8R_uO4">
                Indistinguishable from Magic: Manufacturing Modern Computer Chips (2012) [video]
            </a>
        </h1>
        <p class="meta">
            <a href="https://www.youtube.com/watch?v=NGFhc8R_uO4">www.youtube.com</a>
            -
            <a href="https://news.ycombinator.com/item?id=16175949" target="_blank">Comments</a>
        </p>
        <div>
            <div><p>Talk in HOPE09, NYC</p><p>Modern computer chips are using transistors with features as small as 22nm. They are produced in factories that are 10,000 times cleaner than an operating room that can think like Skynet. Combined, the chips they produce run everything from your cell phone to the Internet itself. While outsiders might see it as the realm of multi-billion dollar corporations, in reality, it has been achieved through a hardcore application of the hacker mindset. Each new advancement involves hacking the theories of electrical engineering, hacking waves of light, and sometimes hacking physics. In this talk, we will go over how and why the design of a modern nanoscale transistor was developed. We will also talk about the processes used to build them, and the incredible equipment that makes it all possible. Plus some fun stories about what goes wrong.</p></div>
        </div>
    </article>
    <article id="article-19" class="hn-article" data-index="19">
        <h1 class="title">
            <a href="https://newsroom.intel.com/news/firmware-updates-and-initial-performance-data-for-data-center-systems/">
                Intel: Firmware Updates and Initial Performance Data for Data Center Systems
            </a>
        </h1>
        <p class="meta">
            <a href="https://newsroom.intel.com/news/firmware-updates-and-initial-performance-data-for-data-center-systems/">newsroom.intel.com</a>
            -
            <a href="https://news.ycombinator.com/item?id=16175945" target="_blank">Comments</a>
        </p>
        <div>
            
        </div>
    </article>
    <article id="article-20" class="hn-article" data-index="20">
        <h1 class="title">
            <a href="https://www.airhelp.com/en/ahlp/travels/">
                Show HN: AirHelp flight scanner finds all past flights and checks for eligibility
            </a>
        </h1>
        <p class="meta">
            <a href="https://www.airhelp.com/en/ahlp/travels/">www.airhelp.com</a>
            -
            <a href="https://news.ycombinator.com/item?id=16175814" target="_blank">Comments</a>
        </p>
        <div>
            <div><h2>About Us</h2><p class="my-travels-about-us__paragraph">We’re here to end your flying woes once and for all. We help air passengers around the world secure compensation for delayed, canceled, or overbooked flights. We’re also the first service to provide a free map with your personal travel stats in just one click.</p></div>
        </div>
    </article>
    <article id="article-21" class="hn-article" data-index="21">
        <h1 class="title">
            <a href="http://www.bbc.com/news/business-42626790">
                Cape Town could be the first city to run out of water
            </a>
        </h1>
        <p class="meta">
            <a href="http://www.bbc.com/news/business-42626790">www.bbc.com</a>
            -
            <a href="https://news.ycombinator.com/item?id=16175757" target="_blank">Comments</a>
        </p>
        <div>
            <div>
        
            <span class="image-and-copyright-container">
                
                <img class="js-image-replace" alt="Aerial view of Cape Town South Africa" src="https://ichef.bbci.co.uk/news/320/cpsprodpb/13186/production/_99541287_gettyimages-578312226.jpg" width="976" height="549" />
                
                
                
                 <span class="off-screen">Image copyright</span>
                 <span class="story-image-copyright">Getty Images</span>
                
            </span>
            
            
                <span class="off-screen">Image caption</span>
                <span class="media-caption__text">
                    There's water all around Cape Town, South Africa, but little of it is drinkable
                </span>
            
            
        <p class="story-body__introduction">Cape Town, home to Table Mountain, African penguins, sunshine and sea, is a world-renowned tourist destination. But it could also become famous for being the first major city in the world to run out of water.</p><p>Most recent projections suggest that its water could run out as early as March. The crisis has been caused by three years of very low rainfall, coupled with increasing consumption by a growing population.  </p><p>The local government is racing to address the situation, with desalination plants to make sea water drinkable, groundwater collection projects, and water recycling programmes.</p><ul class="story-body__unordered-list"><li class="story-body__list-item"><a href="/news/science-environment-39482342" class="story-body__link">Graphene sieve makes seawater drinkable</a></li></ul><p>Meanwhile Cape Town's four million residents are being urged to conserve water and use no more than 87 litres (19 gallons) a day. Car washing and filling up swimming pools has been banned. <a href="http://www.bbc.co.uk/news/blogs-news-from-elsewhere-42578484" class="story-body__link">And the visiting Indian cricket team were told to limit their post-match showers to two minutes. </a></p>
            <span class="image-and-copyright-container">
                
                
                
                
                
                 <span class="off-screen">Image copyright</span>
                 <span class="story-image-copyright">Getty Images</span>
                
            </span>
            
            
                <span class="off-screen">Image caption</span>
                <span class="media-caption__text">
                    South Africa's Western Cape region is suffering its worst water shortage in more than a hundred years
                </span>
            
            
        <p>Such water-related problems are not confined to Cape Town, of course.  </p><p>Nearly 850 million people globally lack access to safe drinking water, says the World Health Organization, and droughts are increasing. </p><p>So it seems incredible that we still waste so much of this essential natural resource. In developing and emerging countries, up to 80% of water is lost through leakages, according to German environmental consultancy GIZ. Even in some areas of the US, up to 50% of water trickles away due to ageing infrastructure. </p><p>A growing number of technology companies are focusing their work on water management - applying "smart" solutions to water challenges.</p><h2 class="story-body__crosshead">More Technology of Business</h2>
            <span class="image-and-copyright-container">
                
                
                
                
                
                 <span class="off-screen">Image copyright</span>
                 <span class="story-image-copyright">Getty Images</span>
                
            </span>
            
        <p>For example, French company CityTaps is on a mission to streamline water access in urban homes with its smart water meters linked to an internet-based management system.  </p><p>The company is first targeting poor homes in urban areas and its system, CTSuite, is currently being trialled in Niger.  </p><p>Users buy "water credits" via their mobile phones and a smart meter dispenses only as much water as has been paid for. Users receive alerts when their credit balance gets low, and if they don't top up the account, the meter automatically switches off the flow.  </p>
            <span class="image-and-copyright-container">
                
                
                
                
                
                 <span class="off-screen">Image copyright</span>
                 <span class="story-image-copyright">CityTaps</span>
                
            </span>
            
            
                <span class="off-screen">Image caption</span>
                <span class="media-caption__text">
                    The CityTaps smart water meter is fairly easy to install
                </span>
            
            
        <p>The utility can track water usage remotely in near real-time via the internet. A sudden spike in water outflow and a change in pressure, measured by "internet of things" sensors, can then help identify leaks across the network.</p><p>Water companies are also using drones and satellites to help spot leaks, <a href="http://www.bbc.co.uk/news/uk-england-oxfordshire-42070719" class="story-body__link">and in some circumstances even divining rods - despite scientific doubts, some firms say they do work</a>.</p><p>"The internet of things offers new avenues for technological innovation in the water field, mostly by providing real-time data that - we hope - can be used to help utilities become ever more efficient and high-performing," says Gregoire Landel, chief executive of CityTaps.</p><p>Better water management also helps save on the electricity and chemicals required to produce drinkable water.</p>
            <span class="image-and-copyright-container">
                
                
                
                
                
                 <span class="off-screen">Image copyright</span>
                 <span class="story-image-copyright">CityTaps</span>
                
            </span>
            
            
                <span class="off-screen">Image caption</span>
                <span class="media-caption__text">
                    Families in Niger now have access to metered water they pay for via mobile phone
                </span>
            
            
        <p>Meanwhile, other companies are using technology to harvest water from new sources. </p><p>US-based WaterSeer, for example, is developing a device capable of collecting water from the air.</p><p>An internal fan draws air into an underground collection chamber where the vapour condenses, making use of the earth's cooler temperatures. Solar or electricity grid-powered coolers also help the condensation process.</p><p>The company says water can be produced with "less than a 100 watts" of electricity - the power requirement of an old-fashioned light bulb.</p>
            <span class="image-and-copyright-container">
                
                
                
                
                
                 <span class="off-screen">Image copyright</span>
                 <span class="story-image-copyright">WaterSeer</span>
                
            </span>
            
            
                <span class="off-screen">Image caption</span>
                <span class="media-caption__text">
                    WaterSeer's water condenser prototype is currently being tested and developed
                </span>
            
            
        <p>"Individuals and businesses will pave the way for innovative solutions, as they will be able to move and adopt a series of them quicker than large utilities that are sometimes mired in regulatory constraints and rigid decision-making cultures," says Nancy Curtis, a founding partner of WaterSeer.</p><p>"However, utilities offer the opportunity to make large-scale impacts on replenishing depleting water supplies."</p><ul class="story-body__unordered-list"><li class="story-body__list-item"><a href="/news/business-40404852" class="story-body__link">Can ice structures solve a Himalayan water crisis?</a></li></ul><p>A number of water-restricted municipalities in the US are exploring how WaterSeer devices could be used to improve water security, the company says. But the device is still being tested in the field, so these are early days.</p>
    <div class="player-with-placeholder">
            <img class="media-placeholder player-with-placeholder__image narrative-video-placeholder" src="https://ichef.bbci.co.uk/images/ic/720x405/p04jtdnm.jpg" alt="p04jtdnm.jpg" />
            <p>Media playback is unsupported on your device</p>
      
    </div>    <span class="off-screen">Media caption</span>How fog nets are catching water for the slums in Lima
<p>"A community of 500 would save 40 million US gallons (150m litres; 33m gallons) of water or more each year, reducing stress on traditional surface and underground sources," argues Ms Curtis. </p><p>Technology may have its place in helping us use water more efficiently, but it is unlikely to have much impact on those without any access to water in the first place, says Alexandros Makarigakis of Unesco's international hydrological programme (IHP).</p><p>"Smart water systems cannot be expected to have much impact regarding provision of access for the unconnected. [They] are more effective in the urban context," he says.</p><p>This is echoed by Vincent Casey, senior manager at the charity WaterAid. </p>
            <span class="image-and-copyright-container">
                
                
                
                
                
                 <span class="off-screen">Image copyright</span>
                 <span class="story-image-copyright">Getty Images</span>
                
            </span>
            
            
                <span class="off-screen">Image caption</span>
                <span class="media-caption__text">
                    In many rural areas around the world people have to walk miles to fetch water
                </span>
            
            
        <p>"The technology to connect people to a water supply has been around since ancient Egypt. It's not a technical problem," he says. </p><p>More important is how water supplies are organised, he argues, which is an issue primarily for governments, with support from the private sector.</p><p>"The priority is mobilising resources and paying sufficient attention to the management arrangement to keep people connected," says Mr Casey. </p><p>That's not to say WaterAid eschews tech completely. It has successfully used mobile app mWater to monitor water access and existing networks.</p><p>For those with no direct-to-home supply, services like Grundfos' "water ATM", which enables people to access water from a local dispenser using a pre-paid card, are also proving useful.</p><p>But there is a sense that much of this technology is merely tinkering at the edges. The overarching issue is the potentially devastating effect of global warming on water availability and how we, collectively, endeavour to tackle it.</p><ul class="story-body__unordered-list"><li class="story-body__list-item">Follow Technology of Business editor Matthew Wall on <a href="https://twitter.com/matthew_wall" class="story-body__link-external">Twitter</a> and <a href="https://www.facebook.com/MatthewWallBBC/" class="story-body__link-external">Facebook</a>
</li></ul><ul class="story-body__unordered-list"><li class="story-body__list-item"><a href="http://bbc.in/1LTVk7w" class="story-body__link-external">Click here for more Technology of Business features</a></li></ul>
    </div>
        </div>
    </article>
    <article id="article-22" class="hn-article" data-index="22">
        <h1 class="title">
            <a href="http://antoinevastel.github.io/bot%20detection/2018/01/17/detect-chrome-headless-v2.html">
                It is possible to detect and block Chrome headless
            </a>
        </h1>
        <p class="meta">
            <a href="http://antoinevastel.github.io/bot%20detection/2018/01/17/detect-chrome-headless-v2.html">antoinevastel.github.io</a>
            -
            <a href="https://news.ycombinator.com/item?id=16175646" target="_blank">Comments</a>
        </p>
        <div>
            <div>
	  <p>In August I wrote a <a href="/bot%20detection/2017/08/05/detect-chrome-headless.html"> post</a> on techniques to detect Chrome headless.
Since then I received messages saying that some of them were not working anymore.
After doing few tests on my computer, it happens that the last three techniques that used WebGL, feature detection as well 
as the size of the image used by Chrome when an image fails to load can’t be used anymore to detect Chrome headless.</p>

<p>Thus, in this post I’ll present techniques (new and from the previous post) that can be used to detect Chrome headless.</p>

<h2>User agent (Old)</h2>
<p>We start with a naive technique already presented in the previous post: the user agent.
It is the attribute commonly used to detect the OS as well as the browser of the user.
On a Linux computer with Chrome version 63 it has the following value: “Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/63.0.3071.115 Safari/537.36”</p>

<p>Thus, we can check for the presence of Chrome headless:</p>

<pre><code class="language-javascript"><span class="k">if</span> <span class="p">(</span><span class="sr">/HeadlessChrome/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nb">navigator</span><span class="p">.</span><span class="nx">userAgent</span><span class="p">))</span> <span class="p">{</span><br />    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Chrome headless detected"</span><span class="p">);</span><br /><span class="p">}</span></code></pre>

<p>User agent can also be obtained from the HTTP headers.
However, it is trivial to spoof if it in both cases.</p>

<h2>Webdriver (New)</h2>

<p>In order to automate Chrome headless, a new property <em>webdriver</em> is added to the navigator object (<a href="https://cs.chromium.org/chromium/src/out/Debug/gen/blink/bindings/core/v8/V8Navigator.cpp?rcl=0d3c47615a4f512b82fa0f8da682fb13332b8d32&amp;l=405">see Chromium code</a>).
Thus, by testing if the property is present it is possible to detect Chrome headless.</p>

<pre><code class="language-javascript"><span class="k">if</span><span class="p">(</span><span class="nb">navigator</span><span class="p">.</span><span class="nx">webdriver</span><span class="p">)</span> <span class="p">{</span><br />    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Chrome headless detected"</span><span class="p">);</span><br /><span class="p">}</span></code></pre>

<h2>Chrome (New)</h2>

<p><em>window.chrome</em> is an object that seems to provide features to Chrome extension developpers.
While it is available in vanilla mode, it’s not available in headless mode.</p>

<pre><code class="language-javascript"><span class="c1">// isChrome is true if the browser is Chrome, Chromium or Opera</span><br /><span class="k">if</span><span class="p">(</span><span class="nx">isChrome</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nb">window</span><span class="p">.</span><span class="nx">chrome</span><span class="p">)</span> <span class="p">{</span><br />    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Chrome headless detected"</span><span class="p">);</span><br /><span class="p">}</span></code></pre>

<h2>Permissions (New)</h2>

<p>It’s currently not possible to handle permissions in headless mode.
Thus, it leads to an inconsistent state where <em>Notification.permission</em> and <em>navigator.permissions.query</em> report
contradictory values.</p>

<pre><code class="language-javascript"><span class="nb">navigator</span><span class="p">.</span><span class="nx">permissions</span><span class="p">.</span><span class="nx">query</span><span class="p">({</span><span class="na">name</span><span class="p">:</span><span class="s1">'notifications'</span><span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">permissionStatus</span><span class="p">)</span> <span class="p">{</span><br />    <span class="k">if</span><span class="p">(</span><span class="nx">Notification</span><span class="p">.</span><span class="nx">permission</span> <span class="o">===</span> <span class="s1">'denied'</span> <span class="o">&amp;&amp;</span> <span class="nx">permissionStatus</span><span class="p">.</span><span class="nx">state</span> <span class="o">===</span> <span class="s1">'prompt'</span><span class="p">)</span> <span class="p">{</span><br />        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'This is Chrome headless'</span><span class="p">)</span>	<br />    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span><br />        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'This is not Chrome headless'</span><span class="p">)</span><br />    <span class="p">}</span><br /><span class="p">});</span></code></pre>

<p>Finally, I present two other methods that were already present in the previous post.</p>

<h2>Plugins (Old)</h2>
<p><em>navigator.plugins</em> returns an array of plugins present in the browser.
Typically, on Chrome we find default plugins, such as Chrome PDF viewer or Google Native Client.
On the opposite, in headless mode, the array returned contains no plugin.</p>

<pre><code class="language-javascript"><span class="k">if</span><span class="p">(</span><span class="nb">navigator</span><span class="p">.</span><span class="nx">plugins</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><br />    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"It may be Chrome headless"</span><span class="p">);</span><br /><span class="p">}</span></code></pre>

<h2>Languages (Old)</h2>
<p>In Chrome two Javascript attributes enable to obtain languages used by the user: <em>navigator.language</em> and <em>navigator.languages</em>.
The first one is the language of the browser UI, while the second one is an array of string
representing the user’s preferred languages.
However, in headless mode, navigator.languages returns an empty string.</p>

<pre><code class="language-javascript"><span class="k">if</span><span class="p">(</span><span class="nb">navigator</span><span class="p">.</span><span class="nx">languages</span> <span class="o">===</span> <span class="s2">""</span><span class="p">)</span> <span class="p">{</span><br />    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Chrome headless detected"</span><span class="p">);</span><br /><span class="p">}</span></code></pre>

	  </div>
        </div>
    </article>
    <article id="article-23" class="hn-article" data-index="23">
        <h1 class="title">
            <a href="https://youtube.com/watch?v=XBfEcxvJ6aY">
                TIS-100 Signal Averager (2016) [video]
            </a>
        </h1>
        <p class="meta">
            <a href="https://youtube.com/watch?v=XBfEcxvJ6aY">youtube.com</a>
            -
            <a href="https://news.ycombinator.com/item?id=16175439" target="_blank">Comments</a>
        </p>
        <div>
            <p><strong class="watch-time-text">Ajoutée le 12 janv. 2016</strong></p><div><p>This is a solution for Signal Averager, one of the levels in Zachtronics' game TIS-100. It runs in 705 cycles.</p><p>This video demonstrates my approach. We are asked to average two, 3-digit numbers. I have chosen to implement a + (b-a)/2, which is numerically a little cheaper than (a + b)/2, which also would have potential overflow issues here. In order to use this equation for the average, b must be greater than a, so that the quantity (b-a)/2 is positive. We actually operate on the inverse of this quantity, (a-b)/2, in order to save one cycle per pair of inputs negating, but the calculations are done as if we do not.</p><p>This solution is implemented as a 6-stage pipeline. The general approach, once we have decided which input is A and which is B, is to perform a binary search on (b-a) in order to find (b-a)/2. We do this by starting with the full possible space, [0, 999], and cut it in half each iteration. For the first iteration, if (b-a) is grater than 512, then we subtract 512 from (b-a) and add 256 to our average. We determine this by subtracting 512 from (b-a) and testing if it is less than zero (remember, when we started, we guaranteed that (b-a) was greater than zero). If (b-a) - 512 is less than 0, then it implies that (b-a) is less than 512. By the end of this iteration, we have doubled the resolution of what we know about (b-a), leaving us with a remainder somewhere in the range of [0, 512] and adding either 0 or 256 to our running average, depending on whether the remainder we started with was large or small. We turn this crank again and again, doubling the resolution each time.</p><p>To use a concrete example, let's take the first pair of inputs, 200 and 965, where a = 200 and b = 965. b - a = 765. 765 is greater than 512, so we subtract 512 from it and add 256 to a, so that a' is 456 and (b-a)' is 253. In the next iteration, we discover that 253 is less than 256, and so a'' is still 456 and (b-a)'' is still 253. We continue to repeat this process until we have fully resolved the value of (b-a), giving us our average value of 582.</p><p>There is one additional trick used by this pipeline in its last stage. By this point, our remainder has been clamped to [0, 7]. In order to shortcut through the last 3 iterations, we use a jump table which allows us to jump to (8 - remainder) at the very end. For example, if the remainder in the final stage were 0, we would jump ahead 8 spaces, which tells us to add nothing from this remainder. If it were 7, we would jump ahead 1 space and add 3 to our average (the specification asks us to round down).</p><p>The pipeline has been very aggressively scheduled in order to keep any stage from blocking for more than a few cycles. There are also a few quirks in routing necessary to deal with the lack of space we have in this problem. Finally, the solution has to flush itself after 39 inputs as it will actually lock before producing the last 3 outputs once the inputs have stopped. This is partially due to the scheduling and routing issues, as the pipeline expects to route and compute new inputs as it moves the outputs out. Without these inputs. there is nothing to push the outputs along the pipeline.</p><p>These are the stages of the pipeline<br />1. Input and compare inputs, decide which is A and which is B<br />2. Resolve -(b-a) 2 steps, from [-999, 0] to [-255, 0].<br />3. Resolve -(b-a) 2 steps, from [-255, 0] to [-63, 0]. This stage also routes values out of stage 4 to stage 5.<br />4. Resolve -(b-a) 2 steps, from [-63, 0] to [-15, 0]. This stage also routes values from stage 6 to the output.<br />5. Resolve -(b-a) 1 step, from [-15, 0] to [-7, 0]. This stage only occupies one cell, so it can only perform one step and still fit within the pipeline stage time of the other stages.<br />6. Use a jump table to fully resolve -(b-a) and compute the average value.</p></div>
        </div>
    </article>
    <article id="article-24" class="hn-article" data-index="24">
        <h1 class="title">
            <a href="http://www.neopets.com/help/html1.phtml">
                The Neopets HTML Guide
            </a>
        </h1>
        <p class="meta">
            <a href="http://www.neopets.com/help/html1.phtml">www.neopets.com</a>
            -
            <a href="https://news.ycombinator.com/item?id=16175257" target="_blank">Comments</a>
        </p>
        <div>
            <div>
										                                <p style="text-align:center;">
<a href="/help/html1.phtml">
<img src="http://images.neopets.com/help/h_0.gif" width="20" height="20" title="Main" alt="h_0.gif" style="border:0px solid;" /></a>

<a href="/help/html_1.phtml">
<img src="http://images.neopets.com/help/h_1.gif" width="20" height="20" title="The Basics" alt="h_1.gif" style="border:0px solid;" /></a>

<a href="/help/html_2.phtml">
<img src="http://images.neopets.com/help/h_2.gif" width="20" height="20" title="Insert Text" alt="h_2.gif" style="border:0px solid;" /></a>

<a href="/help/html_3.phtml">
<img src="http://images.neopets.com/help/h_3.gif" width="20" height="20" title="More Text" alt="h_3.gif" style="border:0px solid;" /></a>
 
<a href="/help/html_4.phtml">
<img src="http://images.neopets.com/help/h_4.gif" width="20" height="20" title="Change Colours" alt="h_4.gif" style="border:0px solid;" /></a>
 
<a href="/help/html_5.phtml">
<img src="http://images.neopets.com/help/h_5.gif" width="20" height="20" title="Insert Picture" alt="h_5.gif" style="border:0px solid;" /></a>
 
<a href="/help/html_6.phtml">
<img src="http://images.neopets.com/help/h_6.gif" width="20" height="20" title="Create Link" alt="h_6.gif" style="border:0px solid;" /></a>
 
<a href="/help/html_7.phtml">
<img src="http://images.neopets.com/help/h_7.gif" width="20" height="20" title="Add Email" alt="h_7.gif" style="border:0px solid;" /></a>
 
<a href="/help/html_8.phtml">
<img src="http://images.neopets.com/help/h_8.gif" width="20" height="20" title="Add Neocircle" alt="h_8.gif" style="border:0px solid;" /></a>
 
<a href="/help/html_9.phtml">
<img src="http://images.neopets.com/help/h_9.gif" width="20" height="20" title="Add Banner" alt="h_9.gif" style="border:0px solid;" /></a>
 
<a href="/help/html_10.phtml">
<img src="http://images.neopets.com/help/h_10.gif" width="20" height="20" title="Add Table" alt="h_10.gif" style="border:0px solid;" /></a>
 
<a href="/help/html_11.phtml">
<img src="http://images.neopets.com/help/h_11.gif" width="20" height="20" title="Add Music" alt="h_11.gif" style="border:0px solid;" /></a>

<a href="/help/html_12.phtml">
<img src="http://images.neopets.com/help/h_12.gif" width="20" height="20" title="Create Banner" alt="h_12.gif" style="border:0px solid;" /></a>

<a href="/help/html_13.phtml">
<img src="http://images.neopets.com/help/h_13.gif" width="20" height="20" title="Edit User Lookup" alt="h_13.gif" style="border:0px solid;" /></a>

</p><p>
<b>The Neopets HTML Guide</b></p><p>
Many people ask how to make cool shops like the ones in the Marketplace or how to make their 
Neopet's webpage look better. The answer is HTML. HTML is a language that is used to create webpages. 
It is very simple to learn and anyone can do it. You don't need to be a programmer or even to have 
really used a computer before. We have created a step-by-step guide to HTML that will take you right 
	through from the very basics to the pretty advanced HTML that we use on the Neopets site.  
</p><hr style="width:300px;" />
<table><tr>
<td valign="top">
<img src="http://images.neopets.com/help/h_1.gif" width="20" height="20" alt="h_1.gif" />
</td>
<td valign="top">
<a href="/help/html_1.phtml">
<b>The Basics</b></a>
</td><td valign="top"> 
This teaches the basic concept of the tags that make up HTML, 
as well as what HTML means and what will be covered in the next eleven lessons.
</td></tr>

<tr><td valign="top">
<img src="http://images.neopets.com/help/h_2.gif" width="20" height="20" alt="h_2.gif" />
</td><td valign="top">
<a href="/help/html_2.phtml">
<b>Insert Text</b></a>
</td>
<td valign="top">
Inserting text, dividing the page into paragraphs, making text bold, using italics, and changing font size 
</td></tr>
<tr>

<td valign="top">
<img src="http://images.neopets.com/help/h_3.gif" width="20" height="20" alt="h_3.gif" />
</td><td valign="top">
<a href="/help/html_3.phtml">
<b>More Text</b></a>
</td><td valign="top">
Creating bullet points and numbered lists, inserting horizontal rules.
</td></tr>

<tr>
<td valign="top">
<img src="http://images.neopets.com/help/h_4.gif" width="20" height="20" alt="h_4.gif" />
</td>
<td valign="top">
<a href="/help/html_4.phtml">
<b>Change Colours</b></a>
</td><td valign="top">
Changing the colour of your font and the entire webpage. 
Also, learn how to make your shop have a different coloured background. 
</td></tr>

<tr>
<td valign="top">
<img src="http://images.neopets.com/help/h_5.gif" width="20" height="20" alt="h_5.gif" />
</td><td valign="top">
<a href="/help/html_5.phtml">
<b>Insert Images</b></a>
</td><td valign="top">
Inserting a picture, adding a border, and arranging the 
picture on a page, plus giving your shop a background image .
</td></tr>

<tr><td valign="top">
<img src="http://images.neopets.com/help/h_6.gif" width="20" height="20" alt="h_6.gif" />
</td><td valign="top">
<a href="/help/html_6.phtml">
<b>Create Links</b></a>
</td><td valign="top">
Making a text link and turning an image into a link.
</td></tr>

<tr><td valign="top">
<img src="http://images.neopets.com/help/h_7.gif" width="20" height="20" alt="h_7.gif" />
</td><td valign="top">
<a href="/help/html_7.phtml">
<b>Add Username</b></a>
</td><td valign="top">
Adding your Neopets username
</td></tr>

<tr><td valign="top">
<img src="http://images.neopets.com/help/h_8.gif" width="20" height="20" alt="h_8.gif" />
</td><td valign="top">
<a href="/help/html_8.phtml">
<b>Add NeoCircle</b></a>
</td><td valign="top">
How to create a NeoCircle and how to add the link to your site
</td></tr>

<tr><td valign="top">
<img src="http://images.neopets.com/help/h_9.gif" width="20" height="20" alt="h_9.gif" />
</td><td valign="top">
<a href="/help/html_9.phtml">
<b>Add Banner</b></a>
</td><td valign="top">
How to add a Neopets banner or NeoBadge to your site
</td></tr>

<tr><td valign="top">
<img src="http://images.neopets.com/help/h_10.gif" width="20" height="20" alt="h_10.gif" />
</td><td valign="top">
<a href="/help/html_10.phtml">
<b>Tables</b></a>
</td><td valign="top">
How to create a table, reasons for using a table, as well as how to change table size and color.
</td></tr>

<tr><td valign="top">
<img src="http://images.neopets.com/help/h_11.gif" width="20" height="20" alt="h_11.gif" />
</td><td valign="top">
<a href="/help/html_11.phtml">
<b>Add Music</b></a> 
</td><td valign="top"> 
Livening up your shop or webpage by adding sounds.
</td></tr>


<tr><td valign="top">
<img src="http://images.neopets.com/help/h_12.gif" width="20" height="20" alt="h_12.gif" />
</td><td valign="top">
<a href="/help/html_12.phtml">
<b>Create Banner</b></a>
</td><td valign="top">
Create your own logo, banner, picture or beauty contest entry.
</td></tr>

<tr><td valign="top"> <img src="http://images.neopets.com/help/h_13.gif" width="20" height="20" alt="h_13.gif" />
</td><td valign="top">
<a href="/help/html_13.phtml">
<b>Edit User Lookup</b></a>
</td><td valign="top">
Customising your user lookup, adding backgrounds and altering the text.
</td></tr>



</table>
<br style="clear:both;" />

									</div>
        </div>
    </article>
    <article id="article-25" class="hn-article" data-index="25">
        <h1 class="title">
            <a href="http://jspaint.ml/">
                JS Paint – A web-based MS Paint remake
            </a>
        </h1>
        <p class="meta">
            <a href="http://jspaint.ml/">jspaint.ml</a>
            -
            <a href="https://news.ycombinator.com/item?id=16174478" target="_blank">Comments</a>
        </p>
        <div>
            
        </div>
    </article>
    <article id="article-26" class="hn-article" data-index="26">
        <h1 class="title">
            <a href="https://www.reuters.com/investigates/special-report/northkorea-vinalon/">
                North Korea’s fabric made of stone
            </a>
        </h1>
        <p class="meta">
            <a href="https://www.reuters.com/investigates/special-report/northkorea-vinalon/">www.reuters.com</a>
            -
            <a href="https://news.ycombinator.com/item?id=16174131" target="_blank">Comments</a>
        </p>
        <div>
            <div>

         
        
        
        
        
            




    
        
			<span class="navbar-toggler-icon"></span>
		
        <div class="navbar-brand">
            <a class="logo-container" href="//www.reuters.com/">
                <img class="logo reuters-investigates" src="https://www.reuters.com/investigates/static/v-3/en/images/reuters-investigates.png?v=364121160118" alt="reuters-investigates.png?v=364121160118" />
            </a>
            <p>
                
                
                            North Korea Revealed
                
                
            </p>
        </div>


        
    





    



        








        
    
    
            
                <div class="navbar-brand">
                    <a class="logo-container" href="//www.reuters.com">
                        <img src="https://www.reuters.com/investigates/static/v-3/en/images/reuters-footer.png?v=364121160118" class="footer-logo" alt="reuters-footer.png?v=364121160118" />
                    </a>
                </div>
                
            
        





        
    
    


        
    
    

            
            

        

    
        
    

    





    
    
    
        
    









        



    </div>
        </div>
    </article>
    <article id="article-27" class="hn-article" data-index="27">
        <h1 class="title">
            <a href="https://www.theatlantic.com/business/archive/2018/01/cities-housing-accessory-dwelling-units/550616/?single_page=true">
                Urban Housing Solution That Has No Good Name
            </a>
        </h1>
        <p class="meta">
            <a href="https://www.theatlantic.com/business/archive/2018/01/cities-housing-accessory-dwelling-units/550616/?single_page=true">www.theatlantic.com</a>
            -
            <a href="https://news.ycombinator.com/item?id=16173429" target="_blank">Comments</a>
        </p>
        <div>
            <div>
    
        
        

        <p>When Kol Peterson moved to Portland, Oregon, in 2010, affordable housing was a priority, as it was for many newcomers in <a href="https://www.theatlantic.com/business/archive/2016/05/the-real-roots-of-portlands-housing-crisis/482988/">this city’s booming real-estate market</a>. He looked at two frequently discussed options for high-cost cities—tiny houses on wheels and communal living—but decided on another option: accessory dwelling units, or ADUs—also known as “granny flats,” or basement or garage apartments.</p><p>ADUs weren’t yet common in Portland—that year, the city issued only 86 permits for them—but when Peterson did the math, he decided that building one was his best option. “I could buy a house, construct an ADU in the backyard, and live in the ADU while renting out the house,” he said. That’s what he did: He bought a home in the city’s King-Sabin neighborhood, <a href="http://pdxadu.blogspot.com/p/about-this-adu.html">built a two-story mini-home in its backyard</a>, and moved in. The experience, he says, has been life-changing: “Building an 800-foot ADU eventually eliminated my housing costs, and I’m living in my dream house.”</p><a href="/projects/cities-remade/">
        <img alt="Cities Remade" src="https://cdn.theatlantic.com/assets/media/img/specialreports/bug/2017/10/12/BugCities_Remade.jpg" /></a>
    <h5>
        How the urban landscape is evolving<br /><a href="/projects/cities-remade/">Read more</a>
    </h5>
<p>Eight years later, Peterson works full-time helping others build ADUs and teaching <a href="http://pdxadu.blogspot.com/p/adu-class-for-homeowners.html">classes for other interested Portland homeowners</a>. The number of ADU permits the city issues has risen dramatically; in 2016, it was 615. In Vancouver, Canada—<a href="https://www.citylab.com/design/2017/11/how-cities-get-granny-flats-wrong/546392/">an ADU pioneer</a>—more than 2,000 ADUs have been built citywide in the last decade. But for most cities in North America, steep legal barriers are preventing this form of housing from taking off: Many cities ban them outright, and those that don’t often have severe restrictions on size, owner occupancy, and parking. Only a handful of cities have adjusted their regulations to encourage more ADUs—mostly on the West Coast, where severe housing affordability is a growing problem. But Peterson and other proponents of ADUs are predicting that the country is on the verge of welcoming more of them.</p><p>“By 2020, ADUs will take off in tens of cities,” he said. “This doesn’t mean there will be an explosion of them overnight, but the concept will become more popular in the next couple of years.”</p><p>Peterson recently wrote a book, <em><a href="http://www.buildinganadu.com/backdoor-revolution/">Backdoor Revolution: The Definitive Guide to ADU Development</a></em>, that walks potential ADU builders through the planning and construction process, and tackles the social, economic, and environmental issues that relate to such housing. I spoke with him recently about why ADUs are gaining traction and how cities could make them easier to build. The conversation that follows has been edited for length and clarity.</p><hr /><strong>Kirk: </strong>Why do you think we will we see more ADUs in the U.S.?<p><strong>Peterson</strong>: There’s a lot of single-family zoning in the center of our cities, and urban planners, civil society, and city leaders are questioning whether these zoning rules make sense. We’re missing dwellings that can house more people and are more affordable, such as duplexes, triplexes, and ADUs.</p><p>I don’t think tiny houses on wheels will soon become a widespread form of housing, because they aren’t yet permittable. But media coverage of them has helped to spur more interest in small housing in general. These factors are positioning ADUs to become a popular movement.</p><p><strong>Kirk: </strong>What are the benefits of ADUs for residents, cities, and the environment?</p><img alt="" class="lazyload" src="https://www.theatlantic.com/business/archive/2018/01/cities-housing-accessory-dwelling-units/550616/?single_page=true" />A converted garage apartment in Portland (Courtesy of Kol Peterson)<p><strong>Peterson</strong>: ADUs allow people housing flexibility over time. You can design an ADU in which to age in place, and then rent out your main house, allowing you to stay in your neighborhood as you grow older, and at less cost. Parents, caregivers, or adult children can also live in ADUs.</p><p>ADUs use fewer resources like gas and electricity due to their size, and because they’re often built in walkable and bikeable areas, their residents generate less of an environmental impact that way as well. They also reduce the per-capita residential footprint. This is important because there are a lot of one- and two-person households in cities, but not the housing to match that demographic. ADUs can help fill this need.</p><p>And ADUs generally don’t have a significant infrastructural impact on a city, in contrast to, say, a 400-unit apartment building. They bring more housing to an area organically, and the city doesn’t have to build new infrastructure to accommodate it.</p><p><strong>Kirk: </strong>Where are ADUs already taking off in the U.S.?</p><p><strong>Peterson</strong>: A city must relax their ADU codes to increase their number. In 2017, <a href="https://nextcity.org/daily/entry/california-adu-applications-skyrocket-after-regulatory-reform">the state of California</a> did just that. While the legislation did not address one of the most problematic issues, the owner-occupancy requirement, it did relax the rules on providing parking spaces for ADUs. Los Angeles’s code already didn’t require owner occupancy, so the statewide reduction in other regulations has been especially effective there. L.A. went from having 142 ADU permits issued in 2016 to roughly 2,000 in 2017.</p><p>San Francisco, Oakland, Santa Barbara, and numerous other California cities have also experienced a significant uptick, though not as extreme as L.A.; Portland and Austin, Texas, are other fairly ADU-friendly cities. Though this is a pretty limited subset of cities, the interest and demand for ADUs is growing.</p><hr /><img alt="" class="lazyload" src="https://www.theatlantic.com/business/archive/2018/01/cities-housing-accessory-dwelling-units/550616/?single_page=true" />(Courtesy of Kol Peterson)<hr /><p><strong>Kirk: </strong>What should people do if they want to build an ADU but they are illegal in their city, or the codes are too strict?</p><p><strong>Peterson</strong>: One strategy is to point to other cities that are experiencing similar affordable-housing issues—basically every coastal U.S. city—and how those that allow and foster ADUs have benefited from them. As for codes, the owner-occupancy requirement is perhaps the most important to overcome. A strategy to eliminate the provision would be to request the city to drop it in a certain area, and then take stock of the consequences a year or two later. Inevitably, ADUs won’t generate problems, and then advocates can push for expanding the relaxed rule to the entire city.</p><p>The other argument worth noting is that cities in which ADUs aren’t legal still have many of them; people are just building them illegally. When a city relaxes ADU codes, it encourages people to construct more of them—and build them better so they’re safer.</p><p><strong>Kirk: </strong>What should one keep in mind when designing an ADU?  </p><p><strong>Peterson</strong>: Given the small size of an ADU, it’s necessary to have a “great room” that houses the living room, dining room, and kitchen in a contiguous space. Such a room with high ceilings and a visual connection to an outdoor area that’s adjacent to the ADU makes the space feel bigger than it is.</p><p>Also, ADUs are a form of urban-infill housing, so it’s a best practice to be respectful of neighbors and not infringe on their privacy. This means being careful in terms of placement of doors and windows.</p><p><strong>Kirk: </strong>One critique of ADUs is that they encourage more short-term rentals, which actually exacerbate the dearth of affordable housing. What’s your response?</p><p><strong>Peterson</strong>: My hope is that ADUs would be treated like any other house in regard to short-term rentals. By this I mean that if a city doesn’t allow short-term rentals, it shouldn’t allow them in ADUs or any other dwelling. The reason parity is important is that the rules should be the same across the board, such as regarding owner occupancy. Cities generally don’t require owner occupancy for a duplex, for instance, but do for an ADU. This rule should be equally applied, or permitted ADUs will not be viewed as a desirable housing form for homeowners.</p><hr /><p><small><em>This post appears courtesy of</em> <a href="http://citylab.com">CityLab</a>.</small></p>
    
    </div>
        </div>
    </article>
    <article id="article-28" class="hn-article" data-index="28">
        <h1 class="title">
            <a href="https://aeon.co/essays/we-should-look-closely-at-what-adam-smith-actually-believed">
                The Real Adam Smith
            </a>
        </h1>
        <p class="meta">
            <a href="https://aeon.co/essays/we-should-look-closely-at-what-adam-smith-actually-believed">aeon.co</a>
            -
            <a href="https://news.ycombinator.com/item?id=16173324" target="_blank">Comments</a>
        </p>
        <div>
            <div>
<p>If you’ve heard of one economist, it’s likely to be Adam Smith. He’s the best-known of all economists, and is typically hailed as the founding father of the dismal science itself.</p><p>Furthermore, he’s usually portrayed as not only an early champion of economic theory, but of the superiority of markets over government planning. In other words, Smith is now known both as the founder of economics, and as an ideologue for the political Right.</p><p>Yet, despite being widely believed, both these claims are at best misleading, and at worst outright false.</p><p>Smith’s popular reputation as an economist is a remarkable twist of fate for a man who spent most of his life as a somewhat reclusive academic thinker. Employed as professor of moral philosophy at the University of Glasgow, the majority of Smith’s teaching was in ethics, politics, jurisprudence and rhetoric, and for most of his career he was known for his first book, <em>The Theory of Moral Sentiments</em> (1759). His professional identity was firmly that of a philosopher – not least because the discipline of ‘economics’ didn’t emerge until the 19th century, by which time Smith was long dead. (He died in July 1790, just as the French Revolution was getting into full swing.)</p><p>Admittedly, Smith’s reputation as an economist isn’t entirely mysterious. His oft-quoted <em>An Inquiry into the Nature and Causes of the Wealth of Nations</em> (1776) was undoubtedly important in the eventual formation – in the next century – of the discipline of economics. But even here things are not as straightforward as they appear. For <em>The</em> <em>Wealth of Nations</em> – a 1,000-page doorstopper that blends history, ethics, psychology and political philosophy – bears little resemblance to the ahistorical and highly mathematical nature of most current economic theory. If anything, Smith’s best-known book is a work of <em>political economy</em>, a once-prevalent field of enquiry that suffered a striking decline in the latter half of the 20th century.</p><p>Smith’s reputation, however, began to get away from him early on. Shortly after publication, <em>The Wealth of Nations</em> was fêted in the British Parliament by the Whig leader Charles James Fox. Ironically, Fox later admitted that he had never actually read it (few subsequent non-readers of the book have showed such candour, despite plenty of them citing it). Indeed, Smith suspected that those quickest to sing his praises had failed to understand the main arguments of his work. He later described <em>The Wealth of Nations</em> as a ‘very violent attack … upon the whole commercial system of Great Britain’. Despite this, his vocal political cheerleaders in Parliament continued to prop up the very system that Smith was railing against.</p><p>Yet if Smith was disappointed by his work’s immediate reception, he would likely have taken even less cheer from the future uses to which his name would be put. For it has been his fate to become associated with the strain of Right-wing politics that rose to dominance in the early 1980s, and which continues to exert a strong influence on politics and economics today. Usually known as neoliberalism, this development is most famously associated with Ronald Reagan and Margaret Thatcher. But it is in fact a movement with deep intellectual roots, in particular in the mid-century writings of the economists Friedrich Hayek and Ludwig von Mises. Later, the Chicago economist Milton Friedman and the British policy adviser Keith Joseph championed it during the 1980s, as did the extensive network of academics, think tanks, business leaders and policymakers associated with the Mont Pelerin Society.</p><p>Neoliberals often invoke Smith’s name, believing him to be an early champion of private capitalist endeavour, and a founder of the movement that seeks (as Thatcher hoped) to ‘roll back the frontiers of the state’ so as to allow the market to flourish. The fact that there is a prominent Right-wing British think tank called the Adam Smith Institute – which since the 1970s has aggressively pushed for market-led reforms, and in 2016 officially rebranded itself a ‘neoliberal’ organisation – is just one example of this tendency.</p><p>It is certainly true that there are similarities between what Smith called ‘the system of natural liberty’, and more recent calls for the state to make way for the free market. But if we dig below the surface, what emerges most strikingly are the <em>differences</em> between Smith’s subtle, skeptical view of the role of markets in a free society, and more recent caricatures of him as a free-market fundamentalist <em>avant-la-lettre</em>. For while Smith might be publicly lauded by those who put their faith in private capitalist enterprise, and who decry the state as the chief threat to liberty and prosperity, the real Adam Smith painted a rather different picture. According to Smith, the most pressing dangers came not from the state acting alone, but the state when captured by merchant elites.</p><div class="shortcode-inline-newsletter"><p>Subscribe to Aeon’s Newsletter</p></div><p><span class="ld-dropcap">T</span>he context of Smith’s intervention in <em>The Wealth of Nations</em> was what he called ‘the mercantile system’. By this Smith meant the network of monopolies that characterised the economic affairs of early modern Europe. Under such arrangements, private companies lobbied governments for the right to operate exclusive trade routes, or to be the only importers or exporters of goods, while closed guilds controlled the flow of products and employment within domestic markets.</p><p>As a result, Smith argued, ordinary people were forced to accept inflated prices for shoddy goods, and their employment was at the mercy of cabals of bosses. Smith saw this as a monstrous affront to liberty, and a pernicious restriction on the capacity of each nation to increase its collective wealth. Yet the mercantile system benefited the merchant elites, who had worked hard to keep it in place. Smith pulled no punches in his assessment of the bosses as working against the interests of the public. As he put it in <em>The Wealth of Nations</em>: ‘People of the same trade seldom meet together, even for merriment and diversion but the conversation ends in a conspiracy against the public, or in some contrivance to raise prices.’</p><p>The merchants had spent centuries securing their position of unfair advantage. In particular, they had invented and propagated the doctrine of ‘the balance of trade’, and had succeeded in elevating it into the received wisdom of the age. The basic idea was that each nation’s wealth consisted in the amount of gold that it held. Playing on this idea, the merchants claimed that, in order to get rich, a nation had to export as much, and import as little, as possible, thus maintaining a ‘favourable’ balance. They then presented themselves as servants of the public by offering to run state-backed monopolies that would limit the inflow, and maximise the outflow, of goods, and therefore of gold. But as Smith’s lengthy analysis showed, this was pure hokum: what were needed instead were open trading arrangements, so that productivity could increase generally, and collective wealth would grow for the benefit of all.</p><p>Even worse than this, Smith thought, the merchants were the source of what his friend, the philosopher and historian David Hume, had called ‘jealousy of trade’. This was the phenomenon whereby commerce was turned into an instrument of war, rather than the bond of ‘union and friendship’ between states that it ought properly to be. By playing on jingoistic sentiments, the merchants inflamed aggressive nationalism, and blinded domestic populations to the fact that their true interests lay in forming peaceful trading relationships with their neighbours.</p><p>The peace and stability of the European continent was imperilled by the conspiracies of the merchants, who goaded politicians into fighting wars to protect home markets, or acquire foreign ones. After all, being granted militarily-backed private monopolies was far easier than having to compete on the open market by lowering prices and improving quality. The merchants in this manner constantly conspired to capture the state, defrauding the public by using political power to promote their own sectional advantage.</p><p class="pullquote">The invisible hand was invoked not to draw attention to the problem of state <em>intervention</em>, but of state <em>capture</em></p><p>Indeed, Smith’s single most famous idea – that of ‘the invisible hand’ as a metaphor for uncoordinated market allocation – was invoked in precisely the context of his blistering attack on the merchant elites. It is certainly true that Smith was skeptical of politicians’ attempts to interfere with, or bypass, basic market processes, in the vain hope of trying to do a better job of allocating resources than was achievable through allowing the market to do its work. But in the passage of <em>The</em> <em>Wealth of Nations</em> where he invoked the idea of the invisible hand, the immediate context was not simply that of state intervention in general, but of state intervention <em>undertaken at the behest of merchant elites</em> who were furthering their own interests at the expense of the public.</p><p>It is an irony of history that Smith’s most famous idea is now usually invoked as a defence of unregulated markets in the face of state interference, so as to protect the interests of private capitalists. For this is roughly the opposite of Smith’s original intention, which was to advocate for restrictions on what groups of merchants could do. When he argued that markets worked remarkably efficiently – because, although each individual ‘intends only his own gain, and he is in this, as in many other cases, led by an invisible hand to promote an end which was no part of his intention’ – this was an appeal to <em>free</em> individuals from the constraints imposed upon them by the monopolies that the merchants had established, and were using state power to uphold. The invisible hand was originally invoked not to draw attention to the problem of state <em>intervention</em>, but of state <em>capture</em>.</p><p>Smith was, however, deeply pessimistic about the stranglehold that the merchants had managed to exert over European politics, and despaired of it ever being loosened. Accordingly, he labelled his preferred alternative – of liberal markets generating wealth to be passed on to all members of society – a ‘Utopia’ that would never come to pass. History has to some extent proved him wrong on this score: we now live in an era of comparative market freedom. But nobody should deny that merchant conspiracy, and the marriage of the state to what we now call corporate power, remain defining features of our present-day political and economic reality.</p><p>In any case, Smith’s hostility to the merchants is a long way removed from a Reagan-style championing of the entrepreneurial capitalist hero, she who needs only to be released from the constraints of the state to lead us to the sunlit uplands of economic growth. On the contrary, Smith’s analysis implies that a free society with a healthy economy is going to need to put fetters <em>on</em> economic elites if the invisible hand is to have any chance of doing its paradoxical work.</p><p>Does this, then, make Smith an early proponent of the political Left? No, and it would be a serious mistake to draw that conclusion. The truth is both more complex, and more interesting, than that.</p><p><span class="ld-dropcap">A</span>lthough Smith was deeply critical of the way that the merchants conspired to promote their own advantage at the expense of the rest of society, he was under no illusion that political actors might successfully replace private merchants as the necessary conduits of economic activity.</p><p>Certainly, when merchants were allowed to rule as sovereigns – as the British East India Company had been permitted to do in Bengal – the results were disastrous. ‘Want, famine and mortality’, themselves the results of ‘tyranny’ and ‘calamity’, had been unleashed on India, all products of an ‘oppressive authority’ based on force and injustice. Under absolutely no circumstances, Smith thought, should merchants be put in charge of politics. Their monopolistic conspiracies would be ‘destructive’ to all countries ‘which have the misfortune to fall under their government’.</p><p class="pullquote">On Smith’s final analysis, the merchants were a pernicious but necessary part of large-scale economies</p><p>Nonetheless, something like the reverse was also true: politicians made for terrible merchants, and ought not to attempt to take over the systematic running of economic affairs. This was a product of the structural predicament faced by political leaders, whom Smith claimed have ‘scarce ever succeeded’ in becoming ‘adventurers in the common branches of trade’, despite often having been tempted to try, and often from a genuine desire to better their nation’s condition.</p><p>Politicians, according to Smith, were much poorer judges of where and how to allocate resources than the aggregated outcome of individuals spontaneously undertaking free exchange. As a result, in matters of trade it was usually folly for politicians to try to replace the vast network of buyers and sellers with any form of centralised command. This, however, included precisely those networks structured around the profit-seeking activities of merchant elites.</p><p>On Smith’s final analysis, the merchants were a potentially pernicious, but entirely necessary, part of the functioning of large-scale economies. The true ‘science of a statesman or legislator’ consisted in deciding how best to govern the merchants’ nefarious activities. Effective politicians had to strike a balance between granting economic elites the liberty to pursue legitimate commercial activities, while also applying control when such activities became vehicles for exploitation. In other words, Smith was very far from asking us to put our faith in ‘entrepreneurs’, those supposed ‘wealth-creators’ whom neoliberalism looks to as drivers of economic prosperity. On the contrary, giving the entrepreneurs free reign would be rather like putting the foxes in charge of the chicken coup.</p><p><span class="ld-dropcap">C</span>rucially, however, Smith did not offer up any kind of premeditated plan regarding how to strike the right balance between commercial freedom and watchful political control. On the contrary, he pressed home the deep underlying difficulties of the situation that commercial societies found themselves in.</p><p>Political actors, Smith claimed, were liable to be swept up by a ‘spirit of system’, which made them fall in love with abstract plans, which they hoped would introduce sweeping beneficial reform. Usually the motivations behind these plans were perfectly noble: a genuine desire to improve society. The problem, however, was that the ‘spirit of system’ blinded individuals to the harsh complexities of real-world change. As Smith put it in <em>The Theory of Moral Sentiments</em> in one of his most evocative passages:</p><blockquote>[The man of system] seems to imagine that he can arrange the different members of a great society with as much ease as the hand arranges the different pieces upon a chessboard. He does not consider that the pieces upon the chessboard have no other principle of motion besides that which the hand impresses upon them; but that, in the great chessboard of human society, every single piece has a principle of motion of its own, altogether different from that which the legislature might choose to impress upon it. If those two principles coincide and act in the same direction, the game of human society will go on easily and harmoniously, and is very likely to be happy and successful. If they are opposite or different, the game will go on miserably, and the society must be at all times in the highest degree of disorder.</blockquote><p>Smith’s point is easily misunderstood. At first glance, it can look like a modern Right-wing injunction against socialist-style state planning. But it is much more subtle than that.</p><p>What Smith is saying is that in politics <em>any</em> preconceived plan – especially one that assumes that the millions of individuals composing a society will just automatically go along with it – is potentially dangerous. This is because the ‘spirit of system’ infects politicians with a messianic moral certainty that their reforms are so necessary and justified that almost any price is worth paying to achieve them.</p><p class="pullquote">Thatcher’s restructuring of the economy was as much a product of the ‘spirit of system’ as any Soviet strategy</p><p>Yet it is a short step from this to discounting the very real harm that a plan can unleash if it starts to go wrong – and especially if the ‘pieces upon the chessboard’ act in ways that resist, or subvert, or confound, the politician’s scheme. This is because the ‘spirit of system’ encourages the sort of attitude captured in such cheap sayings as ‘You can’t make an omelette without breaking eggs’. In other words, that inconvenient opponents and bystanders can be sacrificed to an overriding moral vision.</p><p>Smith was warning against all abstract plans alike. Certainly, his outlook urges skepticism about such strategies as taking over the industrial base of a state, presuming to know what goods citizens will want and need over the next five years, and thereby trying to eliminate the market as a mechanism for resource allocation. But it likewise views with deep suspicion a plan to rapidly privatise previously state-owned industries, exposing millions of citizens to the ravages of unemployment and the attendant destruction of their communities. In other words, while she certainly didn’t realise it, Thatcher’s violent restructuring of the British economy during the 1980s was as much a product of the ‘spirit of system’ as any piece of top-down Soviet industrial strategy.</p><p>The message that Smith conveys cuts across party and ideological lines, and applies to both Left and Right. It is about a pathological attitude that politicians of all stripes are prone to. If not kept in check, this can be the source not just of disruption and inefficiency but of cruelty and suffering, when those who find themselves on the wrong side of the plan’s consequences are forced by the powerful to suffer them regardless. Smith in turn urges us to recognise that real-world politics will always be too complex for any prepackaged ideology to cope with. What we need in our politicians is careful judgment and moral maturity, something that no ideology, nor any position on the political spectrum, holds a monopoly on.</p><p>In the fraught times that we now occupy, it is hard to believe that the careful and responsible political judges that Smith envisaged have much chance of emerging. (Does anybody in Western politics currently measure up?) Much more likely will be new men and women of system, with alternative abstract plans, seducing desperate electorates before attempting to impose their own forceful reforms, regardless of what the pieces on the chessboard happen to think or want.</p><p>Whether these reforms come from the Left or the Right might not, in the end, matter much. As Western economies continue to struggle, and politics becomes increasingly polarised, the results could yet be catastrophic. But if so, we should certainly not consign Smith to any parade of blame. On the contrary, he tried to warn us of the dangers that we face. It is time that we listened, a little more carefully, to what the real Adam Smith had to say.</p>
<a class="republish-button" href="https://aeon.co/syndication?id=10be73ef-600d-41a7-8ea7-f48c51333bd8">
</a><p><a class="republish-button" href="https://aeon.co/syndication?id=10be73ef-600d-41a7-8ea7-f48c51333bd8">
<span>Syndicate this Essay</span>
</a></p><a class="republish-button" href="https://aeon.co/syndication?id=10be73ef-600d-41a7-8ea7-f48c51333bd8">
</a>



</div>
        </div>
    </article>
    <article id="article-29" class="hn-article" data-index="29">
        <h1 class="title">
            <a href="https://hanxiao.github.io/2018/01/10/Build-Cross-Lingual-End-to-End-Product-Search-using-Tensorflow/">
                Building Cross-Lingual End-to-End Product Search with Tensorflow
            </a>
        </h1>
        <p class="meta">
            <a href="https://hanxiao.github.io/2018/01/10/Build-Cross-Lingual-End-to-End-Product-Search-using-Tensorflow/">hanxiao.github.io</a>
            -
            <a href="https://news.ycombinator.com/item?id=16173143" target="_blank">Comments</a>
        </p>
        <div>
            <div><h2><span>Background</span></h2><p>Product search is one of the key components in an online retail store. Essentially, you need a system that matches a text query with a set of products in your store. A good product search can understand user’s query in any language, retrieve as many relevant products as possible, and finally present the result as a list, in which the preferred products should be at the top, and the irrelevant products should be at the bottom.</p><p>Unlike text retrieval (e.g. Google web search), products are structured data. A product is often described by a list of key-value pairs, a set of pictures and some free text. In the developers’ world, <a></a><a href="http://lucene.apache.org/solr/">Apache Solr</a> and <a href="https://www.elastic.co/">Elasticsearch</a> are known as de-facto solutions for full-text search, making them a top contender for building e-commerce product search.</p><p>At the core, Solr/Elasticsearch is a <em>symbolic information retrieval (IR) system</em>. Mapping query and document to a common string space is crucial to the search quality. This mapping process is an NLP pipeline implemented with <a href="http://lucene.apache.org/core/6_2_1/core/org/apache/lucene/analysis/Analyzer.html">Lucene Analyzer</a>. In this post, I will reveal some drawbacks of such a symbolic-pipeline approach, and then present an end-to-end way to build a product search system from query logs using Tensorflow. This deep learning based system is less prone to spelling errors, leverages underlying semantics better, and scales out to multiple languages much easier.</p><h4><span>Table of Content</span></h4><h2><span>Recap Symbolic Approach for Product Search</span></h2><p>Let’s first do a short review of the classic approach. Typically, an information retrieval system can be divided into three tasks: <strong>indexing</strong>, <strong>parsing</strong> and <strong>matching</strong>. As an example, the next figure illustrates a simple product search system:</p><img src="https://hanxiao.github.io/2018/01/10/Build-Cross-Lingual-End-to-End-Product-Search-using-Tensorflow/6bc9332f.png" alt="6bc9332f.png" /><ol><li><strong>indexing</strong>: storing products in a database with attributes as keys, e.g. brand, color, category;</li><li><strong>parsing</strong>: extracting attribute terms from the input query, e.g. <code>red shirt -&gt; {"color": "red", "category": "shirt"}</code>;</li><li><strong>matching</strong>: filtering the product database by attributes.</li></ol><p>If there is no attribute found in the query, then the system fallbacks to exact string matching, i.e. searching every possible occurrence in the database. Note that, parsing, and matching must be done for each incoming query, whereas indexing can be done less frequently depending on the stock update speed.</p><p>Many existing solutions such as Apache Solr and Elasticsearch follow this simple idea, except they employ more sophisticated algorithms (e.g. Lucene) for these three tasks. Thanks to these open-source projects many e-commerce businesses are able to build product search on their own and serve millions of requests from customers.</p><h4><span>Symbolic IR System</span></h4><p>Note, at the core, Solr/Elasticsearch is a <em>symbolic IR system</em> that relies on the effective string representation of the query and product. By parsing or indexing, the system knows which tokens in the query or product description are important. These tokens are the primitive building blocks for matching. Extracting important tokens from the original text is usually implemented as a NLP pipeline, consisting of tokenization, lemmatization, spelling correction, acronym/synonym replacement, named-entity recognition and query expansion.</p><p>Formally, given a query $q\in \mathcal{Q}$ and a product $p\in\mathcal{P}$, one can think the NLP pipeline as a predefined function that maps from $\mathcal{Q}$ or $\mathcal{P}$ to a common string space $\mathcal{S}$, i.e. $f: \mathcal{Q}\mapsto \mathcal{S}$ or $g: \mathcal{P}\mapsto \mathcal{S}$, respectively. For the matching task, we just need a metric $m: \mathcal{S} \times \mathcal{S} \mapsto [0, +\infty)$ and then evaluate $m\left(f(q),g(p)\right)$, as illustrated in the figure below.</p><img src="https://hanxiao.github.io/2018/01/10/Build-Cross-Lingual-End-to-End-Product-Search-using-Tensorflow/399488d3.png" alt="399488d3.png" /><h2><span>Pain points of Symbolic IR System</span></h2><p>If you are a machine learning enthusiast who believes everything should be learned from data, you must have tons of questions about the last figure. To name a few:</p><ul><li>Why are $f$ and $g$ predefined? Why can’t we learn $f$ and $g$ from data?</li><li>Why is $\mathcal{S}$ a string space? Why can’t it be a vector space?</li><li>Why is $m$ a string/key matching function? Why can’t we use more well-defined math function, e.g. Euclidean distance, cosine function? Wait, why don’t we just learn $m$?</li></ul><p>In fact, these questions reveal two pain points of a symbolic IR system.</p><h4><span>1. NLP Pipeline is Fragile and doesn’t Scale Out to Multiple Languages</span></h4><p>The NLP Pipeline in Solr/Elasticsearch is based on the Lucene <code>Analyzer</code> class. A simple analyzer such as <code>StandardAnalyzer</code> would just split the sequence by whitespace and remove some stopwords. Quite often you have to extend it by adding more and more functionalities, which eventually results in a pipeline as illustrated in the figure below.<br /><img src="https://hanxiao.github.io/2018/01/10/Build-Cross-Lingual-End-to-End-Product-Search-using-Tensorflow/c37a7fd4.png" alt="c37a7fd4.png" /></p><p>While it looks legit, my experience is that such NLP pipeline suffers from the following drawbacks:</p><ul><li>The system is fragile. As the output of every component is the input of the next, a defect in the upstream component can easily break down the whole system. For-example,canyourtoken izer split thiscorrectly⁇</li><li>Dependencies between components can be complicated. A component can take from and output to multiple components, forming a directed acyclic graph. Consequently, you may have to introduce some <em>asynchronous mechanisms</em> to reduce the overall blocking time.</li><li>It is not straightforward to improve the overall search quality. An improvement in one or two components does not necessarily improve the end-user search experience.</li><li>The system doesn’t scale-out to multiple languages. To enable cross-lingual search, developers have to rewrite those language-dependent components in the pipeline for every language, which increases the maintenance cost.</li></ul><h4><span>2. Symbolic System does not Understand Semantics without Hard Coding</span></h4><p>A good IR system should understand <code>trainer</code> is <code>sneaker</code> by using some semantic knowledge. No one likes hard coding this knowledge, especially you machine learning guys. Unfortunately, it is difficult for Solr/Elasticsearch to understand any acronym/synonym unless you implement <a href="https://lucene.apache.org/core/6_6_1/analyzers-common/org/apache/lucene/analysis/synonym/SynonymFilter.html"><code>SynonymFilter</code> class</a>, which is basically a rule-based filter. This severely restricts the generalizability and scalability of the system, as you need someone to maintain a hard-coded language-dependent lexicon. If one can represent query/product by a vector in a space learned from actual data, then synonyms and acronyms could be easily found in the neighborhood without hard coding.</p><h2><span>Neural IR System</span></h2><p>With aforementioned problems in mind, my motivation is twofold:</p><ul><li>eliminate the NLP pipeline to make the system more robust and scalable;</li><li>find a space for query and product that can better represent underlying semantics.</li></ul><p>The next figure illustrates a neural information retrieval framework, which looks pretty much the same as its symbolic counterpart, except that the NLP pipeline is replaced by a deep neural network and the matching job is done in a learned common space. Now $f$ serves as a query encoder, $g$ serves as a product encoder.<br /><img src="https://hanxiao.github.io/2018/01/10/Build-Cross-Lingual-End-to-End-Product-Search-using-Tensorflow/dd4c4faa.png" alt="dd4c4faa.png" /></p><h4><span>End-to-End Model Training</span></h4><p>There are several ways to train a neural IR system. One of the most straightforward (but not necessarily the most effective) ways is <em>end-to-end</em> learning. Namely, your training data is a set of query-product pairs feeding on the top-right and top-left blocks in the last figure. All the other blocks such as $f$, $g$, $m$ and $\mathcal{S}$ are learned from data. Depending on the engineering requirements or resource limitations, one can also fix or pre-train some of the components.</p><h4><span>Where Do Query-Product Pairs Come From?</span></h4><p>To train a neural IR system in an end-to-end manner, your need some associations between query and product such as the query log. This log should contain what products a user interacted with (click, add to wishlist, purchase) after typing a query. Typically, you can fetch this information from the query/event log of your system. After some work on segmenting (by time/session), cleaning and aggregating, you can get pretty accurate associations. In fact, any user-generated text can be good association data. This includes comments, product reviews, and crowdsourcing annotations. The next figure shows an example of what German and British users <em>clicked</em> after searching for <code>ananas</code> and <code>pineapple</code> on Zalando, respectively.</p><img src="https://hanxiao.github.io/2018/01/10/Build-Cross-Lingual-End-to-End-Product-Search-using-Tensorflow/ecdd3fe7.png" alt="ecdd3fe7.png" /><p>Increasing the diversity of training data source is beneficial to a neural IR system, as you certainly want the system to generalize more and not to mimic the behavior of the symbolic counterpart. On the contrary, if your only data source is the query log of a symbolic IR system, then your neural IR system is inevitably biased. The performance of your final system highly depends on the ability of the symbolic system. For example, if your current symbolic system doesn’t correct spell mistakes and returns nothing when user types <code>adidaas</code>, then you won’t find any product associated with <code>adidaas</code> from the query log. As a consequence, your neural IR system is unlikely to learn the ability of spell checking.</p><p>In that sense, we are “bootstrapping” the symbolic IR system to build a neural IR system. Given enough training data, we hope that some previously hard-coded rules or manually coded functions can be picked up and <em>generalized</em> by deep neural networks</p><h4><span>What about Negative Query-Product Pairs?</span></h4><p>At some point, you will probably need negative query-product pairs to train a neural IR system more effectively. In general, negative means that a product is irrelevant to the query. A straightforward way is just random sampling all products, hoping that no positive product gets accidentally sampled. It is easy to implement and actually <em>not</em> a bad idea in practice. More sophisticated solutions could be collecting those products that generate impressions on customers yet not receive any clicks as negative ones. This requires some collaborations between you, the frontend team and the logging team, making sure those no-click items are really uninterested to users, not due to screen resolution, lazy loading, etc.</p><p>If you are looking for a more formal and sounding solution, then Positive-Unlabeled Learning (PU learning) could be interesting to you. Instead of relying on the heuristics for identifying negative data, PU learning regards unlabeled data as negative data with smaller weights. <a href="https://arxiv.org/pdf/1703.00593.pdf">“Positive-Unlabeled Learning with Non-Negative Risk Estimator”</a> is a nice paper about the unbiased PU learning published in NIPS 2017.</p><h2><span>Symbolic vs. Neural IR System</span></h2><p>Before I dive into details, let’s take a short break. As you can see I spent quite some effort on explaining symbolic and neural IR systems. This is because the symbolic system is such a classic way to do IR, and developers get used to it. With the help of Apache Solr, Elasticsearch and Lucene, medium and small e-commerce businesses are able to build their own product search in a short time. It is the de-facto solution. On the other hand, Neural IR is a new concept emerging just recently. There are not so many off-the-shelf packages available. Plus, training a neural IR system requires some data. The next table summarizes the pros and cons of two systems.</p><table><thead><tr><th></th><th><strong>Symbolic IR system</strong></th><th><strong>Neural IR system</strong></th></tr></thead><tbody><tr><td><strong>Pros</strong></td><td>Efficient in query-time;<br />straightforward to implement;<br />results are interpretable;<br />many off-the-shelf packages.</td><td>Automatic;<br />resilient to noise;<br />scale-out easily;<br />requires little domain knowledge.</td></tr><tr><td><strong>Cons</strong></td><td>Fragile;<br />Hard-coded knowledge;<br />high maintenance costs.</td><td>Less efficient in query-time;<br />hard to add business rules;<br />requires a lot of data.</td></tr></tbody></table><p>This is not a Team Symbol or Team Neural choice. Both systems have their own advantages and can complement each other pretty well. Therefore, a better solution would be combining these two systems in a way so that we can enjoy all advantages from both sides.</p><h2><span>Neural Network Architecture</span></h2><p>The next figure illustrates the architecture of the neural network. The proposed architecture is composed of multiple encoders, a metric layer, and a loss layer. First, input data is fed to the encoders which generate vector representations. Note that, product information is encoded by an image encoder and an attribute encoder. In the metric layer, we compute the similarity of a query vector with an image vector and an attribute vector, respectively. Finally, in the loss layer, we compute the difference of similarities between positive and negative pairs, which is used as the feedback to train encoders via backpropagation.</p><img src="https://hanxiao.github.io/2018/01/10/Build-Cross-Lingual-End-to-End-Product-Search-using-Tensorflow/a9cb66d6.png" alt="a9cb66d6.png" /><p>In the last figure, I labeled one possible model for each component, but the choices are quite open. For the sake of clarity, I will keep the model as simple as possible and briefly go through each component.</p><h4><span>Query Encoder</span></h4><p>Here we need a model that takes in a sequence and output a vector. Besides the content of a sequence, the vector representation should also encode language information and be resilient to misspellings. The character-RNN (e.g LSTM, GRU, SRU) model is a good choice. By feeding RNN character by character, the model becomes resilient to misspelling such as adding/deleting/replacing characters. The misspelled queries would result in a similar vector representation as the genuine one. Moreover, as European languages (e.g. German and English) share some Unicode characters, one can train queries from different languages in one RNN model. To distinguish the words with the same spelling but different meanings in two languages, such as German <code>rot</code> (color red) and English <code>rot</code>, one can prepend a special character to indicate the language of the sequence, e.g. <code>🇩🇪 rot</code> and <code>🇬🇧 rot</code>.</p><p>Using characters instead of words as model input means that your system is unlikely to meet an out-of-vocabulary word. Any input will be encoded into a vector representation. Consequently, the system has a good recall rate, as it will always return some result regardless the sanity of the input. Of course, the result could be meaningless. However, if a customer is kind and patient enough to click on one relevant product, the system could immediately pick up this signal from the query log as a positive association, retrain the model and provide better results in the next round. In that sense, we close the loop between feedback to users and learning from users.</p><p>Note that, a query can be <em>compositional</em>. It may contain multiple words and describe multiple attributes, such as <code>nike sneaker</code> (brand + category) and <code>nike air max</code> (brand + product name). Unfortunately, it is difficult for a plain character RNN to capture the high-order dependency and concept, as its resolution is limited to a single character. To solve this problem, I stack multiple dilated recurrent layers with hierarchical dilations to construct a <a href="https://papers.nips.cc/paper/6613-dilated-recurrent-neural-networks.pdf">Dilated Recurrent Neural Networks</a>, which learns temporal dependencies of different scales at different layers. The next figure illustrates a three-layer DilatedRNN with dilation up to 4.</p><img src="https://hanxiao.github.io/2018/01/10/Build-Cross-Lingual-End-to-End-Product-Search-using-Tensorflow/b98f6ef1.png" alt="b98f6ef1.png" /><p>An implementation of dilated RNN using <code>static_rnn</code> API can be found <a href="https://github.com/hanxiao/tf-best-practice/blob/master/utils/dilatedRNN.py">here</a>. The query representation is the last output from dilated RNN, which can be obtained via:</p><table><tr><td class="gutter"><pre></pre><p>1</p><p>2</p><p>3</p><p>4</p></td><td class="code"><pre></pre><p>num_hidden = <span class="number">148</span>  </p><p>dilations = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">8</span>]</p><p>encoder_cell = [LSTMCell(num_hidden) <span class="keyword">for</span> _ <span class="keyword">in</span> range(len(dilations))]</p><p>q_r = get_last_output_dRNN(input=X_query, cells=encoder_cell, dilations=dilations)</p></td></tr></table><p>To speed up training, one can also replace Tensorflow’s <code>LSTMCell</code> by recently proposed <a href="https://arxiv.org/pdf/1709.02755.pdf">Simple Recurrent Unit (SRU)</a>. According to the paper, SRU is 5-10x faster than an optimized LSTM implementation. The code can be found <a href="https://github.com/hanxiao/tf-best-practice/blob/master/utils/sru.py">here</a>.</p><p>If you are interested in extending query encoder further, such as adding a more complicated high-order dependency or integrating side information in each recursion step, please read my blog post on <a href="https://hanxiao.github.io/2017/08/16/Why-I-use-raw-rnn-Instead-of-dynamic-rnn-in-Tensorflow-So-Should-You-0/">“Why I Use raw_rnn Instead of dynamic_rnn in Tensorflow and So Should You”</a>.</p><h4><span>Image Encoder</span></h4><p>The image encoder rests on purely visual information. The RGB image data of a product is fed into a multi-layer convolutional neural network based on the ResNet architecture, resulting in an image vector representation in 128-dimensions.</p><h4><span>Attribute Encoder</span></h4><p>The attributes of a product can be combined into a sparse one-hot encoded vector. It is then supplied to a four-layer, fully connected deep neural network with steadily diminishing layer size. Activation was rendered nonlinear by standard ReLUs, and drop-out is applied to address overfitting. The output yields attribute vector representation in 20 dimensions.</p><p><br />Some readers may question the necessarity of having image and attribute encoders at the same time. Isn’t an attribute encoder enough? If you think about search queries in the e-commerce context, especially in the fashion e-commerce I’m working in, queries can be loosely divided into two categories: <em>“attribute”</em> queries such as <code>nike red shoes</code> of which all words are already presented in the product database as attributes, and <em>“visual”</em> queries such as <code>tshirt logo on back</code>, <code>typical berlin</code> that express more visual or abstract intent from user and those words never show up in the product database. The former can be trained with attribute encoder only, whereas the latter requires image encoder for effective training. Having both encoders allows some knowledge transfer between them during the training time, which improves the overall performance.<br /></p><h4><span>Metric &amp; Loss Layer</span></h4><p>After a query-product pair goes through all three encoders, one can obtain a vector representation $q$ of the query, an image representation $u$ and an attribute representation $v$ of the product. It is now the time to squeeze them into a common latent space. In the metric layer, we need a similarity function $m$ which gives higher value to the positive pair than the negative pair, i.e. $m(q, u^+, v^+) &gt; m(q, u^-, v^-)$. The absolute value of $m(q, u^+, v^+)$ does not bother us too much. We only care about the relative distances between positive and negative pairs. In fact, a larger difference is better for us, as a clearer separation between positive and negative pairs can enhance the generalization ability of the system. As a consequence, we need a loss function $\ell$ which is <em>inversely proportional</em> to the difference between $m(q, u^+, v^+)$ and $m(q, u^-, v^-)$. By splitting $q$ (148-dim) into $q^{\mathrm{img}}$ (128-dim) and $q^{\mathrm{attr}}$ (20-dim), we end up minimizing the following loss function:<br />$${\begin{aligned}&amp;\sum_{\tiny\begin{array}{c} 0&lt;i&lt;N\\ 0&lt;j&lt;|q_{i}^{+}| \\ 0&lt;k&lt;|q_{i}^{-}|\end{array}}\lambda\ell\left(m(q^{\mathrm{img}}_i, u_{i,j}^{+}), m(q^{\mathrm{img}}_i, u_{i,k}^{-})\right) \\ &amp;+ (1-\lambda)\ell\left(m(q^{\mathrm{attr}}_i, v_{i,j}^{+}), m(q^{\mathrm{attr}}_i, v_{i,k}^{-})\right),\end{aligned}}$$</p><p>where $N$ is the total number of queries. $|q_{i}^{+}|$ and $|q_{i}^{-}|$ are the number of positive and negative products associated with query $i$, respectively. Hyperparameter $\lambda$ trades off between image information and attribute information. For functions $\ell$ and $g$, the options are:</p><ul><li><strong>Loss function $\ell$</strong>: logistic, exponential, hinge loss, etc.</li><li><strong>Metric function $m$</strong>: cosine similarity, euclidean distance (i.e. $\ell_2$-norm), MLP, etc.</li></ul><p>To understand how it ends up with the above loss function, I strongly recommend you read my other blog post on <a href="https://hanxiao.github.io/2017/11/08/Optimizing-Contrastive-Rank-Triplet-Loss-in-Tensorflow-for-Neural/">“Optimizing Contrastive/Rank/Triplet Loss in Tensorflow for Neural Information Retrieval”</a>. It also explains the metric and loss layer implementation in details.</p><h4><span>Inference</span></h4><p>For a neural IR system, doing inference means serving search requests from users. Since products are updated regularly (say once a day), we can pre-compute the image representation and attribute representation for all products and store them. During the inference time, we first represent user input as a vector using query encoder; then iterate over all available products and compute the metric between the query vector and each of them; finally, sort the results. Depending on the stock size, the metric computation part could take a while. Fortunately, this process can be easily parallelized.</p><h2><span>Training and Evaluation Scheme</span></h2><p>The query-product dataset is partitioned into four sets as illustrated in the next figure.<br /><img src="https://hanxiao.github.io/2018/01/10/Build-Cross-Lingual-End-to-End-Product-Search-using-Tensorflow/6d0746b3.png" alt="6d0746b3.png" /></p><p>Data in the orange block is used to train the model, and the evaluation is performed on Test I set. In this way, the model can’t observe any query or product used for training during the test time. For evaluation, we feed the query to the network and return a sorted list of test products. Then we check how groundtruth products are ranked in the results. Some widely-used measurements include: mean average precision (MAP), mean reciprocal rank (MRR), precision@1, precision@1%, negative discounted cumulative gain (NDCG) etc. A comprehensive explanation of these metrics can be found <a href="https://people.cs.umass.edu/~jpjiang/cs646/03_eval_basics.pdf">in this slides</a>. With <a href="https://www.tensorflow.org/api_docs/python/tf/estimator">Estimator</a> and <a href="https://www.tensorflow.org/api_docs/python/tf/keras/datasets">Data</a> API in Tensorflow 1.4, you can easily define the training and evaluation procedure as follows:<br /></p><table><tr><td class="gutter"><pre></pre><p>1</p><p>2</p><p>3</p><p>4</p></td><td class="code"><pre></pre><p>model = tf.estimator.Estimator(model_fn=neural_ir, params=params)</p><p>train_spec = tf.estimator.TrainSpec(input_fn=<span class="keyword">lambda</span>: input_data.input_fn(ModeKeys.TRAIN))</p><p>eval_spec = tf.estimator.EvalSpec(input_fn=<span class="keyword">lambda</span>: input_data.input_fn(ModeKeys.EVAL))</p><p>tf.estimator.train_and_evaluate(model, train_spec, eval_spec)</p></td></tr></table><p>Test II or Test III sets can be also used for evaluation to check how the model generalizes on unseen products or unseen queries, respectively.</p><h2><span>Qualitative Results</span></h2><p>Here I will <em>not</em> present any quantitative result. After all, it is a blog, not an academic paper and the goal is mainly to introduce this new idea of neural IR system. So let’s look at some results that are easy to your eyes. This actually poses a good question: how can you tell an IR system is (not) working by visual inspection only?</p><p>Personally, I call an IR system “working” if it meets these two basic conditions:</p><ul><li>it understands singleton query described by a basic concept, e.g. brand, color, category;</li><li>it understands compositional query described by multiple concepts, e.g. brand + color, brand + color + category + product name.</li></ul><p>If it fails to meet these two conditions, then I don’t bother to check fancy features such as spell-checking and cross-lingual. Enough said, here are some search results.</p><p>Here I demonstrated some (cherry-picked) results for different types of query. It seems that the system goes in the right direction. It is exciting to see that the neural IR system is able to correctly interpret named-entity, spelling errors and multilinguality without any NLP pipeline or hard-coded rule. However, one can also notice that some top ranked products are not relevant to the query, which leaves quite some room for improvement.</p><p>Speed-wise, the inference time is about two seconds per query on a quad-core CPU for 300,000 products. One can further improve the efficiency by using model compression techniques.</p><h2><span>Summary</span></h2><p>If you are a search developer who is building a symbolic IR system with Solr/Elasticsearch/Lucene, this post should make you aware of the drawbacks of such a system. This post should also answer your What? Why? and How? questions regarding a neural IR system. Comparing to the symbolic counterpart, the new system is more resilient to the input noise and requires little domain knowledge about the products and languages. Nonetheless, one should not take it as a Team Symbol or Team Neural kind of choice. Both systems have their own advantages and can complement each other pretty well. A better solution would be combining these two systems in a way that we can enjoy all advantages from both sides.</p><p>Some implementation details and tricks are omitted here but can be found in my other posts. I strongly recommend readers to continue with the following posts:</p><p>Last but not least, the open-source project <a href="https://github.com/faneshion/MatchZoo">MatchZoo</a> contains many state-of-the-art neural IR algorithms. In addition to product search, you may find its application in conversational chatbot, question-answer system.</p></div>
        </div>
    </article>
    <article id="article-30" class="hn-article" data-index="30">
        <h1 class="title">
            <a href="https://marco.org/2018/01/17/end-of-conference-era">
                End of the conference era
            </a>
        </h1>
        <p class="meta">
            <a href="https://marco.org/2018/01/17/end-of-conference-era">marco.org</a>
            -
            <a href="https://news.ycombinator.com/item?id=16173031" target="_blank">Comments</a>
        </p>
        <div>
            <div>
                        
                                                            
                            
                            <p>
                                January 17, 2018
                                <a class="permalink" title="Permalink" href="/2018/01/17/end-of-conference-era"><span class="noprint">∞</span><span class="printonly">https://marco.org/2018/01/17/end-of-conference-era</span></a>
                            </p>
                        
                    
                        <p>Chris Adamson <a href="http://subfurther.com/blog/2018/01/15/the-final-conf-down/">notes a significant contraction in iOS and related conferences recently</a> (via <a href="https://mjtsai.com/blog/2018/01/16/the-final-conf-down/">Michael Tsai</a>).</p>

<p>Having attended (and sometimes spoken at) many of these conferences over the years, I can’t deny the feeling I’ve had in the last couple of years that the era of the small Apple-ish developer-ish conference is mostly or entirely behind us.</p>

<p>I don’t think that’s a bad thing. This style of conference had a <em>great</em> run, but it always had major and inherent limitations, challenges, and inefficiencies:</p>

<ul>
<li><strong>Cost:</strong> With flights, lodging, and the ticket adding up to thousands of dollars per conference, most people are priced out. The vast majority of attendees’ money isn’t even going to the conference organizers or speakers — it’s going to venues, hotels, and airlines.</li>
<li><strong>Size:</strong> There’s no good size for a conference. Small conferences exclude too many people; big conferences impede socialization and logistics.</li>
<li><strong>Logistics:</strong> Planning and executing a conference takes such a toll on the organizers that few of them have ever lasted more than a few years.</li>
<li><strong>Format:</strong> Preparing formal talks with slide decks is a <em>massively</em> inefficient use of the speakers’ time compared to other modern methods of communicating ideas, and sitting there listening to blocks of talks for long stretches while you’re trying to stay awake after lunch is a pretty inefficient way to hear ideas.</li>
</ul>

<p>It’s getting increasingly difficult for organizers to sell tickets, in part because it’s hard to get big-name speakers without the budget to pay them much (which would significantly drive up ticket costs, which exacerbates other problems), but also because conferences now have much bigger competition in connecting people to their colleagues or audiences.</p>

<p>There’s no single factor that has made it so difficult, but the explosion of podcasts and YouTube over the last few years must have contributed significantly. Podcasts are a vastly more time-efficient way for people to communicate ideas than writing conference talks, and people who prefer crafting their message as a produced piece or with multimedia can do the same thing (and more) on YouTube. Both are much easier and more versatile for people to consume than conference talks, and they can reach and benefit <em>far</em> more people.</p>

<p>Ten years ago, you had to go to conferences to hear most prominent people in our industry speak in their own voice, or to get more content than an occasional blog post. Today, anyone who could headline a conference probably has a podcast or YouTube channel with hours of their thoughts and ideas available to anyone, anywhere in the world, anytime, for free.</p>

<p>But all of that media can’t really replace the socializing, networking, and simply <em>fun</em> that happened as part of (or sometimes despite) the conference formula.</p>

<p>I don’t know how to fix conferences, but the first place I’d start on that whiteboard is by getting rid of all of the talks, then trying to find different ways to bring people together — and far more of them than before.</p>

<p>Or maybe we’ve already solved these problems with social networks, Slack groups, podcasts, and YouTube, and we just haven’t fully realized it yet.</p>
                    </div>
        </div>
    </article>
</div>
<footer>
    <div>
        <h2>About this site</h2>
        <p>
            This page displays articles from Hacker News in one single page for offline reading.
            <br>
            Get the <a href="https://github.com/mauricesvay/FullHackerNews">source on github</a>.
            <br>
            It was made by Maurice Svay &lt;maurice@svay.com&gt;.
        </p>
    </div>
</footer>

<nav class="toolbar">
    <a href="#toc" id="index">Index</a>
    <a href="#" id="prev">Prev</a>
    <a href="#" id="next">Next</a>
</nav>

<script src="js/jquery-2.0.3.min.js" type="text/javascript"></script>
<script src="js/moment.min.js" type="text/javascript"></script>
<script src="js/waypoints.min.js" type="text/javascript"></script>
<script src="js/app.js" type="text/javascript"></script>
<script type="text/javascript">
    App.init();
</script>
</body>
</html>
